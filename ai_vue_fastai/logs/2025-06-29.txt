2025-06-29 13:40:06,029 - INFO - 发送验证码: phone=12345678921, code=331075
2025-06-29 13:40:07,821 - INFO - SELECT DATABASE()
2025-06-29 13:40:07,822 - INFO - [raw sql] {}
2025-06-29 13:40:07,824 - INFO - SELECT @@sql_mode
2025-06-29 13:40:07,824 - INFO - [raw sql] {}
2025-06-29 13:40:07,825 - INFO - SELECT @@lower_case_table_names
2025-06-29 13:40:07,826 - INFO - [raw sql] {}
2025-06-29 13:40:07,828 - INFO - BEGIN (implicit)
2025-06-29 13:40:07,839 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.phone = %(phone_1)s
2025-06-29 13:40:07,841 - INFO - [generated in 0.00124s] {'phone_1': '12345678921'}
2025-06-29 13:40:07,846 - INFO - ROLLBACK
2025-06-29 13:40:51,487 - INFO - BEGIN (implicit)
2025-06-29 13:40:51,489 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:40:51,494 - INFO - [generated in 0.00496s] {'id_1': 7}
2025-06-29 13:40:51,497 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:40:51,497 - INFO - [cached since 0.008004s ago] {'id_1': 7}
2025-06-29 13:40:51,500 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:40:51,500 - INFO - [cached since 0.01108s ago] {'id_1': 9}
2025-06-29 13:40:51,503 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:40:51,503 - INFO - [cached since 0.01383s ago] {'id_1': 10}
2025-06-29 13:40:51,509 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:40:51,509 - INFO - [cached since 0.02018s ago] {'id_1': 10}
2025-06-29 13:40:51,514 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:40:53,316 - INFO - [cached since 1.827s ago] {'id_1': 2}
2025-06-29 13:40:53,320 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:40:53,349 - INFO - [cached since 1.86s ago] {'id_1': 2}
2025-06-29 13:40:53,352 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:40:53,352 - INFO - [cached since 1.863s ago] {'id_1': 14}
2025-06-29 13:40:53,355 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:40:53,355 - INFO - [cached since 1.867s ago] {'id_1': 14}
2025-06-29 13:40:53,358 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:40:53,359 - INFO - [cached since 1.87s ago] {'id_1': 14}
2025-06-29 13:40:55,212 - INFO - ROLLBACK
2025-06-29 13:41:10,615 - INFO - BEGIN (implicit)
2025-06-29 13:41:10,616 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:41:10,617 - INFO - [cached since 19.13s ago] {'id_1': 6}
2025-06-29 13:41:10,638 - INFO - ROLLBACK
2025-06-29 13:41:21,750 - INFO - BEGIN (implicit)
2025-06-29 13:41:21,751 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:41:21,751 - INFO - [cached since 30.26s ago] {'id_1': 6}
2025-06-29 13:41:21,772 - INFO - ROLLBACK
2025-06-29 13:51:28,676 - INFO - SELECT DATABASE()
2025-06-29 13:51:28,678 - INFO - [raw sql] {}
2025-06-29 13:51:28,682 - INFO - SELECT @@sql_mode
2025-06-29 13:51:28,682 - INFO - [raw sql] {}
2025-06-29 13:51:28,684 - INFO - SELECT @@lower_case_table_names
2025-06-29 13:51:28,684 - INFO - [raw sql] {}
2025-06-29 13:51:28,686 - INFO - BEGIN (implicit)
2025-06-29 13:51:28,728 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:51:28,728 - INFO - [generated in 0.00085s] {'id_1': 7}
2025-06-29 13:51:28,768 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:51:28,768 - INFO - [cached since 0.0403s ago] {'id_1': 7}
2025-06-29 13:51:28,771 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:51:28,772 - INFO - [cached since 0.04445s ago] {'id_1': 7}
2025-06-29 13:51:28,776 - INFO - ROLLBACK
2025-06-29 13:51:30,431 - INFO - BEGIN (implicit)
2025-06-29 13:51:30,442 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:51:30,443 - INFO - [cached since 1.715s ago] {'id_1': 7}
2025-06-29 13:51:30,452 - INFO - ROLLBACK
2025-06-29 13:51:37,873 - INFO - BEGIN (implicit)
2025-06-29 13:51:37,876 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:51:37,878 - INFO - [cached since 9.15s ago] {'id_1': 7}
2025-06-29 13:51:37,891 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:51:37,896 - INFO - [cached since 9.168s ago] {'id_1': 7}
2025-06-29 13:51:37,908 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:51:37,916 - INFO - [cached since 9.188s ago] {'id_1': 7}
2025-06-29 13:51:37,922 - INFO - ROLLBACK
2025-06-29 13:51:41,479 - INFO - BEGIN (implicit)
2025-06-29 13:51:41,491 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:51:41,493 - INFO - [cached since 12.76s ago] {'id_1': 6}
2025-06-29 13:51:41,498 - INFO - ROLLBACK
2025-06-29 13:51:42,995 - INFO - BEGIN (implicit)
2025-06-29 13:51:42,997 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:51:42,997 - INFO - [cached since 14.27s ago] {'id_1': 7}
2025-06-29 13:51:43,002 - INFO - ROLLBACK
2025-06-29 13:52:11,309 - INFO - BEGIN (implicit)
2025-06-29 13:52:11,310 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:52:11,311 - INFO - [cached since 42.58s ago] {'id_1': 7}
2025-06-29 13:52:11,326 - INFO - ROLLBACK
2025-06-29 13:52:40,734 - INFO - BEGIN (implicit)
2025-06-29 13:52:40,736 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:52:40,737 - INFO - [cached since 72.01s ago] {'id_1': 7}
2025-06-29 13:52:40,743 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:52:40,746 - INFO - [cached since 72.02s ago] {'id_1': 7}
2025-06-29 13:52:40,749 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:52:40,750 - INFO - [cached since 72.02s ago] {'id_1': 7}
2025-06-29 13:52:40,753 - INFO - ROLLBACK
2025-06-29 13:52:41,915 - INFO - BEGIN (implicit)
2025-06-29 13:52:41,916 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:52:41,917 - INFO - [cached since 73.19s ago] {'id_1': 7}
2025-06-29 13:52:41,924 - INFO - ROLLBACK
2025-06-29 13:54:37,979 - INFO - BEGIN (implicit)
2025-06-29 13:54:37,982 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:54:37,985 - INFO - [cached since 189.3s ago] {'id_1': 7}
2025-06-29 13:54:37,994 - INFO - ROLLBACK
2025-06-29 13:54:39,036 - INFO - BEGIN (implicit)
2025-06-29 13:54:39,038 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:54:39,039 - INFO - [cached since 190.3s ago] {'id_1': 7}
2025-06-29 13:54:39,046 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:54:39,047 - INFO - [cached since 190.3s ago] {'id_1': 7}
2025-06-29 13:54:39,052 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:54:39,056 - INFO - [cached since 190.3s ago] {'id_1': 9}
2025-06-29 13:54:39,060 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:54:39,063 - INFO - [cached since 190.3s ago] {'id_1': 10}
2025-06-29 13:54:39,066 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:54:39,067 - INFO - [cached since 190.3s ago] {'id_1': 10}
2025-06-29 13:54:39,070 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:54:39,072 - INFO - [cached since 190.3s ago] {'id_1': 2}
2025-06-29 13:54:39,074 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:54:39,075 - INFO - [cached since 190.4s ago] {'id_1': 2}
2025-06-29 13:54:39,080 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:54:39,080 - INFO - [cached since 190.4s ago] {'id_1': 14}
2025-06-29 13:54:39,083 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:54:39,085 - INFO - [cached since 190.4s ago] {'id_1': 14}
2025-06-29 13:54:39,088 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:54:39,088 - INFO - [cached since 190.4s ago] {'id_1': 14}
2025-06-29 13:54:39,091 - INFO - ROLLBACK
2025-06-29 13:55:17,437 - INFO - BEGIN (implicit)
2025-06-29 13:55:17,445 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:55:17,450 - INFO - [cached since 228.7s ago] {'id_1': 7}
2025-06-29 13:55:17,455 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:55:17,459 - INFO - [cached since 228.7s ago] {'id_1': 7}
2025-06-29 13:55:17,463 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:55:17,463 - INFO - [cached since 228.7s ago] {'id_1': 9}
2025-06-29 13:55:17,467 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:55:17,467 - INFO - [cached since 228.7s ago] {'id_1': 10}
2025-06-29 13:55:17,470 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:55:17,473 - INFO - [cached since 228.7s ago] {'id_1': 10}
2025-06-29 13:55:17,477 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:55:17,479 - INFO - [cached since 228.8s ago] {'id_1': 2}
2025-06-29 13:55:17,483 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:55:17,484 - INFO - [cached since 228.8s ago] {'id_1': 2}
2025-06-29 13:55:17,488 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:55:17,489 - INFO - [cached since 228.8s ago] {'id_1': 14}
2025-06-29 13:55:17,493 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:55:17,494 - INFO - [cached since 228.8s ago] {'id_1': 14}
2025-06-29 13:55:17,497 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:55:17,499 - INFO - [cached since 228.8s ago] {'id_1': 14}
2025-06-29 13:55:17,501 - INFO - ROLLBACK
2025-06-29 13:55:20,440 - INFO - BEGIN (implicit)
2025-06-29 13:55:20,441 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:55:20,442 - INFO - [cached since 231.7s ago] {'id_1': 7}
2025-06-29 13:55:20,446 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:55:20,450 - INFO - [cached since 231.7s ago] {'id_1': 7}
2025-06-29 13:55:20,459 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:55:20,462 - INFO - [cached since 231.7s ago] {'id_1': 7}
2025-06-29 13:55:20,464 - INFO - ROLLBACK
2025-06-29 13:55:21,378 - INFO - BEGIN (implicit)
2025-06-29 13:55:21,380 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:55:21,380 - INFO - [cached since 232.7s ago] {'id_1': 7}
2025-06-29 13:55:21,391 - INFO - ROLLBACK
2025-06-29 13:55:32,953 - INFO - BEGIN (implicit)
2025-06-29 13:55:32,956 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:55:32,962 - INFO - [cached since 244.2s ago] {'id_1': 7}
2025-06-29 13:55:32,988 - INFO - ROLLBACK
2025-06-29 13:57:05,529 - INFO - BEGIN (implicit)
2025-06-29 13:57:05,530 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:57:05,530 - INFO - [cached since 336.8s ago] {'id_1': 7}
2025-06-29 13:57:05,535 - INFO - ROLLBACK
2025-06-29 13:57:17,161 - INFO - BEGIN (implicit)
2025-06-29 13:57:17,169 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:57:17,173 - INFO - [cached since 348.5s ago] {'id_1': 6}
2025-06-29 13:57:17,175 - INFO - ROLLBACK
2025-06-29 13:57:42,267 - INFO - BEGIN (implicit)
2025-06-29 13:57:42,269 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:57:42,278 - INFO - [cached since 373.6s ago] {'id_1': 6}
2025-06-29 13:57:42,303 - INFO - ROLLBACK
2025-06-29 13:59:06,568 - INFO - BEGIN (implicit)
2025-06-29 13:59:06,569 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:59:06,569 - INFO - [cached since 457.8s ago] {'id_1': 6}
2025-06-29 13:59:06,572 - INFO - ROLLBACK
2025-06-29 13:59:27,359 - INFO - BEGIN (implicit)
2025-06-29 13:59:27,361 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:59:27,362 - INFO - [cached since 478.6s ago] {'id_1': 6}
2025-06-29 13:59:27,365 - INFO - ROLLBACK
2025-06-29 13:59:48,359 - INFO - BEGIN (implicit)
2025-06-29 13:59:48,360 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 13:59:48,361 - INFO - [cached since 499.6s ago] {'id_1': 6}
2025-06-29 13:59:48,363 - INFO - ROLLBACK
2025-06-29 14:00:10,414 - INFO - BEGIN (implicit)
2025-06-29 14:00:10,418 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:00:10,420 - INFO - [cached since 521.7s ago] {'id_1': 6}
2025-06-29 14:00:10,424 - INFO - ROLLBACK
2025-06-29 14:00:25,559 - ERROR - Fatal error: protocol.data_received() call failed.
protocol: <uvicorn.protocols.http.h11_impl.H11Protocol object at 0x000001B46D7A3130>
transport: <_SelectorSocketTransport fd=1764 read=polling write=<idle, bufsize=0>>
Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 177, in handle_events
    event = self.conn.next_event()
  File "d:\conda\lib\site-packages\h11\_connection.py", line 487, in next_event
    exc._reraise_as_remote_protocol_error()
  File "d:\conda\lib\site-packages\h11\_util.py", line 77, in _reraise_as_remote_protocol_error
    raise self
  File "d:\conda\lib\site-packages\h11\_connection.py", line 469, in next_event
    event = self._extract_next_receive_event()
  File "d:\conda\lib\site-packages\h11\_connection.py", line 411, in _extract_next_receive_event
    event = self._reader(self._receive_buffer)
  File "d:\conda\lib\site-packages\h11\_readers.py", line 83, in maybe_read_from_IDLE_client
    matches = validate(
  File "d:\conda\lib\site-packages\h11\_util.py", line 91, in validate
    raise LocalProtocolError(msg)
h11._util.RemoteProtocolError: illegal request line: bytearray(b'\x16\x03\x01\x06\xf4\x01\x00\x06\xf0\x03\x03v\xf2\xf1~%\xd5\xcax\xa3\xdc\x83yrN\x98\xfcBpO\x82?A\x15\x85\x07e')

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1859, in _run_once
    handle._run()
  File "d:\conda\lib\asyncio\events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
  File "d:\conda\lib\asyncio\selector_events.py", line 805, in _read_ready
    self._read_ready_cb()
  File "d:\conda\lib\asyncio\selector_events.py", line 862, in _read_ready__data_received
    self._protocol.data_received(data)
  File "d:\conda\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 172, in data_received
    self.handle_events()
  File "d:\conda\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 181, in handle_events
    self.send_400_response(msg)
  File "d:\conda\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 301, in send_400_response
    output = self.conn.send(event=h11.Data(data=msg.encode("ascii")))
  File "d:\conda\lib\site-packages\h11\_connection.py", line 512, in send
    data_list = self.send_with_data_passthrough(event)
  File "d:\conda\lib\site-packages\h11\_connection.py", line 537, in send_with_data_passthrough
    self._process_event(self.our_role, event)
  File "d:\conda\lib\site-packages\h11\_connection.py", line 272, in _process_event
    self._cstate.process_event(role, type(event), server_switch_event)
  File "d:\conda\lib\site-packages\h11\_state.py", line 293, in process_event
    self._fire_event_triggered_transitions(role, _event_type)
  File "d:\conda\lib\site-packages\h11\_state.py", line 316, in _fire_event_triggered_transitions
    self.states[role] = new_state
  File "d:\conda\lib\site-packages\pyspark\context.py", line 378, in signal_handler
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 177, in handle_events
    event = self.conn.next_event()
  File "d:\conda\lib\site-packages\h11\_connection.py", line 467, in next_event
    raise RemoteProtocolError("Can't receive data when peer state is ERROR")
h11._util.RemoteProtocolError: Can't receive data when peer state is ERROR

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\asyncio\selector_events.py", line 862, in _read_ready__data_received
    self._protocol.data_received(data)
  File "d:\conda\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 172, in data_received
    self.handle_events()
  File "d:\conda\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 181, in handle_events
    self.send_400_response(msg)
  File "d:\conda\lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 298, in send_400_response
    output = self.conn.send(event)
  File "d:\conda\lib\site-packages\h11\_connection.py", line 512, in send
    data_list = self.send_with_data_passthrough(event)
  File "d:\conda\lib\site-packages\h11\_connection.py", line 527, in send_with_data_passthrough
    raise LocalProtocolError("Can't send data when our state is ERROR")
h11._util.LocalProtocolError: Can't send data when our state is ERROR
2025-06-29 14:01:37,841 - INFO - SELECT DATABASE()
2025-06-29 14:01:37,842 - INFO - [raw sql] {}
2025-06-29 14:01:37,843 - INFO - SELECT @@sql_mode
2025-06-29 14:01:37,843 - INFO - [raw sql] {}
2025-06-29 14:01:37,844 - INFO - SELECT @@lower_case_table_names
2025-06-29 14:01:37,844 - INFO - [raw sql] {}
2025-06-29 14:01:37,845 - INFO - BEGIN (implicit)
2025-06-29 14:01:37,852 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:01:37,853 - INFO - [generated in 0.00058s] {'id_1': 6}
2025-06-29 14:01:37,855 - INFO - ROLLBACK
2025-06-29 14:05:01,308 - INFO - BEGIN (implicit)
2025-06-29 14:05:01,313 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:05:01,314 - INFO - [cached since 203.5s ago] {'id_1': 6}
2025-06-29 14:05:01,322 - INFO - ROLLBACK
2025-06-29 14:05:01,341 - INFO - 用户 7 连接到目标 6
2025-06-29 14:05:06,591 - INFO - 用户 7 断开连接
2025-06-29 14:05:06,931 - INFO - BEGIN (implicit)
2025-06-29 14:05:06,935 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:05:06,936 - INFO - [cached since 209.1s ago] {'id_1': 6}
2025-06-29 14:05:06,942 - INFO - ROLLBACK
2025-06-29 14:05:06,960 - INFO - 用户 7 连接到目标 6
2025-06-29 14:10:51,332 - INFO - 用户 7 连接到目标 6
2025-06-29 14:15:41,855 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:15:41,873 - INFO - Closing down clientserver connection
2025-06-29 14:15:43,929 - INFO - Closing down clientserver connection
2025-06-29 14:15:43,929 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,874 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:15:45,983 - INFO - Closing down clientserver connection
2025-06-29 14:15:45,984 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,853 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:15:45,991 - INFO - Closing down clientserver connection
2025-06-29 14:15:48,038 - INFO - Closing down clientserver connection
2025-06-29 14:15:48,038 - INFO - Closing down clientserver connection
2025-06-29 14:15:45,992 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:15:50,082 - INFO - Closing down clientserver connection
2025-06-29 14:15:50,083 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,851 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:15:50,100 - INFO - Closing down clientserver connection
2025-06-29 14:15:52,144 - INFO - Closing down clientserver connection
2025-06-29 14:15:52,145 - INFO - Closing down clientserver connection
2025-06-29 14:15:50,101 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:15:54,206 - INFO - Closing down clientserver connection
2025-06-29 14:15:54,207 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,848 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:15:54,217 - INFO - Closing down clientserver connection
2025-06-29 14:15:56,251 - INFO - Closing down clientserver connection
2025-06-29 14:15:56,252 - INFO - Closing down clientserver connection
2025-06-29 14:15:54,217 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:15:58,321 - INFO - Closing down clientserver connection
2025-06-29 14:15:58,323 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,846 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:15:58,340 - INFO - Closing down clientserver connection
2025-06-29 14:16:00,408 - INFO - Closing down clientserver connection
2025-06-29 14:16:00,408 - INFO - Closing down clientserver connection
2025-06-29 14:15:58,341 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:16:02,462 - INFO - Closing down clientserver connection
2025-06-29 14:16:02,463 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,844 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:16:02,476 - INFO - Closing down clientserver connection
2025-06-29 14:16:04,519 - INFO - Closing down clientserver connection
2025-06-29 14:16:04,520 - INFO - Closing down clientserver connection
2025-06-29 14:16:02,477 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:16:06,577 - INFO - Closing down clientserver connection
2025-06-29 14:16:06,578 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,841 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:16:06,624 - INFO - Closing down clientserver connection
2025-06-29 14:16:08,670 - INFO - Closing down clientserver connection
2025-06-29 14:16:08,671 - INFO - Closing down clientserver connection
2025-06-29 14:16:06,624 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:16:10,724 - INFO - Closing down clientserver connection
2025-06-29 14:16:10,726 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,839 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:16:10,749 - INFO - Closing down clientserver connection
2025-06-29 14:16:12,780 - INFO - Closing down clientserver connection
2025-06-29 14:16:12,781 - INFO - Closing down clientserver connection
2025-06-29 14:16:10,750 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:16:14,848 - INFO - Closing down clientserver connection
2025-06-29 14:16:14,849 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,837 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:16:14,876 - INFO - Closing down clientserver connection
2025-06-29 14:16:16,933 - INFO - Closing down clientserver connection
2025-06-29 14:16:16,935 - INFO - Closing down clientserver connection
2025-06-29 14:16:14,877 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:16:18,988 - INFO - Closing down clientserver connection
2025-06-29 14:16:18,988 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,835 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:16:19,006 - INFO - Closing down clientserver connection
2025-06-29 14:16:21,054 - INFO - Closing down clientserver connection
2025-06-29 14:16:21,054 - INFO - Closing down clientserver connection
2025-06-29 14:16:19,007 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:16:23,104 - INFO - Closing down clientserver connection
2025-06-29 14:16:23,105 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,833 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:16:23,121 - INFO - Closing down clientserver connection
2025-06-29 14:16:25,176 - INFO - Closing down clientserver connection
2025-06-29 14:16:25,176 - INFO - Closing down clientserver connection
2025-06-29 14:16:23,122 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:16:27,264 - INFO - Closing down clientserver connection
2025-06-29 14:16:27,265 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,830 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:16:27,275 - INFO - Closing down clientserver connection
2025-06-29 14:16:29,325 - INFO - Closing down clientserver connection
2025-06-29 14:16:29,326 - INFO - Closing down clientserver connection
2025-06-29 14:16:27,275 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:16:31,383 - INFO - Closing down clientserver connection
2025-06-29 14:16:31,384 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,827 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:16:31,392 - INFO - Closing down clientserver connection
2025-06-29 14:16:33,431 - INFO - Closing down clientserver connection
2025-06-29 14:16:33,431 - INFO - Closing down clientserver connection
2025-06-29 14:16:31,393 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:16:35,489 - INFO - Closing down clientserver connection
2025-06-29 14:16:35,490 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,825 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:16:35,507 - INFO - Closing down clientserver connection
2025-06-29 14:16:37,558 - INFO - Closing down clientserver connection
2025-06-29 14:16:37,558 - INFO - Closing down clientserver connection
2025-06-29 14:16:35,508 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:16:39,627 - INFO - Closing down clientserver connection
2025-06-29 14:16:39,628 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,823 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:16:39,652 - INFO - Closing down clientserver connection
2025-06-29 14:16:41,697 - INFO - Closing down clientserver connection
2025-06-29 14:16:41,698 - INFO - Closing down clientserver connection
2025-06-29 14:16:39,652 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:16:43,755 - INFO - Closing down clientserver connection
2025-06-29 14:16:43,756 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,821 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:16:43,776 - INFO - Closing down clientserver connection
2025-06-29 14:16:45,822 - INFO - Closing down clientserver connection
2025-06-29 14:16:45,823 - INFO - Closing down clientserver connection
2025-06-29 14:16:43,777 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:16:47,887 - INFO - Closing down clientserver connection
2025-06-29 14:16:47,888 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,820 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:16:47,908 - INFO - Closing down clientserver connection
2025-06-29 14:16:49,945 - INFO - Closing down clientserver connection
2025-06-29 14:16:49,946 - INFO - Closing down clientserver connection
2025-06-29 14:16:47,908 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:16:52,016 - INFO - Closing down clientserver connection
2025-06-29 14:16:52,018 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,818 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:16:52,033 - INFO - Closing down clientserver connection
2025-06-29 14:16:54,083 - INFO - Closing down clientserver connection
2025-06-29 14:16:54,084 - INFO - Closing down clientserver connection
2025-06-29 14:16:52,033 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:16:56,156 - INFO - Closing down clientserver connection
2025-06-29 14:16:56,158 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,816 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:16:56,177 - INFO - Closing down clientserver connection
2025-06-29 14:16:58,218 - INFO - Closing down clientserver connection
2025-06-29 14:16:58,227 - INFO - Closing down clientserver connection
2025-06-29 14:16:56,178 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:17:00,270 - INFO - Closing down clientserver connection
2025-06-29 14:17:00,273 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,815 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:17:00,300 - INFO - Closing down clientserver connection
2025-06-29 14:17:02,359 - INFO - Closing down clientserver connection
2025-06-29 14:17:02,360 - INFO - Closing down clientserver connection
2025-06-29 14:17:00,300 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:17:04,427 - INFO - Closing down clientserver connection
2025-06-29 14:17:04,432 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,813 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:17:04,442 - INFO - Closing down clientserver connection
2025-06-29 14:17:06,484 - INFO - Closing down clientserver connection
2025-06-29 14:17:06,484 - INFO - Closing down clientserver connection
2025-06-29 14:17:04,442 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:17:08,554 - INFO - Closing down clientserver connection
2025-06-29 14:17:08,561 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,811 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:17:08,582 - INFO - Closing down clientserver connection
2025-06-29 14:17:10,640 - INFO - Closing down clientserver connection
2025-06-29 14:17:10,641 - INFO - Closing down clientserver connection
2025-06-29 14:17:08,582 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:17:12,710 - INFO - Closing down clientserver connection
2025-06-29 14:17:12,711 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,809 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:17:12,716 - INFO - Closing down clientserver connection
2025-06-29 14:17:14,781 - INFO - Closing down clientserver connection
2025-06-29 14:17:14,782 - INFO - Closing down clientserver connection
2025-06-29 14:17:12,721 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:17:16,835 - INFO - Closing down clientserver connection
2025-06-29 14:17:16,836 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,807 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:17:16,844 - INFO - Closing down clientserver connection
2025-06-29 14:17:18,906 - INFO - Closing down clientserver connection
2025-06-29 14:17:18,907 - INFO - Closing down clientserver connection
2025-06-29 14:17:16,845 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:17:20,980 - INFO - Closing down clientserver connection
2025-06-29 14:17:20,981 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,806 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:17:20,999 - INFO - Closing down clientserver connection
2025-06-29 14:17:23,048 - INFO - Closing down clientserver connection
2025-06-29 14:17:23,049 - INFO - Closing down clientserver connection
2025-06-29 14:17:21,000 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:17:25,080 - INFO - Closing down clientserver connection
2025-06-29 14:17:25,082 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,804 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:17:25,090 - INFO - Closing down clientserver connection
2025-06-29 14:17:27,151 - INFO - Closing down clientserver connection
2025-06-29 14:17:27,152 - INFO - Closing down clientserver connection
2025-06-29 14:17:25,090 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:17:29,206 - INFO - Closing down clientserver connection
2025-06-29 14:17:29,207 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,803 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:17:29,215 - INFO - Closing down clientserver connection
2025-06-29 14:17:31,267 - INFO - Closing down clientserver connection
2025-06-29 14:17:31,268 - INFO - Closing down clientserver connection
2025-06-29 14:17:29,216 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:17:33,335 - INFO - Closing down clientserver connection
2025-06-29 14:17:33,336 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,760 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:17:33,341 - INFO - Closing down clientserver connection
2025-06-29 14:17:35,400 - INFO - Closing down clientserver connection
2025-06-29 14:17:35,402 - INFO - Closing down clientserver connection
2025-06-29 14:17:33,344 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:17:37,439 - INFO - Closing down clientserver connection
2025-06-29 14:17:37,441 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,758 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:17:37,449 - INFO - Closing down clientserver connection
2025-06-29 14:17:39,482 - INFO - Closing down clientserver connection
2025-06-29 14:17:39,482 - INFO - Closing down clientserver connection
2025-06-29 14:17:37,450 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:17:41,537 - INFO - Closing down clientserver connection
2025-06-29 14:17:41,538 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,756 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:17:41,547 - INFO - Closing down clientserver connection
2025-06-29 14:17:43,609 - INFO - Closing down clientserver connection
2025-06-29 14:17:43,612 - INFO - Closing down clientserver connection
2025-06-29 14:17:41,547 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:17:45,650 - INFO - Closing down clientserver connection
2025-06-29 14:17:45,650 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,755 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:17:45,655 - INFO - Closing down clientserver connection
2025-06-29 14:17:47,699 - INFO - Closing down clientserver connection
2025-06-29 14:17:47,700 - INFO - Closing down clientserver connection
2025-06-29 14:17:45,656 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:17:49,781 - INFO - Closing down clientserver connection
2025-06-29 14:17:49,782 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,753 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:17:49,789 - INFO - Closing down clientserver connection
2025-06-29 14:17:51,851 - INFO - Closing down clientserver connection
2025-06-29 14:17:51,852 - INFO - Closing down clientserver connection
2025-06-29 14:17:49,790 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:17:53,904 - INFO - Closing down clientserver connection
2025-06-29 14:17:53,905 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,750 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:17:53,912 - INFO - Closing down clientserver connection
2025-06-29 14:17:55,976 - INFO - Closing down clientserver connection
2025-06-29 14:17:55,978 - INFO - Closing down clientserver connection
2025-06-29 14:17:53,913 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:17:58,032 - INFO - Closing down clientserver connection
2025-06-29 14:17:58,033 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,749 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:17:58,042 - INFO - Closing down clientserver connection
2025-06-29 14:18:00,100 - INFO - Closing down clientserver connection
2025-06-29 14:18:00,101 - INFO - Closing down clientserver connection
2025-06-29 14:17:58,043 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:18:02,142 - INFO - Closing down clientserver connection
2025-06-29 14:18:02,143 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,748 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:18:02,150 - INFO - Closing down clientserver connection
2025-06-29 14:18:04,215 - INFO - Closing down clientserver connection
2025-06-29 14:18:04,216 - INFO - Closing down clientserver connection
2025-06-29 14:18:02,150 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:18:06,266 - INFO - Closing down clientserver connection
2025-06-29 14:18:06,266 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,746 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:18:06,270 - INFO - Closing down clientserver connection
2025-06-29 14:18:08,323 - INFO - Closing down clientserver connection
2025-06-29 14:18:08,324 - INFO - Closing down clientserver connection
2025-06-29 14:18:06,270 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:18:10,351 - INFO - Closing down clientserver connection
2025-06-29 14:18:10,352 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,745 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:18:10,359 - INFO - Closing down clientserver connection
2025-06-29 14:18:12,406 - INFO - Closing down clientserver connection
2025-06-29 14:18:12,406 - INFO - Closing down clientserver connection
2025-06-29 14:18:10,360 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:18:14,446 - INFO - Closing down clientserver connection
2025-06-29 14:18:14,447 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,744 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:18:14,453 - INFO - Closing down clientserver connection
2025-06-29 14:18:16,517 - INFO - Closing down clientserver connection
2025-06-29 14:18:16,519 - INFO - Closing down clientserver connection
2025-06-29 14:18:14,455 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:18:18,570 - INFO - Closing down clientserver connection
2025-06-29 14:18:18,571 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,742 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:18:18,574 - INFO - Closing down clientserver connection
2025-06-29 14:18:20,625 - INFO - Closing down clientserver connection
2025-06-29 14:18:20,626 - INFO - Closing down clientserver connection
2025-06-29 14:18:18,574 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:18:22,664 - INFO - Closing down clientserver connection
2025-06-29 14:18:22,666 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,741 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:18:22,673 - INFO - Closing down clientserver connection
2025-06-29 14:18:24,722 - INFO - Closing down clientserver connection
2025-06-29 14:18:24,722 - INFO - Closing down clientserver connection
2025-06-29 14:18:22,674 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:18:26,776 - INFO - Closing down clientserver connection
2025-06-29 14:18:26,777 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,740 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:18:26,782 - INFO - Closing down clientserver connection
2025-06-29 14:18:28,831 - INFO - Closing down clientserver connection
2025-06-29 14:18:28,832 - INFO - Closing down clientserver connection
2025-06-29 14:18:26,783 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:18:30,873 - INFO - Closing down clientserver connection
2025-06-29 14:18:30,898 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,739 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:18:30,906 - INFO - Closing down clientserver connection
2025-06-29 14:18:32,958 - INFO - Closing down clientserver connection
2025-06-29 14:18:32,959 - INFO - Closing down clientserver connection
2025-06-29 14:18:30,907 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:18:35,000 - INFO - Closing down clientserver connection
2025-06-29 14:18:35,004 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,738 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:18:35,009 - INFO - Closing down clientserver connection
2025-06-29 14:18:37,055 - INFO - Closing down clientserver connection
2025-06-29 14:18:37,056 - INFO - Closing down clientserver connection
2025-06-29 14:18:35,010 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:18:39,109 - INFO - Closing down clientserver connection
2025-06-29 14:18:39,111 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,737 - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:18:39,115 - INFO - Closing down clientserver connection
2025-06-29 14:18:41,176 - INFO - Closing down clientserver connection
2025-06-29 14:18:41,177 - INFO - Closing down clientserver connection
2025-06-29 14:18:39,117 - INFO - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-06-29 14:18:43,208 - INFO - Closing down clientserver connection
2025-06-29 14:18:43,210 - INFO - Closing down clientserver connection
2025-06-29 14:15:41,662 - INFO - Error while receiving.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:18:43,214 - INFO - Closing down clientserver connection
2025-06-29 14:18:45,262 - INFO - Closing down clientserver connection
2025-06-29 14:18:45,263 - INFO - Closing down clientserver connection
2025-06-29 14:18:43,214 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "d:\conda\lib\asyncio\runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "d:\conda\lib\asyncio\base_events.py", line 603, in run_until_complete
    self.run_forever()
  File "d:\conda\lib\asyncio\base_events.py", line 570, in run_forever
    self._run_once()
  File "d:\conda\lib\asyncio\base_events.py", line 1823, in _run_once
    event_list = self._selector.select(timeout)
  File "d:\conda\lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "d:\conda\lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
  File "d:\conda\lib\site-packages\pyspark\context.py", line 377, in signal_handler
    self.cancelAllJobs()
  File "d:\conda\lib\site-packages\pyspark\context.py", line 2255, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
  File "d:\conda\lib\site-packages\pyspark\errors\exceptions\captured.py", line 169, in deco
    return f(*a, **kw)
  File "d:\conda\lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: <exception str() failed>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 242, in run_asgi
    result = await self.app(self.scope, self.asgi_receive, self.asgi_send)  # type: ignore[func-returns-value]
  File "d:\conda\lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
  File "d:\conda\lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "d:\conda\lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
  File "d:\conda\lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
  File "E:\python项目\ai_vue_fastai\views\chat\single_chat.py", line 52, in chat_websocket
    data = await websocket.receive_text()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 118, in receive_text
    message = await self.receive()
  File "d:\conda\lib\site-packages\starlette\websockets.py", line 46, in receive
    message = await self._receive()
  File "d:\conda\lib\site-packages\uvicorn\protocols\websockets\websockets_impl.py", line 376, in asgi_receive
    data = await self.recv()
  File "d:\conda\lib\site-packages\websockets\legacy\protocol.py", line 546, in recv
    await asyncio.wait(
  File "d:\conda\lib\asyncio\tasks.py", line 426, in wait
    return await _wait(fs, timeout, return_when, loop)
  File "d:\conda\lib\asyncio\tasks.py", line 534, in _wait
    await waiter
asyncio.exceptions.CancelledError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "d:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "d:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "d:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 14:18:45,267 - INFO - Closing down clientserver connection
2025-06-29 14:18:47,330 - INFO - Closing down clientserver connection
2025-06-29 14:18:47,331 - INFO - Closing down clientserver connection
2025-06-29 14:18:49,382 - INFO - Closing down clientserver connection
2025-06-29 14:18:49,383 - INFO - Closing down clientserver connection
2025-06-29 14:18:58,738 - INFO - 用户 7 连接到目标 6
2025-06-29 14:37:25,887 - INFO - 用户 7 断开连接
2025-06-29 14:42:06,356 - INFO - SELECT DATABASE()
2025-06-29 14:42:06,357 - INFO - [raw sql] {}
2025-06-29 14:42:06,371 - INFO - SELECT @@sql_mode
2025-06-29 14:42:06,373 - INFO - [raw sql] {}
2025-06-29 14:42:06,374 - INFO - SELECT @@lower_case_table_names
2025-06-29 14:42:06,374 - INFO - [raw sql] {}
2025-06-29 14:42:06,376 - INFO - BEGIN (implicit)
2025-06-29 14:42:06,391 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:42:06,391 - INFO - [generated in 0.00046s] {'id_1': 7}
2025-06-29 14:42:06,397 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:42:06,397 - INFO - [cached since 0.0063s ago] {'id_1': 7}
2025-06-29 14:42:06,399 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:42:06,399 - INFO - [cached since 0.008857s ago] {'id_1': 9}
2025-06-29 14:42:06,402 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:42:06,408 - INFO - [cached since 0.01776s ago] {'id_1': 10}
2025-06-29 14:42:06,411 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:42:06,411 - INFO - [cached since 0.02043s ago] {'id_1': 10}
2025-06-29 14:42:06,413 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:42:06,415 - INFO - [cached since 0.02341s ago] {'id_1': 2}
2025-06-29 14:42:06,419 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:42:06,420 - INFO - [cached since 0.02874s ago] {'id_1': 2}
2025-06-29 14:42:06,422 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:42:06,896 - INFO - [cached since 0.5044s ago] {'id_1': 14}
2025-06-29 14:42:06,898 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:42:06,899 - INFO - [cached since 0.5076s ago] {'id_1': 14}
2025-06-29 14:42:06,904 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:42:06,905 - INFO - [cached since 0.5136s ago] {'id_1': 14}
2025-06-29 14:42:06,908 - INFO - ROLLBACK
2025-06-29 14:42:48,541 - INFO - 发送验证码: phone=12345543212, code=372761
2025-06-29 14:42:50,115 - INFO - BEGIN (implicit)
2025-06-29 14:42:50,117 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.phone = %(phone_1)s
2025-06-29 14:42:50,117 - INFO - [generated in 0.00052s] {'phone_1': '12345543212'}
2025-06-29 14:42:50,121 - INFO - ROLLBACK
2025-06-29 14:42:53,269 - INFO - BEGIN (implicit)
2025-06-29 14:42:53,269 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:42:53,270 - INFO - [cached since 46.88s ago] {'id_1': 7}
2025-06-29 14:42:53,273 - INFO - ROLLBACK
2025-06-29 14:42:53,293 - INFO - 用户 6 连接到目标 7
2025-06-29 14:42:59,476 - INFO - BEGIN (implicit)
2025-06-29 14:42:59,477 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:42:59,477 - INFO - [cached since 53.09s ago] {'id_1': 6}
2025-06-29 14:42:59,480 - INFO - ROLLBACK
2025-06-29 14:42:59,502 - INFO - 用户 7 连接到目标 6
2025-06-29 14:43:12,392 - INFO - 收到消息 from 7 to 6: {'id': 1751179392391, 'text': '噢噢噢噢', 'time': '2025-06-29T06:43:12.391Z', 'from': 7, 'to': 6, 'fromUsername': '赵敏', 'fromPhoto': '/avatar/ph_12345678921_f039.png'}
2025-06-29 14:43:15,834 - INFO - 用户 7 连接到目标 6
2025-06-29 14:43:45,911 - INFO - 收到消息 from 7 to 6: {'id': 1751179425910, 'text': '777888', 'time': '2025-06-29T06:43:45.910Z', 'from': 7, 'to': 6, 'fromUsername': '赵敏', 'fromPhoto': '/avatar/ph_12345678921_f039.png'}
2025-06-29 14:43:48,940 - INFO - 用户 7 连接到目标 6
2025-06-29 14:44:04,344 - INFO - 收到消息 from 7 to 6: {'id': 1751179444342, 'text': '89898', 'time': '2025-06-29T06:44:04.342Z', 'from': 7, 'to': 6, 'fromUsername': '赵敏', 'fromPhoto': '/avatar/ph_12345678921_f039.png'}
2025-06-29 14:44:07,378 - INFO - 用户 7 连接到目标 6
2025-06-29 14:45:35,829 - INFO - 收到消息 from 7 to 6: {'id': 1751179535828, 'text': '666777', 'time': '2025-06-29T06:45:35.828Z', 'from': 7, 'to': 6, 'fromUsername': '赵敏', 'fromPhoto': '/avatar/ph_12345678921_f039.png'}
2025-06-29 14:45:38,898 - INFO - 用户 7 连接到目标 6
2025-06-29 14:47:08,055 - INFO - 收到消息 from 7 to 6: {'id': 1751179628053, 'text': '事实上', 'time': '2025-06-29T06:47:08.053Z', 'from': 7, 'to': 6, 'fromUsername': '赵敏', 'fromPhoto': '/avatar/ph_12345678921_f039.png'}
2025-06-29 14:47:11,095 - INFO - 用户 7 连接到目标 6
2025-06-29 14:49:00,372 - INFO - 用户 7 连接到目标 6
2025-06-29 14:49:38,908 - INFO - 收到消息 from 7 to 6: {'id': 1751179778907, 'text': '67788', 'time': '2025-06-29T06:49:38.907Z', 'from': 7, 'to': 6, 'fromUsername': '赵敏', 'fromPhoto': '/avatar/ph_12345678921_f039.png'}
2025-06-29 14:49:38,909 - INFO - 目标用户 6 离线，消息将存储为离线消息
2025-06-29 14:49:38,939 - INFO - SELECT DATABASE()
2025-06-29 14:49:38,940 - INFO - [raw sql] {}
2025-06-29 14:49:38,944 - INFO - SELECT @@sql_mode
2025-06-29 14:49:38,945 - INFO - [raw sql] {}
2025-06-29 14:49:38,945 - INFO - SELECT @@lower_case_table_names
2025-06-29 14:49:38,947 - INFO - [raw sql] {}
2025-06-29 14:49:38,949 - INFO - BEGIN (implicit)
2025-06-29 14:49:38,961 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:49:38,962 - INFO - [generated in 0.00047s] {'id_1': '6'}
2025-06-29 14:49:50,458 - INFO - 用户 6 连接到目标 7
2025-06-29 14:50:06,994 - INFO - 收到消息 from 7 to 6: {'id': 1751179806994, 'text': '十点十分十分', 'time': '2025-06-29T06:50:06.994Z', 'from': 7, 'to': 6, 'fromUsername': '赵敏', 'fromPhoto': '/avatar/ph_12345678921_f039.png'}
2025-06-29 14:50:06,997 - INFO - ROLLBACK
2025-06-29 14:50:10,047 - INFO - 用户 7 连接到目标 6
2025-06-29 14:50:41,027 - INFO - 用户 6 断开连接
2025-06-29 14:50:41,029 - INFO - 用户 7 断开连接
2025-06-29 14:50:41,544 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 14:50:41,545 - INFO - Closing down clientserver connection
2025-06-29 14:50:41,545 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 14:50:41,546 - INFO - Closing down clientserver connection
2025-06-29 14:50:52,395 - INFO - 用户 7 连接到目标 6
2025-06-29 14:50:59,546 - INFO - 收到消息 from 7 to 6: {'id': 1751179859545, 'text': '撒范德萨', 'time': '2025-06-29T06:50:59.545Z', 'from': 7, 'to': 6, 'fromUsername': '赵敏', 'fromPhoto': '/avatar/ph_12345678921_f039.png'}
2025-06-29 14:50:59,547 - INFO - 目标用户 6 离线，消息将存储为离线消息
2025-06-29 14:50:59,562 - INFO - SELECT DATABASE()
2025-06-29 14:50:59,564 - INFO - [raw sql] {}
2025-06-29 14:50:59,566 - INFO - SELECT @@sql_mode
2025-06-29 14:50:59,567 - INFO - [raw sql] {}
2025-06-29 14:50:59,568 - INFO - SELECT @@lower_case_table_names
2025-06-29 14:50:59,568 - INFO - [raw sql] {}
2025-06-29 14:50:59,571 - INFO - BEGIN (implicit)
2025-06-29 14:50:59,584 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:50:59,584 - INFO - [generated in 0.00046s] {'id_1': '6'}
2025-06-29 14:51:03,569 - INFO - 用户 6 连接到目标 7
2025-06-29 14:51:11,725 - INFO - 用户 6 断开连接
2025-06-29 14:51:12,464 - INFO - BEGIN (implicit)
2025-06-29 14:51:12,465 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:51:12,466 - INFO - [generated in 0.00053s] {'id_1': 7}
2025-06-29 14:51:12,470 - INFO - ROLLBACK
2025-06-29 14:51:12,501 - INFO - 用户 6 连接到目标 7
2025-06-29 14:51:20,283 - INFO - 收到消息 from 6 to 7: {'id': 1751179880282, 'text': '嗡嗡嗡', 'time': '2025-06-29T06:51:20.282Z', 'from': 6, 'to': 7, 'fromUsername': '张无忌', 'fromPhoto': '/avatar/ph_12345543212_850a.png'}
2025-06-29 14:51:20,287 - INFO - BEGIN (implicit)
2025-06-29 14:51:20,287 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:51:20,289 - INFO - [cached since 20.71s ago] {'id_1': '7'}
2025-06-29 14:53:17,434 - INFO - 用户 7 断开连接
2025-06-29 14:53:17,437 - INFO - ROLLBACK
2025-06-29 14:53:22,473 - INFO - BEGIN (implicit)
2025-06-29 14:53:22,475 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:53:22,479 - INFO - [cached since 130s ago] {'id_1': 6}
2025-06-29 14:53:22,489 - INFO - ROLLBACK
2025-06-29 14:53:47,878 - INFO - BEGIN (implicit)
2025-06-29 14:53:47,880 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:53:47,880 - INFO - [cached since 155.4s ago] {'id_1': 6}
2025-06-29 14:53:47,883 - INFO - ROLLBACK
2025-06-29 14:53:47,898 - INFO - 用户 7 连接到目标 6
2025-06-29 14:53:57,912 - INFO - 收到消息 from 7 to 6: {'id': 1751180037910, 'text': '123456', 'time': '2025-06-29T06:53:57.910Z', 'from': 7, 'to': 6, 'fromUsername': '赵敏', 'fromPhoto': '/avatar/ph_12345678921_f039.png'}
2025-06-29 14:53:57,922 - INFO - BEGIN (implicit)
2025-06-29 14:53:57,923 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:53:57,924 - INFO - [cached since 178.3s ago] {'id_1': '6'}
2025-06-29 14:55:54,710 - INFO - 用户 7 断开连接
2025-06-29 14:55:54,711 - INFO - ROLLBACK
2025-06-29 14:56:07,608 - INFO - BEGIN (implicit)
2025-06-29 14:56:07,609 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:56:07,609 - INFO - [cached since 295.1s ago] {'id_1': 6}
2025-06-29 14:56:07,617 - INFO - ROLLBACK
2025-06-29 14:56:35,114 - INFO - 发送验证码: phone=12345678921, code=397090
2025-06-29 14:56:36,400 - INFO - BEGIN (implicit)
2025-06-29 14:56:36,402 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.phone = %(phone_1)s
2025-06-29 14:56:36,403 - INFO - [generated in 0.00039s] {'phone_1': '12345678921'}
2025-06-29 14:56:36,406 - INFO - ROLLBACK
2025-06-29 14:56:38,523 - INFO - BEGIN (implicit)
2025-06-29 14:56:38,524 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:56:38,524 - INFO - [cached since 326.1s ago] {'id_1': 6}
2025-06-29 14:56:38,557 - INFO - ROLLBACK
2025-06-29 14:56:38,585 - INFO - 用户 7 连接到目标 6
2025-06-29 14:56:53,672 - INFO - 用户 7 断开连接
2025-06-29 14:56:55,345 - INFO - BEGIN (implicit)
2025-06-29 14:56:55,346 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:56:55,347 - INFO - [cached since 342.9s ago] {'id_1': 6}
2025-06-29 14:56:55,358 - INFO - ROLLBACK
2025-06-29 14:56:55,386 - INFO - 用户 7 连接到目标 6
2025-06-29 14:57:29,799 - INFO - 用户 7 断开连接
2025-06-29 14:57:31,319 - INFO - BEGIN (implicit)
2025-06-29 14:57:31,319 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 14:57:31,319 - INFO - [cached since 378.9s ago] {'id_1': 6}
2025-06-29 14:57:31,322 - INFO - ROLLBACK
2025-06-29 14:57:31,397 - INFO - 用户 7 连接到目标 6
2025-06-29 15:03:11,518 - INFO - 用户 7 断开连接
2025-06-29 15:03:13,242 - INFO - BEGIN (implicit)
2025-06-29 15:03:13,243 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:03:13,246 - INFO - [cached since 720.8s ago] {'id_1': 6}
2025-06-29 15:03:13,250 - INFO - ROLLBACK
2025-06-29 15:03:13,269 - INFO - 用户 7 连接到目标 6
2025-06-29 15:03:26,218 - INFO - 用户 6 断开连接
2025-06-29 15:03:26,219 - INFO - ROLLBACK
2025-06-29 15:03:28,005 - INFO - BEGIN (implicit)
2025-06-29 15:03:28,007 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:03:28,007 - INFO - [cached since 735.5s ago] {'id_1': 7}
2025-06-29 15:03:28,052 - INFO - ROLLBACK
2025-06-29 15:03:28,076 - INFO - 用户 6 连接到目标 7
2025-06-29 15:03:55,951 - INFO - 用户 7 断开连接
2025-06-29 15:03:55,952 - INFO - 用户 6 断开连接
2025-06-29 15:03:56,532 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 15:03:56,535 - INFO - Closing down clientserver connection
2025-06-29 15:03:56,535 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 15:03:56,537 - INFO - Closing down clientserver connection
2025-06-29 15:04:11,353 - INFO - 用户 7 连接到目标 6
2025-06-29 15:05:44,910 - INFO - 用户 7 断开连接
2025-06-29 15:05:45,460 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 15:05:45,462 - INFO - Closing down clientserver connection
2025-06-29 15:05:45,462 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 15:05:45,464 - INFO - Closing down clientserver connection
2025-06-29 15:05:55,382 - INFO - 用户 7 连接到目标 6
2025-06-29 15:06:26,724 - INFO - 用户 7 断开连接
2025-06-29 15:06:27,284 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 15:06:27,286 - INFO - Closing down clientserver connection
2025-06-29 15:06:27,286 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 15:06:27,289 - INFO - Closing down clientserver connection
2025-06-29 15:06:38,438 - INFO - 用户 7 连接到目标 6
2025-06-29 15:07:38,781 - INFO - 用户 7 断开连接
2025-06-29 15:07:39,362 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 15:07:39,363 - INFO - Closing down clientserver connection
2025-06-29 15:07:39,365 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 15:07:39,366 - INFO - Closing down clientserver connection
2025-06-29 15:07:50,392 - INFO - 用户 7 连接到目标 6
2025-06-29 15:09:34,914 - INFO - 用户 7 断开连接
2025-06-29 15:09:35,400 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 15:09:35,401 - INFO - Closing down clientserver connection
2025-06-29 15:09:35,401 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 15:09:35,402 - INFO - Closing down clientserver connection
2025-06-29 15:09:46,362 - INFO - 用户 7 连接到目标 6
2025-06-29 15:09:57,482 - INFO - 用户 7 断开连接
2025-06-29 15:09:59,478 - INFO - SELECT DATABASE()
2025-06-29 15:09:59,479 - INFO - [raw sql] {}
2025-06-29 15:09:59,482 - INFO - SELECT @@sql_mode
2025-06-29 15:09:59,482 - INFO - [raw sql] {}
2025-06-29 15:09:59,485 - INFO - SELECT @@lower_case_table_names
2025-06-29 15:09:59,485 - INFO - [raw sql] {}
2025-06-29 15:09:59,487 - INFO - BEGIN (implicit)
2025-06-29 15:09:59,538 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:09:59,539 - INFO - [generated in 0.00097s] {'id_1': 6}
2025-06-29 15:09:59,543 - INFO - ROLLBACK
2025-06-29 15:09:59,579 - INFO - 用户 7 连接到目标 6
2025-06-29 15:10:27,802 - INFO - 用户 7 断开连接
2025-06-29 15:10:28,309 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 15:10:28,311 - INFO - Closing down clientserver connection
2025-06-29 15:10:28,311 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 15:10:28,313 - INFO - Closing down clientserver connection
2025-06-29 15:10:43,399 - INFO - 用户 7 连接到目标 6
2025-06-29 15:11:01,590 - INFO - 用户 7 断开连接
2025-06-29 15:11:03,675 - INFO - SELECT DATABASE()
2025-06-29 15:11:03,675 - INFO - [raw sql] {}
2025-06-29 15:11:03,677 - INFO - SELECT @@sql_mode
2025-06-29 15:11:03,678 - INFO - [raw sql] {}
2025-06-29 15:11:03,680 - INFO - SELECT @@lower_case_table_names
2025-06-29 15:11:03,680 - INFO - [raw sql] {}
2025-06-29 15:11:03,683 - INFO - BEGIN (implicit)
2025-06-29 15:11:03,693 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:11:03,693 - INFO - [generated in 0.00041s] {'id_1': 6}
2025-06-29 15:11:03,696 - INFO - ROLLBACK
2025-06-29 15:11:03,718 - INFO - 用户 7 连接到目标 6
2025-06-29 15:13:32,246 - INFO - 用户 7 断开连接
2025-06-29 15:13:33,936 - INFO - BEGIN (implicit)
2025-06-29 15:13:33,937 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:13:33,937 - INFO - [cached since 150.2s ago] {'id_1': 6}
2025-06-29 15:13:33,942 - INFO - ROLLBACK
2025-06-29 15:13:33,962 - INFO - 用户 7 连接到目标 6
2025-06-29 15:14:28,852 - INFO - 用户 6 连接到目标 7
2025-06-29 15:15:14,396 - INFO - 用户 7 断开连接
2025-06-29 15:15:16,146 - INFO - BEGIN (implicit)
2025-06-29 15:15:16,148 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:15:16,148 - INFO - [cached since 252.5s ago] {'id_1': 6}
2025-06-29 15:15:16,153 - INFO - ROLLBACK
2025-06-29 15:15:16,180 - INFO - 用户 7 连接到目标 6
2025-06-29 15:15:45,540 - INFO - 用户 7 断开连接
2025-06-29 15:15:47,037 - INFO - BEGIN (implicit)
2025-06-29 15:15:47,038 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:15:47,039 - INFO - [cached since 283.3s ago] {'id_1': 6}
2025-06-29 15:15:47,045 - INFO - ROLLBACK
2025-06-29 15:15:47,076 - INFO - 用户 7 连接到目标 6
2025-06-29 15:17:37,500 - INFO - 用户 6 断开连接
2025-06-29 15:17:37,549 - INFO - BEGIN (implicit)
2025-06-29 15:17:37,549 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:17:37,549 - INFO - [cached since 393.9s ago] {'id_1': 7}
2025-06-29 15:17:37,553 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:17:37,554 - INFO - [cached since 393.9s ago] {'id_1': 7}
2025-06-29 15:17:37,557 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:17:37,557 - INFO - [cached since 393.9s ago] {'id_1': 9}
2025-06-29 15:17:37,560 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:17:37,560 - INFO - [cached since 393.9s ago] {'id_1': 10}
2025-06-29 15:17:37,563 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:17:37,564 - INFO - [cached since 393.9s ago] {'id_1': 10}
2025-06-29 15:17:37,567 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:17:37,567 - INFO - [cached since 393.9s ago] {'id_1': 2}
2025-06-29 15:17:37,570 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:17:37,570 - INFO - [cached since 393.9s ago] {'id_1': 2}
2025-06-29 15:17:37,573 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:17:37,573 - INFO - [cached since 393.9s ago] {'id_1': 14}
2025-06-29 15:17:37,576 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:17:37,576 - INFO - [cached since 393.9s ago] {'id_1': 14}
2025-06-29 15:17:37,579 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:17:37,580 - INFO - [cached since 393.9s ago] {'id_1': 14}
2025-06-29 15:17:37,583 - INFO - ROLLBACK
2025-06-29 15:17:40,542 - INFO - 用户 6 连接到目标 7
2025-06-29 15:18:19,963 - INFO - BEGIN (implicit)
2025-06-29 15:18:19,964 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:19,964 - INFO - [cached since 436.3s ago] {'id_1': 6}
2025-06-29 15:18:19,970 - INFO - ROLLBACK
2025-06-29 15:18:20,047 - INFO - 用户 6 断开连接
2025-06-29 15:18:20,136 - INFO - BEGIN (implicit)
2025-06-29 15:18:20,137 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:20,137 - INFO - [cached since 436.4s ago] {'id_1': 6}
2025-06-29 15:18:20,140 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:20,140 - INFO - [cached since 436.5s ago] {'id_1': 7}
2025-06-29 15:18:20,143 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:20,143 - INFO - [cached since 436.5s ago] {'id_1': 7}
2025-06-29 15:18:20,146 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:20,146 - INFO - [cached since 436.5s ago] {'id_1': 9}
2025-06-29 15:18:20,149 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:20,149 - INFO - [cached since 436.5s ago] {'id_1': 10}
2025-06-29 15:18:20,152 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:20,153 - INFO - [cached since 436.5s ago] {'id_1': 10}
2025-06-29 15:18:20,157 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:20,157 - INFO - [cached since 436.5s ago] {'id_1': 2}
2025-06-29 15:18:20,160 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:20,161 - INFO - [cached since 436.5s ago] {'id_1': 2}
2025-06-29 15:18:20,164 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:20,164 - INFO - [cached since 436.5s ago] {'id_1': 14}
2025-06-29 15:18:20,166 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:20,167 - INFO - [cached since 436.5s ago] {'id_1': 14}
2025-06-29 15:18:20,170 - INFO - ROLLBACK
2025-06-29 15:18:21,732 - INFO - BEGIN (implicit)
2025-06-29 15:18:21,732 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:21,733 - INFO - [cached since 438s ago] {'id_1': 6}
2025-06-29 15:18:21,735 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:21,736 - INFO - [cached since 438s ago] {'id_1': 7}
2025-06-29 15:18:21,740 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:21,740 - INFO - [cached since 438s ago] {'id_1': 7}
2025-06-29 15:18:21,743 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:21,743 - INFO - [cached since 438.1s ago] {'id_1': 9}
2025-06-29 15:18:21,746 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:21,746 - INFO - [cached since 438.1s ago] {'id_1': 10}
2025-06-29 15:18:21,749 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:21,749 - INFO - [cached since 438.1s ago] {'id_1': 10}
2025-06-29 15:18:21,751 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:21,752 - INFO - [cached since 438.1s ago] {'id_1': 2}
2025-06-29 15:18:21,755 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:21,756 - INFO - [cached since 438.1s ago] {'id_1': 2}
2025-06-29 15:18:21,759 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:21,759 - INFO - [cached since 438.1s ago] {'id_1': 14}
2025-06-29 15:18:21,761 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:21,762 - INFO - [cached since 438.1s ago] {'id_1': 14}
2025-06-29 15:18:21,768 - INFO - ROLLBACK
2025-06-29 15:18:27,705 - INFO - BEGIN (implicit)
2025-06-29 15:18:27,706 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:27,706 - INFO - [cached since 444s ago] {'id_1': 6}
2025-06-29 15:18:27,708 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:27,709 - INFO - [cached since 444s ago] {'id_1': 7}
2025-06-29 15:18:27,711 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:27,712 - INFO - [cached since 444s ago] {'id_1': 7}
2025-06-29 15:18:27,714 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:27,715 - INFO - [cached since 444s ago] {'id_1': 9}
2025-06-29 15:18:27,717 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:27,718 - INFO - [cached since 444s ago] {'id_1': 10}
2025-06-29 15:18:27,721 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:27,721 - INFO - [cached since 444s ago] {'id_1': 10}
2025-06-29 15:18:27,724 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:27,725 - INFO - [cached since 444s ago] {'id_1': 2}
2025-06-29 15:18:27,727 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:27,728 - INFO - [cached since 444s ago] {'id_1': 2}
2025-06-29 15:18:27,731 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:27,731 - INFO - [cached since 444s ago] {'id_1': 14}
2025-06-29 15:18:27,734 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:27,734 - INFO - [cached since 444s ago] {'id_1': 14}
2025-06-29 15:18:27,740 - INFO - ROLLBACK
2025-06-29 15:18:29,359 - INFO - BEGIN (implicit)
2025-06-29 15:18:29,360 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:29,361 - INFO - [cached since 445.7s ago] {'id_1': 6}
2025-06-29 15:18:29,367 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:29,367 - INFO - [cached since 445.7s ago] {'id_1': 6}
2025-06-29 15:18:29,369 - INFO - ROLLBACK
2025-06-29 15:18:31,540 - INFO - BEGIN (implicit)
2025-06-29 15:18:31,541 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:31,541 - INFO - [cached since 447.9s ago] {'id_1': 6}
2025-06-29 15:18:31,544 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:31,544 - INFO - [cached since 447.9s ago] {'id_1': 7}
2025-06-29 15:18:31,546 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:31,546 - INFO - [cached since 447.9s ago] {'id_1': 7}
2025-06-29 15:18:31,547 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:31,548 - INFO - [cached since 447.9s ago] {'id_1': 9}
2025-06-29 15:18:31,549 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:31,549 - INFO - [cached since 447.9s ago] {'id_1': 10}
2025-06-29 15:18:31,550 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:31,551 - INFO - [cached since 447.9s ago] {'id_1': 10}
2025-06-29 15:18:31,552 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:31,552 - INFO - [cached since 447.9s ago] {'id_1': 2}
2025-06-29 15:18:31,553 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:31,553 - INFO - [cached since 447.9s ago] {'id_1': 2}
2025-06-29 15:18:31,556 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:31,556 - INFO - [cached since 447.9s ago] {'id_1': 14}
2025-06-29 15:18:31,559 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:31,559 - INFO - [cached since 447.9s ago] {'id_1': 14}
2025-06-29 15:18:31,561 - INFO - ROLLBACK
2025-06-29 15:18:43,385 - INFO - BEGIN (implicit)
2025-06-29 15:18:43,389 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:43,389 - INFO - [cached since 459.7s ago] {'id_1': 6}
2025-06-29 15:18:43,401 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:43,402 - INFO - [cached since 459.7s ago] {'id_1': 7}
2025-06-29 15:18:43,418 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:43,419 - INFO - [cached since 459.7s ago] {'id_1': 7}
2025-06-29 15:18:43,426 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:43,426 - INFO - [cached since 459.7s ago] {'id_1': 9}
2025-06-29 15:18:43,428 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:43,428 - INFO - [cached since 459.7s ago] {'id_1': 10}
2025-06-29 15:18:43,431 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:43,431 - INFO - [cached since 459.7s ago] {'id_1': 10}
2025-06-29 15:18:43,434 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:43,434 - INFO - [cached since 459.7s ago] {'id_1': 2}
2025-06-29 15:18:43,440 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:43,440 - INFO - [cached since 459.8s ago] {'id_1': 2}
2025-06-29 15:18:43,442 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:43,443 - INFO - [cached since 459.8s ago] {'id_1': 14}
2025-06-29 15:18:43,446 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:43,446 - INFO - [cached since 459.8s ago] {'id_1': 14}
2025-06-29 15:18:43,449 - INFO - ROLLBACK
2025-06-29 15:18:52,434 - INFO - 用户 7 断开连接
2025-06-29 15:18:52,450 - INFO - BEGIN (implicit)
2025-06-29 15:18:52,453 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:52,461 - INFO - [cached since 468.8s ago] {'id_1': 6}
2025-06-29 15:18:52,464 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:52,465 - INFO - [cached since 468.8s ago] {'id_1': 7}
2025-06-29 15:18:52,472 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:52,472 - INFO - [cached since 468.8s ago] {'id_1': 7}
2025-06-29 15:18:52,475 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:52,475 - INFO - [cached since 468.8s ago] {'id_1': 9}
2025-06-29 15:18:52,477 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:52,477 - INFO - [cached since 468.8s ago] {'id_1': 10}
2025-06-29 15:18:52,481 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:52,481 - INFO - [cached since 468.8s ago] {'id_1': 10}
2025-06-29 15:18:52,483 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:52,483 - INFO - [cached since 468.8s ago] {'id_1': 2}
2025-06-29 15:18:52,490 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:52,490 - INFO - [cached since 468.8s ago] {'id_1': 2}
2025-06-29 15:18:52,493 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:52,493 - INFO - [cached since 468.8s ago] {'id_1': 14}
2025-06-29 15:18:52,496 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:52,496 - INFO - [cached since 468.8s ago] {'id_1': 14}
2025-06-29 15:18:52,498 - INFO - ROLLBACK
2025-06-29 15:18:55,473 - INFO - 用户 7 连接到目标 6
2025-06-29 15:18:56,346 - INFO - BEGIN (implicit)
2025-06-29 15:18:56,347 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:56,347 - INFO - [cached since 472.7s ago] {'id_1': 6}
2025-06-29 15:18:56,362 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:18:56,362 - INFO - [cached since 472.7s ago] {'id_1': 6}
2025-06-29 15:18:56,369 - INFO - ROLLBACK
2025-06-29 15:20:09,055 - INFO - BEGIN (implicit)
2025-06-29 15:20:09,057 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:20:09,057 - INFO - [cached since 545.4s ago] {'id_1': 6}
2025-06-29 15:20:09,064 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:20:09,064 - INFO - [cached since 545.4s ago] {'id_1': 7}
2025-06-29 15:20:09,067 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:20:09,067 - INFO - [cached since 545.4s ago] {'id_1': 7}
2025-06-29 15:20:09,069 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:20:09,069 - INFO - [cached since 545.4s ago] {'id_1': 9}
2025-06-29 15:20:09,071 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:20:09,072 - INFO - [cached since 545.4s ago] {'id_1': 10}
2025-06-29 15:20:09,074 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:20:09,074 - INFO - [cached since 545.4s ago] {'id_1': 10}
2025-06-29 15:20:09,079 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:20:09,079 - INFO - [cached since 545.4s ago] {'id_1': 2}
2025-06-29 15:20:09,081 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:20:09,082 - INFO - [cached since 545.4s ago] {'id_1': 2}
2025-06-29 15:20:09,083 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:20:09,084 - INFO - [cached since 545.4s ago] {'id_1': 14}
2025-06-29 15:20:09,085 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:20:09,085 - INFO - [cached since 545.4s ago] {'id_1': 14}
2025-06-29 15:20:09,088 - INFO - ROLLBACK
2025-06-29 15:23:30,709 - INFO - 用户 7 断开连接
2025-06-29 15:23:31,306 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 15:23:31,346 - INFO - Closing down clientserver connection
2025-06-29 15:23:31,347 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 15:23:31,367 - INFO - Closing down clientserver connection
2025-06-29 15:24:03,869 - INFO - 用户 7 连接到目标 6
2025-06-29 15:24:17,680 - INFO - SELECT DATABASE()
2025-06-29 15:24:17,680 - INFO - [raw sql] {}
2025-06-29 15:24:17,681 - INFO - SELECT @@sql_mode
2025-06-29 15:24:17,681 - INFO - [raw sql] {}
2025-06-29 15:24:17,682 - INFO - SELECT @@lower_case_table_names
2025-06-29 15:24:17,683 - INFO - [raw sql] {}
2025-06-29 15:24:17,686 - INFO - BEGIN (implicit)
2025-06-29 15:24:17,700 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:17,700 - INFO - [generated in 0.00055s] {'id_1': 7}
2025-06-29 15:24:17,707 - INFO - ROLLBACK
2025-06-29 15:24:17,757 - INFO - BEGIN (implicit)
2025-06-29 15:24:17,764 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:17,766 - INFO - [cached since 0.066s ago] {'id_1': 7}
2025-06-29 15:24:17,781 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:17,781 - INFO - [cached since 0.0812s ago] {'id_1': 6}
2025-06-29 15:24:17,784 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:17,785 - INFO - [cached since 0.08448s ago] {'id_1': 7}
2025-06-29 15:24:17,788 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:17,789 - INFO - [cached since 0.08855s ago] {'id_1': 7}
2025-06-29 15:24:17,794 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:17,795 - INFO - [cached since 0.09456s ago] {'id_1': 9}
2025-06-29 15:24:17,797 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:17,799 - INFO - [cached since 0.09826s ago] {'id_1': 10}
2025-06-29 15:24:17,802 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:17,803 - INFO - [cached since 0.1023s ago] {'id_1': 10}
2025-06-29 15:24:17,805 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:17,805 - INFO - [cached since 0.105s ago] {'id_1': 2}
2025-06-29 15:24:17,807 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:17,808 - INFO - [cached since 0.1076s ago] {'id_1': 2}
2025-06-29 15:24:17,817 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:17,817 - INFO - [cached since 0.1172s ago] {'id_1': 14}
2025-06-29 15:24:17,820 - INFO - ROLLBACK
2025-06-29 15:24:18,168 - INFO - 用户 7 断开连接
2025-06-29 15:24:20,230 - INFO - BEGIN (implicit)
2025-06-29 15:24:20,231 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:20,231 - INFO - [cached since 2.532s ago] {'id_1': 7}
2025-06-29 15:24:20,241 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:20,243 - INFO - [cached since 2.542s ago] {'id_1': 6}
2025-06-29 15:24:20,246 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:20,247 - INFO - [cached since 2.546s ago] {'id_1': 7}
2025-06-29 15:24:20,249 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:20,249 - INFO - [cached since 2.549s ago] {'id_1': 7}
2025-06-29 15:24:20,252 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:20,252 - INFO - [cached since 2.552s ago] {'id_1': 9}
2025-06-29 15:24:20,256 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:20,256 - INFO - [cached since 2.556s ago] {'id_1': 10}
2025-06-29 15:24:20,260 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:20,260 - INFO - [cached since 2.56s ago] {'id_1': 10}
2025-06-29 15:24:20,262 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:20,262 - INFO - [cached since 2.562s ago] {'id_1': 2}
2025-06-29 15:24:20,264 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:20,265 - INFO - [cached since 2.564s ago] {'id_1': 2}
2025-06-29 15:24:20,267 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:20,268 - INFO - [cached since 2.567s ago] {'id_1': 14}
2025-06-29 15:24:20,270 - INFO - ROLLBACK
2025-06-29 15:24:24,445 - INFO - BEGIN (implicit)
2025-06-29 15:24:24,446 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:24,447 - INFO - [cached since 6.746s ago] {'id_1': 7}
2025-06-29 15:24:24,455 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:24,457 - INFO - [cached since 6.756s ago] {'id_1': 7}
2025-06-29 15:24:24,462 - INFO - ROLLBACK
2025-06-29 15:24:30,105 - INFO - BEGIN (implicit)
2025-06-29 15:24:30,106 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:30,106 - INFO - [cached since 12.41s ago] {'id_1': 6}
2025-06-29 15:24:30,114 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:30,115 - INFO - [cached since 12.42s ago] {'id_1': 7}
2025-06-29 15:24:30,118 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:30,119 - INFO - [cached since 12.42s ago] {'id_1': 7}
2025-06-29 15:24:30,122 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:30,122 - INFO - [cached since 12.42s ago] {'id_1': 9}
2025-06-29 15:24:30,128 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:30,128 - INFO - [cached since 12.43s ago] {'id_1': 10}
2025-06-29 15:24:30,131 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:30,131 - INFO - [cached since 12.43s ago] {'id_1': 10}
2025-06-29 15:24:30,133 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:30,133 - INFO - [cached since 12.43s ago] {'id_1': 2}
2025-06-29 15:24:30,135 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:30,135 - INFO - [cached since 12.44s ago] {'id_1': 2}
2025-06-29 15:24:30,137 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:30,137 - INFO - [cached since 12.44s ago] {'id_1': 14}
2025-06-29 15:24:30,138 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:30,139 - INFO - [cached since 12.44s ago] {'id_1': 14}
2025-06-29 15:24:30,144 - INFO - ROLLBACK
2025-06-29 15:24:39,648 - INFO - BEGIN (implicit)
2025-06-29 15:24:39,671 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:39,693 - INFO - [cached since 21.99s ago] {'id_1': 7}
2025-06-29 15:24:39,697 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:39,697 - INFO - [cached since 22s ago] {'id_1': 7}
2025-06-29 15:24:39,701 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:39,701 - INFO - [cached since 22s ago] {'id_1': 9}
2025-06-29 15:24:39,704 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:39,704 - INFO - [cached since 22s ago] {'id_1': 10}
2025-06-29 15:24:39,709 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:39,709 - INFO - [cached since 22.01s ago] {'id_1': 10}
2025-06-29 15:24:39,711 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:39,712 - INFO - [cached since 22.01s ago] {'id_1': 2}
2025-06-29 15:24:39,714 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:39,714 - INFO - [cached since 22.01s ago] {'id_1': 2}
2025-06-29 15:24:39,716 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:39,717 - INFO - [cached since 22.02s ago] {'id_1': 14}
2025-06-29 15:24:39,719 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:39,720 - INFO - [cached since 22.02s ago] {'id_1': 14}
2025-06-29 15:24:39,723 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:24:39,723 - INFO - [cached since 22.02s ago] {'id_1': 14}
2025-06-29 15:24:39,726 - INFO - ROLLBACK
2025-06-29 15:25:05,939 - INFO - BEGIN (implicit)
2025-06-29 15:25:05,940 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:05,941 - INFO - [cached since 48.24s ago] {'id_1': 6}
2025-06-29 15:25:05,947 - INFO - ROLLBACK
2025-06-29 15:25:07,625 - INFO - BEGIN (implicit)
2025-06-29 15:25:07,626 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:07,626 - INFO - [cached since 49.93s ago] {'id_1': 6}
2025-06-29 15:25:07,636 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:07,637 - INFO - [cached since 49.94s ago] {'id_1': 7}
2025-06-29 15:25:07,639 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:07,639 - INFO - [cached since 49.94s ago] {'id_1': 7}
2025-06-29 15:25:07,642 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:07,642 - INFO - [cached since 49.94s ago] {'id_1': 9}
2025-06-29 15:25:07,645 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:07,645 - INFO - [cached since 49.95s ago] {'id_1': 10}
2025-06-29 15:25:07,650 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:07,650 - INFO - [cached since 49.95s ago] {'id_1': 10}
2025-06-29 15:25:07,655 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:07,655 - INFO - [cached since 49.96s ago] {'id_1': 2}
2025-06-29 15:25:07,693 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:07,694 - INFO - [cached since 49.99s ago] {'id_1': 2}
2025-06-29 15:25:07,701 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:07,701 - INFO - [cached since 50s ago] {'id_1': 14}
2025-06-29 15:25:07,705 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:07,706 - INFO - [cached since 50.01s ago] {'id_1': 14}
2025-06-29 15:25:07,709 - INFO - ROLLBACK
2025-06-29 15:25:13,234 - INFO - BEGIN (implicit)
2025-06-29 15:25:13,236 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:13,237 - INFO - [cached since 55.54s ago] {'id_1': 6}
2025-06-29 15:25:13,249 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:13,249 - INFO - [cached since 55.55s ago] {'id_1': 7}
2025-06-29 15:25:13,254 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:13,254 - INFO - [cached since 55.55s ago] {'id_1': 7}
2025-06-29 15:25:13,258 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:13,258 - INFO - [cached since 55.56s ago] {'id_1': 9}
2025-06-29 15:25:13,282 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:13,282 - INFO - [cached since 55.58s ago] {'id_1': 10}
2025-06-29 15:25:13,288 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:13,290 - INFO - [cached since 55.59s ago] {'id_1': 10}
2025-06-29 15:25:13,292 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:13,292 - INFO - [cached since 55.59s ago] {'id_1': 2}
2025-06-29 15:25:13,296 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:13,296 - INFO - [cached since 55.6s ago] {'id_1': 2}
2025-06-29 15:25:13,299 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:13,300 - INFO - [cached since 55.6s ago] {'id_1': 14}
2025-06-29 15:25:13,304 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:13,304 - INFO - [cached since 55.6s ago] {'id_1': 14}
2025-06-29 15:25:13,307 - INFO - ROLLBACK
2025-06-29 15:25:16,829 - INFO - BEGIN (implicit)
2025-06-29 15:25:16,830 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:16,830 - INFO - [cached since 59.13s ago] {'id_1': 6}
2025-06-29 15:25:16,832 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:16,832 - INFO - [cached since 59.13s ago] {'id_1': 7}
2025-06-29 15:25:16,837 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:16,837 - INFO - [cached since 59.14s ago] {'id_1': 7}
2025-06-29 15:25:16,839 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:16,839 - INFO - [cached since 59.14s ago] {'id_1': 9}
2025-06-29 15:25:16,841 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:16,841 - INFO - [cached since 59.14s ago] {'id_1': 10}
2025-06-29 15:25:16,843 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:16,843 - INFO - [cached since 59.14s ago] {'id_1': 10}
2025-06-29 15:25:16,844 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:16,844 - INFO - [cached since 59.14s ago] {'id_1': 2}
2025-06-29 15:25:16,846 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:16,846 - INFO - [cached since 59.15s ago] {'id_1': 2}
2025-06-29 15:25:16,847 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:16,847 - INFO - [cached since 59.15s ago] {'id_1': 14}
2025-06-29 15:25:16,848 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:25:16,849 - INFO - [cached since 59.15s ago] {'id_1': 14}
2025-06-29 15:25:16,853 - INFO - ROLLBACK
2025-06-29 15:26:42,215 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 15:26:42,217 - INFO - Closing down clientserver connection
2025-06-29 15:26:42,219 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 15:26:42,220 - INFO - Closing down clientserver connection
2025-06-29 15:27:01,752 - INFO - SELECT DATABASE()
2025-06-29 15:27:01,754 - INFO - [raw sql] {}
2025-06-29 15:27:01,773 - INFO - SELECT @@sql_mode
2025-06-29 15:27:01,775 - INFO - [raw sql] {}
2025-06-29 15:27:01,778 - INFO - SELECT @@lower_case_table_names
2025-06-29 15:27:01,779 - INFO - [raw sql] {}
2025-06-29 15:27:01,782 - INFO - BEGIN (implicit)
2025-06-29 15:27:01,812 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:27:01,813 - INFO - [generated in 0.00093s] {'id_1': 6}
2025-06-29 15:27:01,818 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:27:01,818 - INFO - [cached since 0.006015s ago] {'id_1': 7}
2025-06-29 15:27:01,821 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:27:01,821 - INFO - [cached since 0.009541s ago] {'id_1': 7}
2025-06-29 15:27:01,824 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:27:01,825 - INFO - [cached since 0.01301s ago] {'id_1': 9}
2025-06-29 15:27:01,828 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:27:01,828 - INFO - [cached since 0.01583s ago] {'id_1': 10}
2025-06-29 15:27:01,830 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:27:01,831 - INFO - [cached since 0.01874s ago] {'id_1': 10}
2025-06-29 15:27:01,835 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:27:01,835 - INFO - [cached since 0.02273s ago] {'id_1': 2}
2025-06-29 15:27:01,838 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:27:01,838 - INFO - [cached since 0.02602s ago] {'id_1': 2}
2025-06-29 15:27:01,840 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:27:01,840 - INFO - [cached since 0.02844s ago] {'id_1': 14}
2025-06-29 15:27:01,842 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:27:01,844 - INFO - [cached since 0.03121s ago] {'id_1': 14}
2025-06-29 15:27:01,846 - INFO - ROLLBACK
2025-06-29 15:31:03,494 - INFO - BEGIN (implicit)
2025-06-29 15:31:03,495 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:03,496 - INFO - [cached since 241.7s ago] {'id_1': 7}
2025-06-29 15:31:03,509 - INFO - ROLLBACK
2025-06-29 15:31:03,565 - INFO - BEGIN (implicit)
2025-06-29 15:31:03,565 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:03,566 - INFO - [cached since 241.8s ago] {'id_1': 7}
2025-06-29 15:31:03,569 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:03,573 - INFO - [cached since 241.8s ago] {'id_1': 7}
2025-06-29 15:31:03,597 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:03,598 - INFO - [cached since 241.8s ago] {'id_1': 7}
2025-06-29 15:31:03,613 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:03,614 - INFO - [cached since 241.8s ago] {'id_1': 9}
2025-06-29 15:31:03,627 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:03,628 - INFO - [cached since 241.8s ago] {'id_1': 10}
2025-06-29 15:31:03,700 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:03,700 - INFO - [cached since 241.9s ago] {'id_1': 10}
2025-06-29 15:31:03,703 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:03,703 - INFO - [cached since 241.9s ago] {'id_1': 2}
2025-06-29 15:31:03,708 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:03,708 - INFO - [cached since 241.9s ago] {'id_1': 2}
2025-06-29 15:31:03,711 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:03,711 - INFO - [cached since 241.9s ago] {'id_1': 14}
2025-06-29 15:31:03,713 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:03,713 - INFO - [cached since 241.9s ago] {'id_1': 14}
2025-06-29 15:31:03,717 - INFO - ROLLBACK
2025-06-29 15:31:05,694 - INFO - BEGIN (implicit)
2025-06-29 15:31:05,694 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:05,695 - INFO - [cached since 243.9s ago] {'id_1': 7}
2025-06-29 15:31:05,698 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:05,698 - INFO - [cached since 243.9s ago] {'id_1': 7}
2025-06-29 15:31:05,701 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:05,702 - INFO - [cached since 243.9s ago] {'id_1': 7}
2025-06-29 15:31:05,705 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:05,706 - INFO - [cached since 243.9s ago] {'id_1': 9}
2025-06-29 15:31:05,709 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:05,709 - INFO - [cached since 243.9s ago] {'id_1': 10}
2025-06-29 15:31:05,713 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:05,713 - INFO - [cached since 243.9s ago] {'id_1': 10}
2025-06-29 15:31:05,716 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:05,719 - INFO - [cached since 243.9s ago] {'id_1': 2}
2025-06-29 15:31:05,743 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:05,743 - INFO - [cached since 243.9s ago] {'id_1': 2}
2025-06-29 15:31:05,750 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:05,751 - INFO - [cached since 243.9s ago] {'id_1': 14}
2025-06-29 15:31:05,773 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:05,774 - INFO - [cached since 244s ago] {'id_1': 14}
2025-06-29 15:31:05,778 - INFO - ROLLBACK
2025-06-29 15:31:07,236 - ERROR - Exception in callback _ProactorBasePipeTransport._call_connection_lost(None)
handle: <Handle _ProactorBasePipeTransport._call_connection_lost(None)>
Traceback (most recent call last):
  File "D:\conda\lib\asyncio\events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
  File "D:\conda\lib\asyncio\proactor_events.py", line 162, in _call_connection_lost
    self._sock.shutdown(socket.SHUT_RDWR)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 15:31:13,013 - INFO - BEGIN (implicit)
2025-06-29 15:31:13,014 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:13,018 - INFO - [cached since 251.2s ago] {'id_1': 7}
2025-06-29 15:31:13,023 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:13,024 - INFO - [cached since 251.2s ago] {'id_1': 7}
2025-06-29 15:31:13,027 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:13,028 - INFO - [cached since 251.2s ago] {'id_1': 7}
2025-06-29 15:31:13,030 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:13,032 - INFO - [cached since 251.2s ago] {'id_1': 9}
2025-06-29 15:31:13,035 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:13,036 - INFO - [cached since 251.2s ago] {'id_1': 10}
2025-06-29 15:31:13,040 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:13,040 - INFO - [cached since 251.2s ago] {'id_1': 10}
2025-06-29 15:31:13,044 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:13,045 - INFO - [cached since 251.2s ago] {'id_1': 2}
2025-06-29 15:31:13,047 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:13,047 - INFO - [cached since 251.2s ago] {'id_1': 2}
2025-06-29 15:31:13,050 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:13,050 - INFO - [cached since 251.2s ago] {'id_1': 14}
2025-06-29 15:31:13,056 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:31:13,056 - INFO - [cached since 251.2s ago] {'id_1': 14}
2025-06-29 15:31:13,060 - INFO - ROLLBACK
2025-06-29 15:45:13,389 - INFO - SELECT DATABASE()
2025-06-29 15:45:13,390 - INFO - [raw sql] {}
2025-06-29 15:45:13,397 - INFO - SELECT @@sql_mode
2025-06-29 15:45:13,398 - INFO - [raw sql] {}
2025-06-29 15:45:13,399 - INFO - SELECT @@lower_case_table_names
2025-06-29 15:45:13,399 - INFO - [raw sql] {}
2025-06-29 15:45:13,401 - INFO - BEGIN (implicit)
2025-06-29 15:45:13,421 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:45:13,421 - INFO - [generated in 0.00068s] {'id_1': 7}
2025-06-29 15:45:13,424 - INFO - ROLLBACK
2025-06-29 15:45:53,089 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 15:45:53,091 - INFO - Closing down clientserver connection
2025-06-29 15:45:53,091 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 15:45:53,093 - INFO - Closing down clientserver connection
2025-06-29 15:46:08,797 - INFO - SELECT DATABASE()
2025-06-29 15:46:08,798 - INFO - [raw sql] {}
2025-06-29 15:46:08,799 - INFO - SELECT @@sql_mode
2025-06-29 15:46:08,800 - INFO - [raw sql] {}
2025-06-29 15:46:08,801 - INFO - SELECT @@lower_case_table_names
2025-06-29 15:46:08,802 - INFO - [raw sql] {}
2025-06-29 15:46:08,805 - INFO - BEGIN (implicit)
2025-06-29 15:46:08,819 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:46:08,819 - INFO - [generated in 0.00066s] {'id_1': 7}
2025-06-29 15:46:08,823 - INFO - ROLLBACK
2025-06-29 15:47:45,775 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 15:47:45,778 - INFO - Closing down clientserver connection
2025-06-29 15:47:45,778 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 15:47:45,779 - INFO - Closing down clientserver connection
2025-06-29 15:48:07,645 - INFO - SELECT DATABASE()
2025-06-29 15:48:07,646 - INFO - [raw sql] {}
2025-06-29 15:48:07,649 - INFO - SELECT @@sql_mode
2025-06-29 15:48:07,649 - INFO - [raw sql] {}
2025-06-29 15:48:07,650 - INFO - SELECT @@lower_case_table_names
2025-06-29 15:48:07,650 - INFO - [raw sql] {}
2025-06-29 15:48:07,654 - INFO - BEGIN (implicit)
2025-06-29 15:48:07,673 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:48:07,673 - INFO - [generated in 0.00049s] {'id_1': 7}
2025-06-29 15:48:07,695 - INFO - ROLLBACK
2025-06-29 15:48:42,338 - INFO - BEGIN (implicit)
2025-06-29 15:48:42,339 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:48:42,339 - INFO - [cached since 34.67s ago] {'id_1': 7}
2025-06-29 15:48:42,341 - INFO - ROLLBACK
2025-06-29 15:50:31,404 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 15:50:31,409 - INFO - Closing down clientserver connection
2025-06-29 15:50:31,409 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 15:50:31,412 - INFO - Closing down clientserver connection
2025-06-29 15:51:02,331 - INFO - SELECT DATABASE()
2025-06-29 15:51:02,333 - INFO - [raw sql] {}
2025-06-29 15:51:02,348 - INFO - SELECT @@sql_mode
2025-06-29 15:51:02,349 - INFO - [raw sql] {}
2025-06-29 15:51:02,353 - INFO - SELECT @@lower_case_table_names
2025-06-29 15:51:02,353 - INFO - [raw sql] {}
2025-06-29 15:51:02,356 - INFO - BEGIN (implicit)
2025-06-29 15:51:02,370 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:51:02,370 - INFO - [generated in 0.00052s] {'id_1': 7}
2025-06-29 15:51:02,373 - INFO - ROLLBACK
2025-06-29 15:54:47,746 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 15:54:47,748 - INFO - Closing down clientserver connection
2025-06-29 15:54:47,749 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 15:54:47,753 - INFO - Closing down clientserver connection
2025-06-29 15:55:13,107 - INFO - SELECT DATABASE()
2025-06-29 15:55:13,108 - INFO - [raw sql] {}
2025-06-29 15:55:13,109 - INFO - SELECT @@sql_mode
2025-06-29 15:55:13,109 - INFO - [raw sql] {}
2025-06-29 15:55:13,110 - INFO - SELECT @@lower_case_table_names
2025-06-29 15:55:13,110 - INFO - [raw sql] {}
2025-06-29 15:55:13,112 - INFO - BEGIN (implicit)
2025-06-29 15:55:13,127 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:55:13,128 - INFO - [generated in 0.00071s] {'id_1': 7}
2025-06-29 15:55:13,137 - INFO - ROLLBACK
2025-06-29 15:58:39,303 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 15:58:39,306 - INFO - Closing down clientserver connection
2025-06-29 15:58:39,307 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 15:58:39,308 - INFO - Closing down clientserver connection
2025-06-29 15:59:00,337 - INFO - SELECT DATABASE()
2025-06-29 15:59:00,338 - INFO - [raw sql] {}
2025-06-29 15:59:00,340 - INFO - SELECT @@sql_mode
2025-06-29 15:59:00,340 - INFO - [raw sql] {}
2025-06-29 15:59:00,341 - INFO - SELECT @@lower_case_table_names
2025-06-29 15:59:00,342 - INFO - [raw sql] {}
2025-06-29 15:59:00,344 - INFO - BEGIN (implicit)
2025-06-29 15:59:00,374 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:00,375 - INFO - [generated in 0.00159s] {'id_1': 7}
2025-06-29 15:59:00,380 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:00,381 - INFO - [cached since 0.007449s ago] {'id_1': 6}
2025-06-29 15:59:00,385 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:00,386 - INFO - [cached since 0.01305s ago] {'id_1': 7}
2025-06-29 15:59:00,389 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:00,389 - INFO - [cached since 0.01591s ago] {'id_1': 6}
2025-06-29 15:59:00,391 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:00,391 - INFO - [cached since 0.01805s ago] {'id_1': 7}
2025-06-29 15:59:00,393 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:00,394 - INFO - [cached since 0.02052s ago] {'id_1': 7}
2025-06-29 15:59:00,396 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:00,396 - INFO - [cached since 0.02276s ago] {'id_1': 9}
2025-06-29 15:59:00,398 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:00,398 - INFO - [cached since 0.02481s ago] {'id_1': 9}
2025-06-29 15:59:00,401 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:00,401 - INFO - [cached since 0.02822s ago] {'id_1': 10}
2025-06-29 15:59:00,403 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:00,403 - INFO - [cached since 0.03034s ago] {'id_1': 10}
2025-06-29 15:59:00,405 - INFO - ROLLBACK
2025-06-29 15:59:04,719 - INFO - BEGIN (implicit)
2025-06-29 15:59:04,719 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:04,720 - INFO - [cached since 4.346s ago] {'id_1': 7}
2025-06-29 15:59:04,724 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:04,724 - INFO - [cached since 4.351s ago] {'id_1': 7}
2025-06-29 15:59:04,727 - INFO - ROLLBACK
2025-06-29 15:59:06,429 - INFO - BEGIN (implicit)
2025-06-29 15:59:06,430 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:06,430 - INFO - [cached since 6.056s ago] {'id_1': 7}
2025-06-29 15:59:06,436 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:06,437 - INFO - [cached since 6.063s ago] {'id_1': 6}
2025-06-29 15:59:06,439 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:06,439 - INFO - [cached since 6.067s ago] {'id_1': 7}
2025-06-29 15:59:06,441 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:06,442 - INFO - [cached since 6.069s ago] {'id_1': 6}
2025-06-29 15:59:06,444 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:06,444 - INFO - [cached since 6.071s ago] {'id_1': 7}
2025-06-29 15:59:06,447 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:06,447 - INFO - [cached since 6.074s ago] {'id_1': 7}
2025-06-29 15:59:06,452 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:06,452 - INFO - [cached since 6.079s ago] {'id_1': 9}
2025-06-29 15:59:06,454 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:06,454 - INFO - [cached since 6.082s ago] {'id_1': 9}
2025-06-29 15:59:06,457 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:06,457 - INFO - [cached since 6.084s ago] {'id_1': 10}
2025-06-29 15:59:06,459 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 15:59:06,459 - INFO - [cached since 6.085s ago] {'id_1': 10}
2025-06-29 15:59:06,460 - INFO - ROLLBACK
2025-06-29 16:01:52,120 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 16:01:52,123 - INFO - Closing down clientserver connection
2025-06-29 16:01:52,123 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 16:01:52,125 - INFO - Closing down clientserver connection
2025-06-29 16:03:07,343 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 16:03:07,345 - INFO - Closing down clientserver connection
2025-06-29 16:03:07,346 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 16:03:07,348 - INFO - Closing down clientserver connection
2025-06-29 16:03:26,377 - INFO - SELECT DATABASE()
2025-06-29 16:03:26,378 - INFO - [raw sql] {}
2025-06-29 16:03:26,381 - INFO - SELECT @@sql_mode
2025-06-29 16:03:26,382 - INFO - [raw sql] {}
2025-06-29 16:03:26,385 - INFO - SELECT @@lower_case_table_names
2025-06-29 16:03:26,385 - INFO - [raw sql] {}
2025-06-29 16:03:26,386 - INFO - BEGIN (implicit)
2025-06-29 16:03:26,399 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:26,399 - INFO - [generated in 0.00031s] {'id_1': 7}
2025-06-29 16:03:26,403 - INFO - ROLLBACK
2025-06-29 16:03:26,475 - INFO - BEGIN (implicit)
2025-06-29 16:03:26,477 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:26,477 - INFO - [cached since 0.07838s ago] {'id_1': 7}
2025-06-29 16:03:26,502 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:26,503 - INFO - [cached since 0.104s ago] {'id_1': 6}
2025-06-29 16:03:26,527 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:26,528 - INFO - [cached since 0.1291s ago] {'id_1': 7}
2025-06-29 16:03:26,532 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:26,533 - INFO - [cached since 0.1343s ago] {'id_1': 6}
2025-06-29 16:03:26,536 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:26,536 - INFO - [cached since 0.1376s ago] {'id_1': 7}
2025-06-29 16:03:26,542 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:26,544 - INFO - [cached since 0.1447s ago] {'id_1': 7}
2025-06-29 16:03:26,548 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:26,549 - INFO - [cached since 0.1497s ago] {'id_1': 9}
2025-06-29 16:03:26,552 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:26,552 - INFO - [cached since 0.1533s ago] {'id_1': 9}
2025-06-29 16:03:26,555 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:26,555 - INFO - [cached since 0.1564s ago] {'id_1': 10}
2025-06-29 16:03:26,558 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:26,559 - INFO - [cached since 0.1597s ago] {'id_1': 10}
2025-06-29 16:03:26,563 - INFO - ROLLBACK
2025-06-29 16:03:28,224 - INFO - BEGIN (implicit)
2025-06-29 16:03:28,225 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:28,225 - INFO - [cached since 1.826s ago] {'id_1': 7}
2025-06-29 16:03:28,227 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:28,227 - INFO - [cached since 1.829s ago] {'id_1': 6}
2025-06-29 16:03:28,231 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:28,231 - INFO - [cached since 1.833s ago] {'id_1': 7}
2025-06-29 16:03:28,240 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:28,240 - INFO - [cached since 1.842s ago] {'id_1': 6}
2025-06-29 16:03:28,245 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:28,253 - INFO - [cached since 1.854s ago] {'id_1': 7}
2025-06-29 16:03:28,260 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:28,261 - INFO - [cached since 1.862s ago] {'id_1': 7}
2025-06-29 16:03:28,266 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:28,266 - INFO - [cached since 1.868s ago] {'id_1': 9}
2025-06-29 16:03:28,271 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:28,272 - INFO - [cached since 1.873s ago] {'id_1': 9}
2025-06-29 16:03:28,274 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:28,275 - INFO - [cached since 1.876s ago] {'id_1': 10}
2025-06-29 16:03:28,277 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:28,277 - INFO - [cached since 1.879s ago] {'id_1': 10}
2025-06-29 16:03:28,283 - INFO - ROLLBACK
2025-06-29 16:03:35,164 - INFO - BEGIN (implicit)
2025-06-29 16:03:35,165 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:35,166 - INFO - [cached since 8.767s ago] {'id_1': 7}
2025-06-29 16:03:35,168 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:35,168 - INFO - [cached since 8.77s ago] {'id_1': 6}
2025-06-29 16:03:35,171 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:35,171 - INFO - [cached since 8.773s ago] {'id_1': 7}
2025-06-29 16:03:35,174 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:35,174 - INFO - [cached since 8.775s ago] {'id_1': 6}
2025-06-29 16:03:35,177 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:35,178 - INFO - [cached since 8.779s ago] {'id_1': 7}
2025-06-29 16:03:35,181 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:35,181 - INFO - [cached since 8.783s ago] {'id_1': 7}
2025-06-29 16:03:35,184 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:35,184 - INFO - [cached since 8.786s ago] {'id_1': 9}
2025-06-29 16:03:35,187 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:35,187 - INFO - [cached since 8.789s ago] {'id_1': 9}
2025-06-29 16:03:35,190 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:35,190 - INFO - [cached since 8.792s ago] {'id_1': 10}
2025-06-29 16:03:35,205 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:03:35,206 - INFO - [cached since 8.806s ago] {'id_1': 10}
2025-06-29 16:03:35,218 - INFO - ROLLBACK
2025-06-29 16:04:19,898 - INFO - BEGIN (implicit)
2025-06-29 16:04:19,899 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:04:19,899 - INFO - [cached since 53.5s ago] {'id_1': 7}
2025-06-29 16:04:19,902 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:04:19,905 - INFO - [cached since 53.51s ago] {'id_1': 6}
2025-06-29 16:04:19,921 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:04:19,922 - INFO - [cached since 53.52s ago] {'id_1': 7}
2025-06-29 16:04:19,928 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:04:19,929 - INFO - [cached since 53.53s ago] {'id_1': 6}
2025-06-29 16:04:19,931 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:04:19,931 - INFO - [cached since 53.53s ago] {'id_1': 7}
2025-06-29 16:04:19,934 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:04:19,934 - INFO - [cached since 53.54s ago] {'id_1': 7}
2025-06-29 16:04:19,936 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:04:19,937 - INFO - [cached since 53.54s ago] {'id_1': 9}
2025-06-29 16:04:19,939 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:04:19,939 - INFO - [cached since 53.54s ago] {'id_1': 9}
2025-06-29 16:04:19,944 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:04:19,945 - INFO - [cached since 53.55s ago] {'id_1': 10}
2025-06-29 16:04:19,946 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:04:19,947 - INFO - [cached since 53.55s ago] {'id_1': 10}
2025-06-29 16:04:19,950 - INFO - ROLLBACK
2025-06-29 16:06:39,634 - INFO - BEGIN (implicit)
2025-06-29 16:06:39,636 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:06:39,638 - INFO - [cached since 193.2s ago] {'id_1': 7}
2025-06-29 16:06:39,647 - INFO - ROLLBACK
2025-06-29 16:06:39,699 - INFO - BEGIN (implicit)
2025-06-29 16:06:39,701 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:06:39,701 - INFO - [cached since 193.3s ago] {'id_1': 7}
2025-06-29 16:06:39,706 - INFO - ROLLBACK
2025-06-29 16:06:41,360 - INFO - BEGIN (implicit)
2025-06-29 16:06:41,361 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:06:41,362 - INFO - [cached since 195s ago] {'id_1': 7}
2025-06-29 16:06:41,364 - INFO - ROLLBACK
2025-06-29 16:06:44,884 - INFO - BEGIN (implicit)
2025-06-29 16:06:44,884 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:06:44,885 - INFO - [cached since 198.5s ago] {'id_1': 7}
2025-06-29 16:06:44,887 - INFO - ROLLBACK
2025-06-29 16:07:41,676 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 16:07:41,678 - INFO - Closing down clientserver connection
2025-06-29 16:07:41,679 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 16:07:41,681 - INFO - Closing down clientserver connection
2025-06-29 16:07:59,289 - INFO - SELECT DATABASE()
2025-06-29 16:07:59,290 - INFO - [raw sql] {}
2025-06-29 16:07:59,292 - INFO - SELECT @@sql_mode
2025-06-29 16:07:59,292 - INFO - [raw sql] {}
2025-06-29 16:07:59,294 - INFO - SELECT @@lower_case_table_names
2025-06-29 16:07:59,294 - INFO - [raw sql] {}
2025-06-29 16:07:59,297 - INFO - BEGIN (implicit)
2025-06-29 16:07:59,315 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:07:59,316 - INFO - [generated in 0.00151s] {'id_1': 7}
2025-06-29 16:07:59,341 - INFO - ROLLBACK
2025-06-29 16:08:12,121 - INFO - BEGIN (implicit)
2025-06-29 16:08:12,122 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:08:12,122 - INFO - [cached since 12.81s ago] {'id_1': 7}
2025-06-29 16:08:12,127 - INFO - ROLLBACK
2025-06-29 16:18:28,477 - INFO - BEGIN (implicit)
2025-06-29 16:18:28,478 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:18:28,479 - INFO - [cached since 629.2s ago] {'id_1': 7}
2025-06-29 16:18:28,483 - INFO - ROLLBACK
2025-06-29 16:20:58,303 - INFO - BEGIN (implicit)
2025-06-29 16:20:58,304 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:20:58,305 - INFO - [cached since 779s ago] {'id_1': 7}
2025-06-29 16:20:58,311 - INFO - ROLLBACK
2025-06-29 16:21:15,410 - INFO - BEGIN (implicit)
2025-06-29 16:21:15,411 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:21:15,412 - INFO - [cached since 796.1s ago] {'id_1': 7}
2025-06-29 16:21:15,415 - INFO - ROLLBACK
2025-06-29 16:22:02,677 - INFO - BEGIN (implicit)
2025-06-29 16:22:02,677 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:22:02,678 - INFO - [cached since 843.4s ago] {'id_1': 7}
2025-06-29 16:22:02,680 - INFO - ROLLBACK
2025-06-29 16:23:46,102 - INFO - BEGIN (implicit)
2025-06-29 16:23:46,105 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:23:46,106 - INFO - [cached since 946.8s ago] {'id_1': 7}
2025-06-29 16:23:46,110 - INFO - ROLLBACK
2025-06-29 16:26:14,984 - INFO - BEGIN (implicit)
2025-06-29 16:26:14,985 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:26:14,985 - INFO - [cached since 1096s ago] {'id_1': 7}
2025-06-29 16:26:14,990 - INFO - ROLLBACK
2025-06-29 16:27:14,394 - INFO - BEGIN (implicit)
2025-06-29 16:27:14,394 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:27:14,395 - INFO - [cached since 1155s ago] {'id_1': 7}
2025-06-29 16:27:14,398 - INFO - ROLLBACK
2025-06-29 16:27:28,139 - INFO - BEGIN (implicit)
2025-06-29 16:27:28,139 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:27:28,140 - INFO - [cached since 1169s ago] {'id_1': 7}
2025-06-29 16:27:28,143 - INFO - ROLLBACK
2025-06-29 16:28:44,214 - INFO - BEGIN (implicit)
2025-06-29 16:28:44,214 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:28:44,215 - INFO - [cached since 1245s ago] {'id_1': 7}
2025-06-29 16:28:44,219 - INFO - ROLLBACK
2025-06-29 16:32:36,635 - INFO - BEGIN (implicit)
2025-06-29 16:32:36,636 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:32:36,636 - INFO - [cached since 1477s ago] {'id_1': 7}
2025-06-29 16:32:36,640 - INFO - ROLLBACK
2025-06-29 16:33:44,236 - INFO - BEGIN (implicit)
2025-06-29 16:33:44,237 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:33:44,238 - INFO - [cached since 1545s ago] {'id_1': 7}
2025-06-29 16:33:44,243 - INFO - ROLLBACK
2025-06-29 16:34:54,601 - INFO - BEGIN (implicit)
2025-06-29 16:34:54,601 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:34:54,602 - INFO - [cached since 1615s ago] {'id_1': 7}
2025-06-29 16:34:54,605 - INFO - ROLLBACK
2025-06-29 16:35:59,381 - INFO - BEGIN (implicit)
2025-06-29 16:35:59,382 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:35:59,383 - INFO - [cached since 1680s ago] {'id_1': 7}
2025-06-29 16:35:59,387 - INFO - ROLLBACK
2025-06-29 16:37:53,340 - INFO - BEGIN (implicit)
2025-06-29 16:37:53,341 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:37:53,342 - INFO - [cached since 1794s ago] {'id_1': 7}
2025-06-29 16:37:53,345 - INFO - ROLLBACK
2025-06-29 16:38:28,411 - INFO - BEGIN (implicit)
2025-06-29 16:38:28,412 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:38:28,412 - INFO - [cached since 1829s ago] {'id_1': 7}
2025-06-29 16:38:28,479 - INFO - ROLLBACK
2025-06-29 16:39:07,482 - INFO - BEGIN (implicit)
2025-06-29 16:39:07,483 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:39:07,483 - INFO - [cached since 1868s ago] {'id_1': 7}
2025-06-29 16:39:07,486 - INFO - ROLLBACK
2025-06-29 16:39:38,183 - INFO - BEGIN (implicit)
2025-06-29 16:39:38,184 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:39:38,186 - INFO - [cached since 1899s ago] {'id_1': 7}
2025-06-29 16:39:38,193 - INFO - ROLLBACK
2025-06-29 16:41:13,464 - INFO - BEGIN (implicit)
2025-06-29 16:41:13,466 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:41:13,466 - INFO - [cached since 1994s ago] {'id_1': 7}
2025-06-29 16:41:13,472 - INFO - ROLLBACK
2025-06-29 16:42:02,980 - INFO - BEGIN (implicit)
2025-06-29 16:42:02,981 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:42:02,981 - INFO - [cached since 2044s ago] {'id_1': 7}
2025-06-29 16:42:02,985 - INFO - ROLLBACK
2025-06-29 16:43:06,076 - INFO - BEGIN (implicit)
2025-06-29 16:43:06,077 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:43:06,077 - INFO - [cached since 2107s ago] {'id_1': 7}
2025-06-29 16:43:06,080 - INFO - ROLLBACK
2025-06-29 16:45:18,964 - INFO - BEGIN (implicit)
2025-06-29 16:45:18,965 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:45:18,965 - INFO - [cached since 2240s ago] {'id_1': 7}
2025-06-29 16:45:18,969 - INFO - ROLLBACK
2025-06-29 16:46:54,659 - INFO - BEGIN (implicit)
2025-06-29 16:46:54,660 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:46:54,660 - INFO - [cached since 2335s ago] {'id_1': 7}
2025-06-29 16:46:54,664 - INFO - ROLLBACK
2025-06-29 16:49:14,328 - INFO - BEGIN (implicit)
2025-06-29 16:49:14,329 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:49:14,329 - INFO - [cached since 2475s ago] {'id_1': 7}
2025-06-29 16:49:14,337 - INFO - ROLLBACK
2025-06-29 16:55:42,346 - INFO - BEGIN (implicit)
2025-06-29 16:55:42,348 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:55:42,348 - INFO - [cached since 2863s ago] {'id_1': 7}
2025-06-29 16:55:42,354 - INFO - ROLLBACK
2025-06-29 16:57:59,521 - INFO - BEGIN (implicit)
2025-06-29 16:57:59,522 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:57:59,522 - INFO - [cached since 3000s ago] {'id_1': 7}
2025-06-29 16:57:59,525 - INFO - ROLLBACK
2025-06-29 16:58:14,604 - INFO - BEGIN (implicit)
2025-06-29 16:58:14,605 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:58:14,605 - INFO - [cached since 3015s ago] {'id_1': 7}
2025-06-29 16:58:14,608 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:58:14,609 - INFO - [cached since 3015s ago] {'id_1': 7}
2025-06-29 16:58:14,612 - INFO - ROLLBACK
2025-06-29 16:58:16,950 - INFO - BEGIN (implicit)
2025-06-29 16:58:16,950 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:58:16,951 - INFO - [cached since 3018s ago] {'id_1': 7}
2025-06-29 16:58:16,954 - INFO - ROLLBACK
2025-06-29 16:58:19,603 - INFO - BEGIN (implicit)
2025-06-29 16:58:19,603 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:58:19,604 - INFO - [cached since 3020s ago] {'id_1': 7}
2025-06-29 16:58:19,607 - INFO - ROLLBACK
2025-06-29 16:58:20,776 - INFO - BEGIN (implicit)
2025-06-29 16:58:20,777 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:58:20,778 - INFO - [cached since 3021s ago] {'id_1': 7}
2025-06-29 16:58:20,783 - INFO - ROLLBACK
2025-06-29 16:58:22,199 - INFO - BEGIN (implicit)
2025-06-29 16:58:22,200 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:58:22,200 - INFO - [cached since 3023s ago] {'id_1': 7}
2025-06-29 16:58:22,204 - INFO - ROLLBACK
2025-06-29 16:58:35,225 - INFO - BEGIN (implicit)
2025-06-29 16:58:35,226 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:58:35,226 - INFO - [cached since 3036s ago] {'id_1': 7}
2025-06-29 16:58:35,231 - INFO - ROLLBACK
2025-06-29 16:59:10,133 - INFO - BEGIN (implicit)
2025-06-29 16:59:10,134 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 16:59:10,134 - INFO - [cached since 3071s ago] {'id_1': 7}
2025-06-29 16:59:10,139 - INFO - ROLLBACK
2025-06-29 17:02:07,531 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 17:02:07,533 - INFO - Closing down clientserver connection
2025-06-29 17:02:07,533 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 17:02:07,535 - INFO - Closing down clientserver connection
2025-06-29 17:02:24,853 - INFO - SELECT DATABASE()
2025-06-29 17:02:24,854 - INFO - [raw sql] {}
2025-06-29 17:02:24,871 - INFO - SELECT @@sql_mode
2025-06-29 17:02:24,872 - INFO - [raw sql] {}
2025-06-29 17:02:24,873 - INFO - SELECT @@lower_case_table_names
2025-06-29 17:02:24,873 - INFO - [raw sql] {}
2025-06-29 17:02:24,875 - INFO - BEGIN (implicit)
2025-06-29 17:02:24,888 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:02:24,889 - INFO - [generated in 0.00078s] {'id_1': 7}
2025-06-29 17:02:24,892 - INFO - ROLLBACK
2025-06-29 17:04:31,750 - INFO - BEGIN (implicit)
2025-06-29 17:04:31,751 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:04:31,751 - INFO - [cached since 126.9s ago] {'id_1': 7}
2025-06-29 17:04:31,756 - INFO - ROLLBACK
2025-06-29 17:04:31,791 - INFO - BEGIN (implicit)
2025-06-29 17:04:31,791 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:04:31,792 - INFO - [cached since 126.9s ago] {'id_1': 7}
2025-06-29 17:04:31,803 - INFO - ROLLBACK
2025-06-29 17:04:33,617 - INFO - BEGIN (implicit)
2025-06-29 17:04:33,618 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:04:33,618 - INFO - [cached since 128.7s ago] {'id_1': 7}
2025-06-29 17:04:33,622 - INFO - ROLLBACK
2025-06-29 17:04:38,690 - INFO - BEGIN (implicit)
2025-06-29 17:04:38,691 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:04:38,691 - INFO - [cached since 133.8s ago] {'id_1': 7}
2025-06-29 17:04:38,694 - INFO - ROLLBACK
2025-06-29 17:05:42,654 - INFO - BEGIN (implicit)
2025-06-29 17:05:42,655 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:05:42,658 - INFO - [cached since 197.8s ago] {'id_1': 7}
2025-06-29 17:05:42,666 - INFO - ROLLBACK
2025-06-29 17:05:52,941 - INFO - BEGIN (implicit)
2025-06-29 17:05:52,943 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:05:52,943 - INFO - [cached since 208.1s ago] {'id_1': 7}
2025-06-29 17:05:52,973 - INFO - ROLLBACK
2025-06-29 17:06:53,221 - INFO - BEGIN (implicit)
2025-06-29 17:06:53,221 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:06:53,221 - INFO - [cached since 268.3s ago] {'id_1': 6}
2025-06-29 17:06:53,225 - INFO - ROLLBACK
2025-06-29 17:06:53,293 - INFO - BEGIN (implicit)
2025-06-29 17:06:53,306 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:06:53,306 - INFO - [cached since 268.4s ago] {'id_1': 6}
2025-06-29 17:06:53,309 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:06:53,309 - INFO - [cached since 268.4s ago] {'id_1': 7}
2025-06-29 17:06:53,499 - INFO - ROLLBACK
2025-06-29 17:06:54,077 - INFO - BEGIN (implicit)
2025-06-29 17:06:54,078 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:06:54,078 - INFO - [cached since 269.2s ago] {'id_1': 6}
2025-06-29 17:06:54,081 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:06:54,082 - INFO - [cached since 269.2s ago] {'id_1': 7}
2025-06-29 17:06:54,085 - INFO - ROLLBACK
2025-06-29 17:06:56,614 - ERROR - Exception in callback _ProactorBasePipeTransport._call_connection_lost(None)
handle: <Handle _ProactorBasePipeTransport._call_connection_lost(None)>
Traceback (most recent call last):
  File "D:\conda\lib\asyncio\events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
  File "D:\conda\lib\asyncio\proactor_events.py", line 162, in _call_connection_lost
    self._sock.shutdown(socket.SHUT_RDWR)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 17:06:58,845 - INFO - BEGIN (implicit)
2025-06-29 17:06:58,846 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:06:58,846 - INFO - [cached since 274s ago] {'id_1': 6}
2025-06-29 17:06:58,849 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:06:58,850 - INFO - [cached since 274s ago] {'id_1': 7}
2025-06-29 17:06:58,868 - INFO - ROLLBACK
2025-06-29 17:07:00,553 - INFO - BEGIN (implicit)
2025-06-29 17:07:00,554 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:07:00,555 - INFO - [cached since 275.7s ago] {'id_1': 7}
2025-06-29 17:07:00,560 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:07:00,560 - INFO - [cached since 275.7s ago] {'id_1': 7}
2025-06-29 17:07:00,563 - INFO - ROLLBACK
2025-06-29 17:07:47,125 - INFO - BEGIN (implicit)
2025-06-29 17:07:47,125 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:07:47,125 - INFO - [cached since 322.2s ago] {'id_1': 6}
2025-06-29 17:07:47,133 - INFO - ROLLBACK
2025-06-29 17:07:49,861 - INFO - BEGIN (implicit)
2025-06-29 17:07:49,863 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:07:49,863 - INFO - [cached since 325s ago] {'id_1': 7}
2025-06-29 17:07:49,877 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:07:49,877 - INFO - [cached since 325s ago] {'id_1': 6}
2025-06-29 17:07:49,884 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:07:49,884 - INFO - [cached since 325s ago] {'id_1': 7}
2025-06-29 17:07:49,888 - INFO - ROLLBACK
2025-06-29 17:07:51,659 - INFO - BEGIN (implicit)
2025-06-29 17:07:51,661 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:07:51,661 - INFO - [cached since 326.8s ago] {'id_1': 6}
2025-06-29 17:07:51,663 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:07:51,664 - INFO - [cached since 326.8s ago] {'id_1': 7}
2025-06-29 17:07:51,678 - INFO - ROLLBACK
2025-06-29 17:07:53,524 - INFO - BEGIN (implicit)
2025-06-29 17:07:53,525 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:07:53,525 - INFO - [cached since 328.6s ago] {'id_1': 6}
2025-06-29 17:07:53,528 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:07:53,528 - INFO - [cached since 328.6s ago] {'id_1': 7}
2025-06-29 17:07:53,533 - INFO - ROLLBACK
2025-06-29 17:07:57,834 - INFO - BEGIN (implicit)
2025-06-29 17:07:57,835 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:07:57,835 - INFO - [cached since 332.9s ago] {'id_1': 7}
2025-06-29 17:07:57,842 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:07:57,842 - INFO - [cached since 333s ago] {'id_1': 6}
2025-06-29 17:07:57,846 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:07:57,846 - INFO - [cached since 333s ago] {'id_1': 7}
2025-06-29 17:07:57,848 - INFO - ROLLBACK
2025-06-29 17:08:03,961 - INFO - BEGIN (implicit)
2025-06-29 17:08:03,963 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:08:03,963 - INFO - [cached since 339.1s ago] {'id_1': 7}
2025-06-29 17:08:03,978 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:08:03,979 - INFO - [cached since 339.1s ago] {'id_1': 6}
2025-06-29 17:08:03,988 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:08:03,988 - INFO - [cached since 339.1s ago] {'id_1': 7}
2025-06-29 17:08:03,992 - INFO - ROLLBACK
2025-06-29 17:08:15,813 - INFO - BEGIN (implicit)
2025-06-29 17:08:15,814 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:08:15,814 - INFO - [cached since 350.9s ago] {'id_1': 6}
2025-06-29 17:08:15,817 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:08:15,817 - INFO - [cached since 350.9s ago] {'id_1': 7}
2025-06-29 17:08:15,822 - INFO - ROLLBACK
2025-06-29 17:08:20,473 - INFO - BEGIN (implicit)
2025-06-29 17:08:20,476 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:08:20,479 - INFO - [cached since 355.6s ago] {'id_1': 6}
2025-06-29 17:08:20,484 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:08:20,484 - INFO - [cached since 355.6s ago] {'id_1': 7}
2025-06-29 17:08:20,488 - INFO - ROLLBACK
2025-06-29 17:15:04,122 - INFO - BEGIN (implicit)
2025-06-29 17:15:04,122 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:15:04,123 - INFO - [cached since 759.2s ago] {'id_1': 6}
2025-06-29 17:15:04,129 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:15:04,129 - INFO - [cached since 759.2s ago] {'id_1': 6}
2025-06-29 17:15:04,131 - INFO - ROLLBACK
2025-06-29 17:15:12,257 - INFO - BEGIN (implicit)
2025-06-29 17:15:12,268 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:15:12,268 - INFO - [cached since 767.4s ago] {'id_1': 6}
2025-06-29 17:15:12,273 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:15:12,273 - INFO - [cached since 767.4s ago] {'id_1': 6}
2025-06-29 17:15:12,277 - INFO - ROLLBACK
2025-06-29 17:15:28,957 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 17:15:28,958 - INFO - Closing down clientserver connection
2025-06-29 17:15:28,958 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 17:15:28,960 - INFO - Closing down clientserver connection
2025-06-29 17:15:50,710 - INFO - SELECT DATABASE()
2025-06-29 17:15:50,712 - INFO - [raw sql] {}
2025-06-29 17:15:50,715 - INFO - SELECT @@sql_mode
2025-06-29 17:15:50,715 - INFO - [raw sql] {}
2025-06-29 17:15:50,716 - INFO - SELECT @@lower_case_table_names
2025-06-29 17:15:50,716 - INFO - [raw sql] {}
2025-06-29 17:15:50,718 - INFO - BEGIN (implicit)
2025-06-29 17:15:50,731 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:15:50,731 - INFO - [generated in 0.00105s] {'id_1': 6}
2025-06-29 17:15:50,740 - INFO - ROLLBACK
2025-06-29 17:17:34,432 - INFO - BEGIN (implicit)
2025-06-29 17:17:34,433 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:17:34,433 - INFO - [cached since 103.7s ago] {'id_1': 6}
2025-06-29 17:17:34,441 - INFO - ROLLBACK
2025-06-29 17:18:03,599 - INFO - BEGIN (implicit)
2025-06-29 17:18:03,600 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:18:03,600 - INFO - [cached since 132.9s ago] {'id_1': 7}
2025-06-29 17:18:03,615 - INFO - ROLLBACK
2025-06-29 17:18:06,365 - INFO - BEGIN (implicit)
2025-06-29 17:18:06,366 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:18:06,366 - INFO - [cached since 135.6s ago] {'id_1': 6}
2025-06-29 17:18:06,371 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:18:06,371 - INFO - [cached since 135.6s ago] {'id_1': 7}
2025-06-29 17:18:06,375 - INFO - ROLLBACK
2025-06-29 17:18:07,895 - INFO - BEGIN (implicit)
2025-06-29 17:18:07,896 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:18:07,898 - INFO - [cached since 137.2s ago] {'id_1': 6}
2025-06-29 17:18:07,900 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:18:07,900 - INFO - [cached since 137.2s ago] {'id_1': 7}
2025-06-29 17:18:07,903 - INFO - ROLLBACK
2025-06-29 17:18:09,522 - INFO - BEGIN (implicit)
2025-06-29 17:18:09,523 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:18:09,523 - INFO - [cached since 138.8s ago] {'id_1': 6}
2025-06-29 17:18:09,528 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:18:09,528 - INFO - [cached since 138.8s ago] {'id_1': 7}
2025-06-29 17:18:09,533 - INFO - ROLLBACK
2025-06-29 17:18:16,377 - INFO - BEGIN (implicit)
2025-06-29 17:18:16,378 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:18:16,378 - INFO - [cached since 145.6s ago] {'id_1': 6}
2025-06-29 17:18:16,386 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:18:16,387 - INFO - [cached since 145.7s ago] {'id_1': 7}
2025-06-29 17:18:16,394 - INFO - ROLLBACK
2025-06-29 17:21:32,504 - INFO - BEGIN (implicit)
2025-06-29 17:21:32,506 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:21:32,506 - INFO - [cached since 341.8s ago] {'id_1': 6}
2025-06-29 17:21:32,510 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:21:32,510 - INFO - [cached since 341.8s ago] {'id_1': 7}
2025-06-29 17:21:32,515 - INFO - ROLLBACK
2025-06-29 17:22:32,701 - INFO - BEGIN (implicit)
2025-06-29 17:22:32,702 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:22:32,702 - INFO - [cached since 402s ago] {'id_1': 7}
2025-06-29 17:22:32,707 - INFO - ROLLBACK
2025-06-29 17:22:32,742 - INFO - BEGIN (implicit)
2025-06-29 17:22:32,743 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:22:32,743 - INFO - [cached since 402s ago] {'id_1': 7}
2025-06-29 17:22:32,761 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:22:32,762 - INFO - [cached since 402s ago] {'id_1': 6}
2025-06-29 17:22:32,763 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:22:32,763 - INFO - [cached since 402s ago] {'id_1': 7}
2025-06-29 17:22:32,766 - INFO - ROLLBACK
2025-06-29 17:22:33,002 - ERROR - Exception in callback _ProactorBasePipeTransport._call_connection_lost(None)
handle: <Handle _ProactorBasePipeTransport._call_connection_lost(None)>
Traceback (most recent call last):
  File "D:\conda\lib\asyncio\events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
  File "D:\conda\lib\asyncio\proactor_events.py", line 162, in _call_connection_lost
    self._sock.shutdown(socket.SHUT_RDWR)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 17:22:33,811 - INFO - BEGIN (implicit)
2025-06-29 17:22:33,812 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:22:33,812 - INFO - [cached since 403.1s ago] {'id_1': 7}
2025-06-29 17:22:33,815 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:22:33,815 - INFO - [cached since 403.1s ago] {'id_1': 6}
2025-06-29 17:22:33,818 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:22:33,818 - INFO - [cached since 403.1s ago] {'id_1': 7}
2025-06-29 17:22:33,819 - INFO - ROLLBACK
2025-06-29 17:22:49,544 - INFO - BEGIN (implicit)
2025-06-29 17:22:49,545 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:22:49,546 - INFO - [cached since 418.8s ago] {'id_1': 7}
2025-06-29 17:22:49,550 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:22:49,550 - INFO - [cached since 418.8s ago] {'id_1': 7}
2025-06-29 17:22:49,552 - INFO - ROLLBACK
2025-06-29 17:22:53,492 - INFO - BEGIN (implicit)
2025-06-29 17:22:53,493 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:22:53,493 - INFO - [cached since 422.8s ago] {'id_1': 6}
2025-06-29 17:22:53,495 - INFO - ROLLBACK
2025-06-29 17:22:56,797 - INFO - BEGIN (implicit)
2025-06-29 17:22:56,798 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:22:56,798 - INFO - [cached since 426.1s ago] {'id_1': 7}
2025-06-29 17:22:56,941 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:22:56,941 - INFO - [cached since 426.2s ago] {'id_1': 7}
2025-06-29 17:22:56,943 - INFO - ROLLBACK
2025-06-29 17:22:57,678 - INFO - BEGIN (implicit)
2025-06-29 17:22:57,679 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:22:57,679 - INFO - [cached since 426.9s ago] {'id_1': 7}
2025-06-29 17:22:57,682 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:22:57,682 - INFO - [cached since 427s ago] {'id_1': 7}
2025-06-29 17:22:57,684 - INFO - ROLLBACK
2025-06-29 17:23:00,584 - INFO - BEGIN (implicit)
2025-06-29 17:23:00,584 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:23:00,585 - INFO - [cached since 429.9s ago] {'id_1': 7}
2025-06-29 17:23:00,591 - INFO - ROLLBACK
2025-06-29 17:23:02,197 - INFO - BEGIN (implicit)
2025-06-29 17:23:02,200 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:23:02,204 - INFO - [cached since 431.5s ago] {'id_1': 7}
2025-06-29 17:23:02,209 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:23:02,210 - INFO - [cached since 431.5s ago] {'id_1': 7}
2025-06-29 17:23:02,214 - INFO - ROLLBACK
2025-06-29 17:23:03,299 - INFO - BEGIN (implicit)
2025-06-29 17:23:03,300 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:23:03,300 - INFO - [cached since 432.6s ago] {'id_1': 7}
2025-06-29 17:23:03,304 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:23:03,309 - INFO - [cached since 432.6s ago] {'id_1': 7}
2025-06-29 17:23:03,313 - INFO - ROLLBACK
2025-06-29 17:23:04,199 - INFO - BEGIN (implicit)
2025-06-29 17:23:04,199 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:23:04,199 - INFO - [cached since 433.5s ago] {'id_1': 7}
2025-06-29 17:23:04,201 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:23:04,201 - INFO - [cached since 433.5s ago] {'id_1': 7}
2025-06-29 17:23:04,206 - INFO - ROLLBACK
2025-06-29 17:23:07,492 - INFO - BEGIN (implicit)
2025-06-29 17:23:07,493 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:23:07,493 - INFO - [cached since 436.8s ago] {'id_1': 6}
2025-06-29 17:23:07,498 - INFO - ROLLBACK
2025-06-29 17:23:11,043 - INFO - BEGIN (implicit)
2025-06-29 17:23:11,045 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:23:11,045 - INFO - [cached since 440.3s ago] {'id_1': 7}
2025-06-29 17:23:11,053 - INFO - ROLLBACK
2025-06-29 17:23:12,698 - INFO - BEGIN (implicit)
2025-06-29 17:23:12,701 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:23:12,702 - INFO - [cached since 442s ago] {'id_1': 7}
2025-06-29 17:23:12,707 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:23:12,708 - INFO - [cached since 442s ago] {'id_1': 7}
2025-06-29 17:23:12,711 - INFO - ROLLBACK
2025-06-29 17:23:14,093 - INFO - BEGIN (implicit)
2025-06-29 17:23:14,094 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:23:14,094 - INFO - [cached since 443.4s ago] {'id_1': 7}
2025-06-29 17:23:14,109 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:23:14,110 - INFO - [cached since 443.4s ago] {'id_1': 7}
2025-06-29 17:23:14,113 - INFO - ROLLBACK
2025-06-29 17:24:06,458 - INFO - BEGIN (implicit)
2025-06-29 17:24:06,459 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:24:06,460 - INFO - [cached since 495.7s ago] {'id_1': 7}
2025-06-29 17:24:06,464 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:24:06,464 - INFO - [cached since 495.7s ago] {'id_1': 7}
2025-06-29 17:24:06,467 - INFO - ROLLBACK
2025-06-29 17:30:51,402 - INFO - BEGIN (implicit)
2025-06-29 17:30:51,403 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:30:51,403 - INFO - [cached since 900.7s ago] {'id_1': 7}
2025-06-29 17:30:51,407 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:30:51,408 - INFO - [cached since 900.7s ago] {'id_1': 7}
2025-06-29 17:30:51,418 - INFO - ROLLBACK
2025-06-29 17:32:22,188 - INFO - BEGIN (implicit)
2025-06-29 17:32:22,189 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:32:22,189 - INFO - [cached since 991.5s ago] {'id_1': 7}
2025-06-29 17:32:22,194 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:32:22,194 - INFO - [cached since 991.5s ago] {'id_1': 7}
2025-06-29 17:32:22,199 - INFO - ROLLBACK
2025-06-29 17:34:20,976 - INFO - BEGIN (implicit)
2025-06-29 17:34:20,977 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:34:20,978 - INFO - [cached since 1110s ago] {'id_1': 7}
2025-06-29 17:34:20,987 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:34:20,987 - INFO - [cached since 1110s ago] {'id_1': 7}
2025-06-29 17:34:20,990 - INFO - ROLLBACK
2025-06-29 17:34:24,653 - INFO - BEGIN (implicit)
2025-06-29 17:34:24,655 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:34:24,655 - INFO - [cached since 1114s ago] {'id_1': 6}
2025-06-29 17:34:24,658 - INFO - ROLLBACK
2025-06-29 17:34:31,050 - INFO - BEGIN (implicit)
2025-06-29 17:34:31,053 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:34:31,053 - INFO - [cached since 1120s ago] {'id_1': 7}
2025-06-29 17:34:31,055 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:34:31,056 - INFO - [cached since 1120s ago] {'id_1': 7}
2025-06-29 17:34:31,057 - INFO - ROLLBACK
2025-06-29 17:34:34,521 - INFO - BEGIN (implicit)
2025-06-29 17:34:34,523 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:34:34,523 - INFO - [cached since 1124s ago] {'id_1': 7}
2025-06-29 17:34:34,525 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:34:34,525 - INFO - [cached since 1124s ago] {'id_1': 6}
2025-06-29 17:34:34,528 - INFO - ROLLBACK
2025-06-29 17:35:03,936 - INFO - BEGIN (implicit)
2025-06-29 17:35:03,937 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:35:03,937 - INFO - [cached since 1153s ago] {'id_1': 7}
2025-06-29 17:35:03,939 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:35:03,939 - INFO - [cached since 1153s ago] {'id_1': 7}
2025-06-29 17:35:03,942 - INFO - ROLLBACK
2025-06-29 17:35:03,973 - ERROR - Exception in callback _ProactorBasePipeTransport._call_connection_lost(None)
handle: <Handle _ProactorBasePipeTransport._call_connection_lost(None)>
Traceback (most recent call last):
  File "D:\conda\lib\asyncio\events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
  File "D:\conda\lib\asyncio\proactor_events.py", line 162, in _call_connection_lost
    self._sock.shutdown(socket.SHUT_RDWR)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 17:35:05,121 - INFO - BEGIN (implicit)
2025-06-29 17:35:05,122 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:35:05,122 - INFO - [cached since 1154s ago] {'id_1': 7}
2025-06-29 17:35:05,125 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:35:05,126 - INFO - [cached since 1154s ago] {'id_1': 7}
2025-06-29 17:35:05,130 - INFO - ROLLBACK
2025-06-29 17:35:08,121 - INFO - BEGIN (implicit)
2025-06-29 17:35:08,122 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:35:08,122 - INFO - [cached since 1157s ago] {'id_1': 7}
2025-06-29 17:35:08,127 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:35:08,128 - INFO - [cached since 1157s ago] {'id_1': 6}
2025-06-29 17:35:08,131 - INFO - ROLLBACK
2025-06-29 17:36:25,471 - INFO - BEGIN (implicit)
2025-06-29 17:36:25,473 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:36:25,473 - INFO - [cached since 1235s ago] {'id_1': 7}
2025-06-29 17:36:25,475 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:36:25,475 - INFO - [cached since 1235s ago] {'id_1': 7}
2025-06-29 17:36:25,477 - INFO - ROLLBACK
2025-06-29 17:37:16,175 - INFO - BEGIN (implicit)
2025-06-29 17:37:16,176 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:37:16,177 - INFO - [cached since 1285s ago] {'id_1': 7}
2025-06-29 17:37:16,181 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:37:16,182 - INFO - [cached since 1285s ago] {'id_1': 7}
2025-06-29 17:37:16,183 - INFO - ROLLBACK
2025-06-29 17:39:14,524 - INFO - BEGIN (implicit)
2025-06-29 17:39:14,525 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:39:14,525 - INFO - [cached since 1404s ago] {'id_1': 7}
2025-06-29 17:39:14,529 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:39:14,529 - INFO - [cached since 1404s ago] {'id_1': 6}
2025-06-29 17:39:14,535 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:39:14,535 - INFO - [cached since 1404s ago] {'id_1': 7}
2025-06-29 17:39:14,538 - INFO - ROLLBACK
2025-06-29 17:39:38,999 - INFO - BEGIN (implicit)
2025-06-29 17:39:39,000 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:39:39,000 - INFO - [cached since 1428s ago] {'id_1': 7}
2025-06-29 17:39:39,004 - INFO - ROLLBACK
2025-06-29 17:39:39,033 - INFO - BEGIN (implicit)
2025-06-29 17:39:39,034 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:39:39,035 - INFO - [cached since 1428s ago] {'id_1': 7}
2025-06-29 17:39:39,040 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:39:39,042 - INFO - [cached since 1428s ago] {'id_1': 7}
2025-06-29 17:39:39,045 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:39:39,045 - INFO - [cached since 1428s ago] {'id_1': 6}
2025-06-29 17:39:39,048 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:39:39,048 - INFO - [cached since 1428s ago] {'id_1': 7}
2025-06-29 17:39:39,050 - INFO - ROLLBACK
2025-06-29 17:39:39,696 - INFO - BEGIN (implicit)
2025-06-29 17:39:39,696 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:39:39,697 - INFO - [cached since 1429s ago] {'id_1': 7}
2025-06-29 17:39:39,699 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:39:39,699 - INFO - [cached since 1429s ago] {'id_1': 7}
2025-06-29 17:39:39,709 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:39:39,709 - INFO - [cached since 1429s ago] {'id_1': 6}
2025-06-29 17:39:39,711 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:39:39,711 - INFO - [cached since 1429s ago] {'id_1': 7}
2025-06-29 17:39:39,713 - INFO - ROLLBACK
2025-06-29 17:39:42,230 - INFO - BEGIN (implicit)
2025-06-29 17:39:42,231 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:39:42,231 - INFO - [cached since 1432s ago] {'id_1': 7}
2025-06-29 17:39:42,234 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:39:42,235 - INFO - [cached since 1432s ago] {'id_1': 7}
2025-06-29 17:39:42,240 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:39:42,240 - INFO - [cached since 1432s ago] {'id_1': 6}
2025-06-29 17:39:42,243 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:39:42,243 - INFO - [cached since 1432s ago] {'id_1': 7}
2025-06-29 17:39:42,246 - INFO - ROLLBACK
2025-06-29 17:39:43,590 - INFO - BEGIN (implicit)
2025-06-29 17:39:43,591 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:39:43,592 - INFO - [cached since 1433s ago] {'id_1': 7}
2025-06-29 17:39:43,598 - INFO - ROLLBACK
2025-06-29 17:41:48,044 - INFO - SELECT DATABASE()
2025-06-29 17:41:48,045 - INFO - [raw sql] {}
2025-06-29 17:41:48,047 - INFO - SELECT @@sql_mode
2025-06-29 17:41:48,047 - INFO - [raw sql] {}
2025-06-29 17:41:48,048 - INFO - SELECT @@lower_case_table_names
2025-06-29 17:41:48,049 - INFO - [raw sql] {}
2025-06-29 17:41:48,051 - INFO - BEGIN (implicit)
2025-06-29 17:41:48,060 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:41:48,061 - INFO - [generated in 0.00048s] {'id_1': 7}
2025-06-29 17:41:48,063 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:41:48,064 - INFO - [cached since 0.003273s ago] {'id_1': 6}
2025-06-29 17:41:48,066 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:41:48,066 - INFO - [cached since 0.005711s ago] {'id_1': 7}
2025-06-29 17:41:48,069 - INFO - ROLLBACK
2025-06-29 17:42:04,890 - INFO - BEGIN (implicit)
2025-06-29 17:42:04,891 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:42:04,892 - INFO - [cached since 16.83s ago] {'id_1': 7}
2025-06-29 17:42:04,898 - INFO - ROLLBACK
2025-06-29 17:42:04,929 - INFO - BEGIN (implicit)
2025-06-29 17:42:04,930 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:42:04,930 - INFO - [cached since 16.87s ago] {'id_1': 7}
2025-06-29 17:42:04,933 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:42:04,933 - INFO - [cached since 16.87s ago] {'id_1': 7}
2025-06-29 17:42:04,939 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:42:04,940 - INFO - [cached since 16.88s ago] {'id_1': 6}
2025-06-29 17:42:04,942 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:42:04,942 - INFO - [cached since 16.88s ago] {'id_1': 7}
2025-06-29 17:42:04,945 - INFO - ROLLBACK
2025-06-29 17:42:05,672 - INFO - BEGIN (implicit)
2025-06-29 17:42:05,673 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:42:05,673 - INFO - [cached since 17.61s ago] {'id_1': 7}
2025-06-29 17:42:05,675 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:42:05,675 - INFO - [cached since 17.62s ago] {'id_1': 7}
2025-06-29 17:42:05,679 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:42:05,679 - INFO - [cached since 17.62s ago] {'id_1': 6}
2025-06-29 17:42:05,682 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:42:05,682 - INFO - [cached since 17.62s ago] {'id_1': 7}
2025-06-29 17:42:05,685 - INFO - ROLLBACK
2025-06-29 17:42:08,821 - INFO - BEGIN (implicit)
2025-06-29 17:42:08,823 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:42:08,824 - INFO - [cached since 20.76s ago] {'id_1': 7}
2025-06-29 17:42:08,826 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:42:08,826 - INFO - [cached since 20.77s ago] {'id_1': 7}
2025-06-29 17:42:08,829 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:42:08,829 - INFO - [cached since 20.77s ago] {'id_1': 7}
2025-06-29 17:42:08,831 - INFO - ROLLBACK
2025-06-29 17:42:10,748 - INFO - BEGIN (implicit)
2025-06-29 17:42:10,749 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:42:10,749 - INFO - [cached since 22.69s ago] {'id_1': 7}
2025-06-29 17:42:10,751 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:42:10,753 - INFO - [cached since 22.69s ago] {'id_1': 6}
2025-06-29 17:42:10,757 - INFO - ROLLBACK
2025-06-29 17:47:38,615 - INFO - BEGIN (implicit)
2025-06-29 17:47:38,616 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:47:38,617 - INFO - [cached since 350.6s ago] {'id_1': 7}
2025-06-29 17:47:38,620 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:47:38,620 - INFO - [cached since 350.6s ago] {'id_1': 7}
2025-06-29 17:47:38,621 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:47:38,621 - INFO - [cached since 350.6s ago] {'id_1': 7}
2025-06-29 17:47:38,623 - INFO - ROLLBACK
2025-06-29 17:47:42,572 - INFO - BEGIN (implicit)
2025-06-29 17:47:42,573 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:47:42,573 - INFO - [cached since 354.5s ago] {'id_1': 7}
2025-06-29 17:47:42,575 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:47:42,575 - INFO - [cached since 354.5s ago] {'id_1': 6}
2025-06-29 17:47:42,578 - INFO - ROLLBACK
2025-06-29 17:50:05,579 - INFO - BEGIN (implicit)
2025-06-29 17:50:05,579 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:50:05,580 - INFO - [cached since 497.5s ago] {'id_1': 7}
2025-06-29 17:50:05,584 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:50:05,585 - INFO - [cached since 497.5s ago] {'id_1': 7}
2025-06-29 17:50:05,587 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:50:05,588 - INFO - [cached since 497.5s ago] {'id_1': 7}
2025-06-29 17:50:05,591 - INFO - ROLLBACK
2025-06-29 17:50:09,081 - INFO - BEGIN (implicit)
2025-06-29 17:50:09,082 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:50:09,082 - INFO - [cached since 501s ago] {'id_1': 7}
2025-06-29 17:50:09,084 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:50:09,084 - INFO - [cached since 501s ago] {'id_1': 6}
2025-06-29 17:50:09,086 - INFO - ROLLBACK
2025-06-29 17:50:14,391 - INFO - BEGIN (implicit)
2025-06-29 17:50:14,393 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:50:14,393 - INFO - [cached since 506.3s ago] {'id_1': 7}
2025-06-29 17:50:14,397 - INFO - ROLLBACK
2025-06-29 17:50:17,761 - INFO - BEGIN (implicit)
2025-06-29 17:50:17,762 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:50:17,762 - INFO - [cached since 509.7s ago] {'id_1': 7}
2025-06-29 17:50:17,764 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:50:17,764 - INFO - [cached since 509.7s ago] {'id_1': 7}
2025-06-29 17:50:17,766 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:50:17,767 - INFO - [cached since 509.7s ago] {'id_1': 7}
2025-06-29 17:50:17,769 - INFO - ROLLBACK
2025-06-29 17:57:54,944 - INFO - BEGIN (implicit)
2025-06-29 17:57:54,948 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:57:54,950 - INFO - [cached since 966.9s ago] {'id_1': 7}
2025-06-29 17:57:54,954 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:57:54,954 - INFO - [cached since 966.9s ago] {'id_1': 7}
2025-06-29 17:57:54,955 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:57:54,956 - INFO - [cached since 966.9s ago] {'id_1': 7}
2025-06-29 17:57:54,957 - INFO - ROLLBACK
2025-06-29 17:59:00,127 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 17:59:00,129 - INFO - Closing down clientserver connection
2025-06-29 17:59:00,129 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 17:59:00,131 - INFO - Closing down clientserver connection
2025-06-29 17:59:19,347 - INFO - SELECT DATABASE()
2025-06-29 17:59:19,348 - INFO - [raw sql] {}
2025-06-29 17:59:19,353 - INFO - SELECT @@sql_mode
2025-06-29 17:59:19,353 - INFO - [raw sql] {}
2025-06-29 17:59:19,362 - INFO - SELECT @@lower_case_table_names
2025-06-29 17:59:19,363 - INFO - [raw sql] {}
2025-06-29 17:59:19,373 - INFO - BEGIN (implicit)
2025-06-29 17:59:19,410 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:59:19,411 - INFO - [generated in 0.00086s] {'id_1': 7}
2025-06-29 17:59:19,416 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:59:19,417 - INFO - [cached since 0.006087s ago] {'id_1': 7}
2025-06-29 17:59:19,420 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 17:59:19,421 - INFO - [cached since 0.01025s ago] {'id_1': 7}
2025-06-29 17:59:19,423 - INFO - ROLLBACK
2025-06-29 18:02:15,820 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 18:02:15,824 - INFO - Closing down clientserver connection
2025-06-29 18:02:15,824 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 18:02:15,827 - INFO - Closing down clientserver connection
2025-06-29 18:04:40,814 - INFO - SELECT DATABASE()
2025-06-29 18:04:40,815 - INFO - [raw sql] {}
2025-06-29 18:04:40,816 - INFO - SELECT @@sql_mode
2025-06-29 18:04:40,816 - INFO - [raw sql] {}
2025-06-29 18:04:40,817 - INFO - SELECT @@lower_case_table_names
2025-06-29 18:04:40,817 - INFO - [raw sql] {}
2025-06-29 18:04:40,818 - INFO - BEGIN (implicit)
2025-06-29 18:04:40,824 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:04:40,824 - INFO - [generated in 0.00032s] {'id_1': 7}
2025-06-29 18:04:40,830 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:04:40,830 - INFO - [cached since 0.006449s ago] {'id_1': 6}
2025-06-29 18:04:40,833 - INFO - ROLLBACK
2025-06-29 18:04:47,868 - INFO - BEGIN (implicit)
2025-06-29 18:04:47,868 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:04:47,869 - INFO - [cached since 7.045s ago] {'id_1': 7}
2025-06-29 18:04:47,873 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:04:47,873 - INFO - [cached since 7.05s ago] {'id_1': 7}
2025-06-29 18:04:47,878 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:04:47,879 - INFO - [cached since 7.055s ago] {'id_1': 7}
2025-06-29 18:04:47,883 - INFO - ROLLBACK
2025-06-29 18:04:49,060 - INFO - BEGIN (implicit)
2025-06-29 18:04:49,060 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:04:49,061 - INFO - [cached since 8.237s ago] {'id_1': 7}
2025-06-29 18:04:49,064 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:04:49,064 - INFO - [cached since 8.24s ago] {'id_1': 6}
2025-06-29 18:04:49,067 - INFO - ROLLBACK
2025-06-29 18:04:55,329 - INFO - BEGIN (implicit)
2025-06-29 18:04:55,330 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:04:55,330 - INFO - [cached since 14.51s ago] {'id_1': 7}
2025-06-29 18:04:55,334 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:04:55,334 - INFO - [cached since 14.51s ago] {'id_1': 7}
2025-06-29 18:04:55,356 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:04:55,357 - INFO - [cached since 14.53s ago] {'id_1': 7}
2025-06-29 18:04:55,362 - INFO - ROLLBACK
2025-06-29 18:04:58,734 - INFO - BEGIN (implicit)
2025-06-29 18:04:58,735 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:04:58,736 - INFO - [cached since 17.91s ago] {'id_1': 7}
2025-06-29 18:04:58,741 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:04:58,741 - INFO - [cached since 17.92s ago] {'id_1': 6}
2025-06-29 18:04:58,746 - INFO - ROLLBACK
2025-06-29 18:05:11,594 - INFO - BEGIN (implicit)
2025-06-29 18:05:11,595 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:05:11,595 - INFO - [cached since 30.77s ago] {'id_1': 7}
2025-06-29 18:05:11,603 - INFO - ROLLBACK
2025-06-29 18:05:39,950 - INFO - BEGIN (implicit)
2025-06-29 18:05:39,950 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:05:39,950 - INFO - [cached since 59.13s ago] {'id_1': 7}
2025-06-29 18:05:39,957 - INFO - ROLLBACK
2025-06-29 18:05:42,793 - INFO - BEGIN (implicit)
2025-06-29 18:05:42,796 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:05:42,797 - INFO - [cached since 61.97s ago] {'id_1': 7}
2025-06-29 18:05:42,805 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:05:42,805 - INFO - [cached since 61.98s ago] {'id_1': 7}
2025-06-29 18:05:42,812 - INFO - ROLLBACK
2025-06-29 18:08:18,077 - INFO - BEGIN (implicit)
2025-06-29 18:08:18,078 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:08:18,078 - INFO - [cached since 217.3s ago] {'id_1': 7}
2025-06-29 18:08:18,092 - INFO - ROLLBACK
2025-06-29 18:08:23,375 - INFO - BEGIN (implicit)
2025-06-29 18:08:23,377 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:08:23,379 - INFO - [cached since 222.6s ago] {'id_1': 7}
2025-06-29 18:08:23,389 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:08:23,389 - INFO - [cached since 222.6s ago] {'id_1': 7}
2025-06-29 18:08:23,394 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:08:23,395 - INFO - [cached since 222.6s ago] {'id_1': 7}
2025-06-29 18:08:23,406 - INFO - ROLLBACK
2025-06-29 18:08:26,086 - INFO - BEGIN (implicit)
2025-06-29 18:08:26,087 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:08:26,087 - INFO - [cached since 225.3s ago] {'id_1': 7}
2025-06-29 18:08:26,091 - INFO - ROLLBACK
2025-06-29 18:08:28,301 - INFO - BEGIN (implicit)
2025-06-29 18:08:28,302 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:08:28,302 - INFO - [cached since 227.5s ago] {'id_1': 7}
2025-06-29 18:08:28,304 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:08:28,304 - INFO - [cached since 227.5s ago] {'id_1': 7}
2025-06-29 18:08:28,309 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:08:28,309 - INFO - [cached since 227.5s ago] {'id_1': 6}
2025-06-29 18:08:28,325 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 18:08:28,325 - INFO - [cached since 227.5s ago] {'id_1': 7}
2025-06-29 18:08:28,327 - INFO - ROLLBACK
2025-06-29 19:21:56,277 - INFO - BEGIN (implicit)
2025-06-29 19:21:56,281 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.username LIKE %(username_1)s OR users.phone LIKE %(phone_1)s
2025-06-29 19:21:56,281 - INFO - [generated in 0.00060s] {'username_1': '%张%', 'phone_1': '%张%'}
2025-06-29 19:21:56,286 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.username LIKE %(username_1)s OR users.phone LIKE %(phone_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-06-29 19:21:56,287 - INFO - [generated in 0.00055s] {'username_1': '%张%', 'phone_1': '%张%', 'param_1': 0, 'param_2': 10}
2025-06-29 19:21:56,296 - INFO - ROLLBACK
2025-06-29 19:22:27,641 - INFO - BEGIN (implicit)
2025-06-29 19:22:27,642 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.username LIKE %(username_1)s OR users.phone LIKE %(phone_1)s
2025-06-29 19:22:27,643 - INFO - [cached since 31.36s ago] {'username_1': '%张%', 'phone_1': '%张%'}
2025-06-29 19:22:27,647 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.username LIKE %(username_1)s OR users.phone LIKE %(phone_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-06-29 19:22:27,647 - INFO - [cached since 31.36s ago] {'username_1': '%张%', 'phone_1': '%张%', 'param_1': 0, 'param_2': 10}
2025-06-29 19:22:27,652 - INFO - ROLLBACK
2025-06-29 19:23:48,815 - INFO - BEGIN (implicit)
2025-06-29 19:23:48,817 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users
2025-06-29 19:23:48,817 - INFO - [generated in 0.00047s] {}
2025-06-29 19:23:48,826 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
 LIMIT %(param_1)s, %(param_2)s
2025-06-29 19:23:48,826 - INFO - [generated in 0.00038s] {'param_1': 0, 'param_2': 10}
2025-06-29 19:23:48,831 - INFO - ROLLBACK
2025-06-29 19:23:55,298 - INFO - BEGIN (implicit)
2025-06-29 19:23:55,299 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.username LIKE %(username_1)s
2025-06-29 19:23:55,300 - INFO - [generated in 0.00044s] {'username_1': '%张%'}
2025-06-29 19:23:55,304 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.username LIKE %(username_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-06-29 19:23:55,304 - INFO - [generated in 0.00046s] {'username_1': '%张%', 'param_1': 0, 'param_2': 10}
2025-06-29 19:23:55,307 - INFO - ROLLBACK
2025-06-29 19:26:33,393 - INFO - BEGIN (implicit)
2025-06-29 19:26:33,394 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users
2025-06-29 19:26:33,394 - INFO - [cached since 164.6s ago] {}
2025-06-29 19:26:33,398 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
 LIMIT %(param_1)s, %(param_2)s
2025-06-29 19:26:33,399 - INFO - [cached since 164.6s ago] {'param_1': 0, 'param_2': 10}
2025-06-29 19:26:33,401 - INFO - ROLLBACK
2025-06-29 19:30:03,420 - INFO - BEGIN (implicit)
2025-06-29 19:30:03,421 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.username LIKE %(username_1)s OR users.phone LIKE %(phone_1)s
2025-06-29 19:30:03,421 - INFO - [cached since 487.1s ago] {'username_1': '%张%', 'phone_1': '%张%'}
2025-06-29 19:30:03,423 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.username LIKE %(username_1)s OR users.phone LIKE %(phone_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-06-29 19:30:03,424 - INFO - [cached since 487.1s ago] {'username_1': '%张%', 'phone_1': '%张%', 'param_1': 0, 'param_2': 10}
2025-06-29 19:30:03,438 - INFO - ROLLBACK
2025-06-29 19:30:06,708 - INFO - BEGIN (implicit)
2025-06-29 19:30:06,709 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users
2025-06-29 19:30:06,710 - INFO - [cached since 377.9s ago] {}
2025-06-29 19:30:06,717 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
 LIMIT %(param_1)s, %(param_2)s
2025-06-29 19:30:06,717 - INFO - [cached since 377.9s ago] {'param_1': 0, 'param_2': 10}
2025-06-29 19:30:06,722 - INFO - ROLLBACK
2025-06-29 19:32:10,116 - INFO - BEGIN (implicit)
2025-06-29 19:32:10,120 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users
2025-06-29 19:32:10,120 - INFO - [cached since 501.3s ago] {}
2025-06-29 19:32:10,139 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
 LIMIT %(param_1)s, %(param_2)s
2025-06-29 19:32:10,139 - INFO - [cached since 501.3s ago] {'param_1': 0, 'param_2': 10}
2025-06-29 19:32:10,149 - INFO - ROLLBACK
2025-06-29 19:32:25,854 - INFO - BEGIN (implicit)
2025-06-29 19:32:25,854 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.username LIKE %(username_1)s
2025-06-29 19:32:25,855 - INFO - [cached since 510.6s ago] {'username_1': '%三%'}
2025-06-29 19:32:25,857 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.username LIKE %(username_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-06-29 19:32:25,857 - INFO - [cached since 510.6s ago] {'username_1': '%三%', 'param_1': 0, 'param_2': 10}
2025-06-29 19:32:25,861 - INFO - ROLLBACK
2025-06-29 19:35:00,971 - INFO - BEGIN (implicit)
2025-06-29 19:35:00,972 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users
2025-06-29 19:35:00,972 - INFO - [cached since 672.2s ago] {}
2025-06-29 19:35:00,983 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
 LIMIT %(param_1)s, %(param_2)s
2025-06-29 19:35:00,983 - INFO - [cached since 672.2s ago] {'param_1': 0, 'param_2': 10}
2025-06-29 19:35:00,992 - INFO - ROLLBACK
2025-06-29 19:45:54,660 - INFO - BEGIN (implicit)
2025-06-29 19:45:54,661 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users
2025-06-29 19:45:54,661 - INFO - [cached since 1326s ago] {}
2025-06-29 19:45:54,671 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
 LIMIT %(param_1)s, %(param_2)s
2025-06-29 19:45:54,672 - INFO - [cached since 1326s ago] {'param_1': 0, 'param_2': 10}
2025-06-29 19:45:54,677 - INFO - ROLLBACK
2025-06-29 19:46:01,644 - INFO - BEGIN (implicit)
2025-06-29 19:46:01,645 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.username LIKE %(username_1)s OR users.phone LIKE %(phone_1)s
2025-06-29 19:46:01,646 - INFO - [cached since 1445s ago] {'username_1': '%三%', 'phone_1': '%三%'}
2025-06-29 19:46:01,649 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.username LIKE %(username_1)s OR users.phone LIKE %(phone_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-06-29 19:46:01,649 - INFO - [cached since 1445s ago] {'username_1': '%三%', 'phone_1': '%三%', 'param_1': 0, 'param_2': 10}
2025-06-29 19:46:01,652 - INFO - ROLLBACK
2025-06-29 19:46:05,360 - INFO - BEGIN (implicit)
2025-06-29 19:46:05,361 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.username LIKE %(username_1)s OR users.phone LIKE %(phone_1)s
2025-06-29 19:46:05,361 - INFO - [cached since 1449s ago] {'username_1': '%张%', 'phone_1': '%张%'}
2025-06-29 19:46:05,365 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.username LIKE %(username_1)s OR users.phone LIKE %(phone_1)s 
 LIMIT %(param_1)s, %(param_2)s
2025-06-29 19:46:05,366 - INFO - [cached since 1449s ago] {'username_1': '%张%', 'phone_1': '%张%', 'param_1': 0, 'param_2': 10}
2025-06-29 19:46:05,373 - INFO - ROLLBACK
2025-06-29 19:46:07,984 - INFO - BEGIN (implicit)
2025-06-29 19:46:07,988 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:46:07,988 - INFO - [cached since 6087s ago] {'id_1': 13}
2025-06-29 19:46:07,997 - INFO - ROLLBACK
2025-06-29 19:46:08,026 - INFO - 用户 7 连接到目标 13
2025-06-29 19:46:27,884 - INFO - 收到消息 from 7 to 13: {'id': 1751197587881, 'text': '黑呵呵呵', 'time': '2025-06-29T11:46:27.881Z', 'from': 7, 'to': 13, 'fromUsername': '赵敏', 'fromPhoto': '/avatar/ph_12345678921_f039.png'}
2025-06-29 19:46:27,885 - INFO - 目标用户 13 离线，消息将存储为离线消息
2025-06-29 19:46:27,892 - INFO - BEGIN (implicit)
2025-06-29 19:46:27,897 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:46:27,898 - INFO - [generated in 0.00102s] {'id_1': '13'}
2025-06-29 19:46:40,111 - ERROR - Exception in callback _ProactorBasePipeTransport._call_connection_lost(None)
handle: <Handle _ProactorBasePipeTransport._call_connection_lost(None)>
Traceback (most recent call last):
  File "D:\conda\lib\asyncio\events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
  File "D:\conda\lib\asyncio\proactor_events.py", line 162, in _call_connection_lost
    self._sock.shutdown(socket.SHUT_RDWR)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 19:46:55,050 - INFO - 发送验证码: phone=13676542345, code=823387
2025-06-29 19:46:56,335 - INFO - BEGIN (implicit)
2025-06-29 19:46:56,337 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.phone = %(phone_1)s
2025-06-29 19:46:56,337 - INFO - [generated in 0.00046s] {'phone_1': '13676542345'}
2025-06-29 19:46:56,340 - INFO - ROLLBACK
2025-06-29 19:46:58,619 - INFO - BEGIN (implicit)
2025-06-29 19:46:58,620 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:46:58,620 - INFO - [cached since 6138s ago] {'id_1': 7}
2025-06-29 19:46:58,623 - INFO - ROLLBACK
2025-06-29 19:46:58,643 - INFO - 用户 13 连接到目标 7
2025-06-29 19:47:02,645 - INFO - 用户 13 断开连接
2025-06-29 19:47:03,179 - INFO - BEGIN (implicit)
2025-06-29 19:47:03,180 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:47:03,180 - INFO - [cached since 6142s ago] {'id_1': 7}
2025-06-29 19:47:03,183 - INFO - ROLLBACK
2025-06-29 19:47:03,206 - INFO - 用户 13 连接到目标 7
2025-06-29 19:47:12,016 - INFO - 用户 13 断开连接
2025-06-29 19:47:12,357 - INFO - BEGIN (implicit)
2025-06-29 19:47:12,358 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:47:12,359 - INFO - [cached since 6152s ago] {'id_1': 7}
2025-06-29 19:47:12,363 - INFO - ROLLBACK
2025-06-29 19:47:12,443 - INFO - 用户 13 连接到目标 7
2025-06-29 19:47:21,802 - INFO - 用户 7 断开连接
2025-06-29 19:47:21,803 - INFO - ROLLBACK
2025-06-29 19:47:23,506 - INFO - BEGIN (implicit)
2025-06-29 19:47:23,507 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:47:23,508 - INFO - [cached since 6163s ago] {'id_1': 13}
2025-06-29 19:47:23,596 - INFO - ROLLBACK
2025-06-29 19:47:23,678 - INFO - 用户 7 连接到目标 13
2025-06-29 19:47:32,582 - INFO - 用户 13 断开连接
2025-06-29 19:47:32,837 - INFO - BEGIN (implicit)
2025-06-29 19:47:32,838 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:47:32,838 - INFO - [cached since 6172s ago] {'id_1': 7}
2025-06-29 19:47:32,840 - INFO - ROLLBACK
2025-06-29 19:47:32,913 - INFO - 用户 13 连接到目标 7
2025-06-29 19:47:34,696 - INFO - 用户 13 断开连接
2025-06-29 19:47:37,711 - INFO - 用户 13 连接到目标 7
2025-06-29 19:47:37,898 - INFO - BEGIN (implicit)
2025-06-29 19:47:37,899 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:47:37,899 - INFO - [cached since 6177s ago] {'id_1': 7}
2025-06-29 19:47:37,905 - INFO - ROLLBACK
2025-06-29 19:47:37,920 - INFO - 用户 13 连接到目标 7
2025-06-29 19:47:44,141 - INFO - 用户 13 断开连接
2025-06-29 19:47:44,169 - INFO - BEGIN (implicit)
2025-06-29 19:47:44,170 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:47:44,171 - INFO - [cached since 6183s ago] {'id_1': 13}
2025-06-29 19:47:44,174 - INFO - ROLLBACK
2025-06-29 19:47:47,176 - INFO - 用户 13 连接到目标 7
2025-06-29 19:47:48,378 - INFO - BEGIN (implicit)
2025-06-29 19:47:48,379 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:47:48,380 - INFO - [cached since 6188s ago] {'id_1': 7}
2025-06-29 19:47:48,384 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:47:48,384 - INFO - [cached since 6188s ago] {'id_1': 7}
2025-06-29 19:47:48,386 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:47:48,386 - INFO - [cached since 6188s ago] {'id_1': 6}
2025-06-29 19:47:48,395 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:47:48,395 - INFO - [cached since 6188s ago] {'id_1': 7}
2025-06-29 19:47:48,397 - INFO - ROLLBACK
2025-06-29 19:47:51,291 - INFO - BEGIN (implicit)
2025-06-29 19:47:51,292 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:47:51,292 - INFO - [cached since 6190s ago] {'id_1': 7}
2025-06-29 19:47:51,296 - INFO - ROLLBACK
2025-06-29 19:47:51,313 - INFO - 用户 13 连接到目标 7
2025-06-29 19:48:01,466 - INFO - 收到消息 from 13 to 7: {'id': 1751197681464, 'text': '666', 'time': '2025-06-29T11:48:01.464Z', 'from': 13, 'to': 7, 'fromUsername': '张翠山', 'fromPhoto': '/avatar/ph_13676542345_9aca.png'}
2025-06-29 19:48:01,468 - INFO - 加密消息： {'encrypt_data': 'OIFv7dNm5ZxbfEO7oK65kKUzRDuXdeUW7GP8C5JYSUJLRssd7ao9j5C3B7NfxRaW6xhFkJo+Z6LtH0Xs8WwO04ccth3bnZnBb73fYPPaWdw92PFxxwEOd7JgirGwG14Q4M6NxrbRxz3VMqvw75KV2fjcF0L0kPdFcDHWbMmC/obb6plXYfghsuJPujaqF59bNSPBnoxY32l/LaDOrEUd9CYcdWlJzBdRWAaSvlt4nfLa8W3Fxomx3PzVnvP4twU8HNkH4LUN30NFcrBy3zQG6yxEsN1fkGXbkz7Tq6atZUw=', 'publick_key': '114efb70-9ebd-43a8-bc46-ab522397d712'}
2025-06-29 19:48:01,477 - INFO - BEGIN (implicit)
2025-06-29 19:48:01,478 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:48:01,478 - INFO - [cached since 93.58s ago] {'id_1': '7'}
2025-06-29 19:48:09,307 - INFO - 用户 13 断开连接
2025-06-29 19:48:09,318 - INFO - 用户 13 断开连接
2025-06-29 19:48:09,324 - INFO - 用户 13 断开连接
2025-06-29 19:48:09,374 - INFO - ROLLBACK
2025-06-29 19:48:10,775 - INFO - BEGIN (implicit)
2025-06-29 19:48:10,776 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:48:10,776 - INFO - [cached since 6210s ago] {'id_1': 7}
2025-06-29 19:48:10,779 - INFO - ROLLBACK
2025-06-29 19:48:10,952 - INFO - 用户 13 连接到目标 7
2025-06-29 19:48:23,677 - INFO - 收到消息 from 7 to 13: {'id': 1751197703676, 'text': '撒旦发生', 'time': '2025-06-29T11:48:23.676Z', 'from': 7, 'to': 13, 'fromUsername': '赵敏', 'fromPhoto': '/avatar/ph_12345678921_f039.png'}
2025-06-29 19:48:23,678 - INFO - 加密消息： {'encrypt_data': 'PBT0vPftf9xl0dSbEapXDMNWaoT7p1/GR62GnahM9tYJTc9Nr5GAd1lNz4VDmeZBlla0dyl8GsbfH4a/LixsSTNmyQGJOQCnNDW44MlLBS0f77x8GAhpzCjxzpFLFNirwoz3KG5awYlO3jyGfBTuxSM4il9HBUDLTD8sjNZShynp/BnhPEXUn9R8oaDhXH95fyIW95d1xj3EQxCMtGXLVE9Pesc4opxJu+RuACb4xBEOMd7gIONO1kRdfq1HkeZ2lco7BxrTz+NiXm5haiEMLUQG+IbyGcgD/R7cOuiN5JuvETI2Abh3wMkBMyJwPpG9', 'publick_key': 'f7222c77-f5cc-4e20-ab7b-10665c0eed5b'}
2025-06-29 19:48:23,683 - INFO - BEGIN (implicit)
2025-06-29 19:48:23,684 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:48:23,686 - INFO - [cached since 115.8s ago] {'id_1': '13'}
2025-06-29 19:48:26,993 - INFO - 用户 7 断开连接
2025-06-29 19:48:27,004 - INFO - ROLLBACK
2025-06-29 19:48:27,577 - INFO - BEGIN (implicit)
2025-06-29 19:48:27,578 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:48:27,578 - INFO - [cached since 6227s ago] {'id_1': 13}
2025-06-29 19:48:27,587 - INFO - ROLLBACK
2025-06-29 19:48:27,609 - INFO - 用户 7 连接到目标 13
2025-06-29 19:48:40,296 - INFO - 收到消息 from 13 to 7: {'id': 1751197720294, 'text': '56565', 'time': '2025-06-29T11:48:40.294Z', 'from': 13, 'to': 7, 'fromUsername': '张翠山', 'fromPhoto': '/avatar/ph_13676542345_9aca.png'}
2025-06-29 19:48:40,298 - INFO - 加密消息： {'encrypt_data': 'nlXtF+HLQAkGT001OHbfk9HFRFoZkN1b61CbpkfE6tq7t0uPot3F+WnNA4qM80vWhA0HPaPZe7CxKNaxReVat4m87VlSo8Ig1nPLiHR6GZllBLF4ErKauM6WWxyDRcGsTstZFbSLAdCilCagMnFH/X9pEBDP+2wSZuFoRkBdH/2Yhz2TBID+DlnsgghvJmgSTFDOazMmKJyEfDnoJGIfl/xGZ9JAssAeS/UwBl6SCTsRDhvZ6APs2lMTbFcI4FC+XcYbnw0eOU3niFQILyCHqhK2bHyz+pyiFBFKeLap1FY=', 'publick_key': '059804ff-0738-41db-bdf3-468d4d6a3e40'}
2025-06-29 19:48:40,309 - INFO - BEGIN (implicit)
2025-06-29 19:48:40,309 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:48:40,310 - INFO - [cached since 132.4s ago] {'id_1': '7'}
2025-06-29 19:48:43,625 - INFO - 用户 13 断开连接
2025-06-29 19:48:43,626 - INFO - ROLLBACK
2025-06-29 19:48:45,318 - INFO - BEGIN (implicit)
2025-06-29 19:48:45,319 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:48:45,320 - INFO - [cached since 6244s ago] {'id_1': 7}
2025-06-29 19:48:45,324 - INFO - ROLLBACK
2025-06-29 19:48:45,401 - INFO - 用户 13 连接到目标 7
2025-06-29 19:49:52,614 - INFO - BEGIN (implicit)
2025-06-29 19:49:52,615 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:49:52,615 - INFO - [cached since 6312s ago] {'id_1': 6}
2025-06-29 19:49:52,616 - INFO - ROLLBACK
2025-06-29 19:49:52,624 - INFO - 用户 7 断开连接
2025-06-29 19:49:52,642 - INFO - 用户 7 连接到目标 6
2025-06-29 19:49:55,636 - INFO - 用户 7 断开连接
2025-06-29 19:49:55,642 - INFO - 用户 7 连接到目标 6
2025-06-29 19:49:56,896 - INFO - 用户 7 断开连接
2025-06-29 19:49:57,142 - INFO - BEGIN (implicit)
2025-06-29 19:49:57,143 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:49:57,144 - INFO - [cached since 6316s ago] {'id_1': 6}
2025-06-29 19:49:57,149 - INFO - ROLLBACK
2025-06-29 19:49:57,166 - INFO - 用户 7 连接到目标 6
2025-06-29 19:53:35,299 - INFO - 用户 7 断开连接
2025-06-29 19:53:35,938 - INFO - BEGIN (implicit)
2025-06-29 19:53:35,939 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:53:35,940 - INFO - [cached since 6535s ago] {'id_1': 6}
2025-06-29 19:53:35,946 - INFO - ROLLBACK
2025-06-29 19:53:35,956 - INFO - 用户 7 连接到目标 6
2025-06-29 19:54:15,424 - INFO - 收到消息 from 7 to 6: {'id': 1751198055421, 'text': '撒发生', 'time': '2025-06-29T11:54:15.421Z', 'from': 7, 'to': 6, 'fromUsername': '赵敏', 'fromPhoto': '/avatar/ph_12345678921_f039.png'}
2025-06-29 19:54:15,424 - INFO - 目标用户 6 离线，消息将存储为离线消息
2025-06-29 19:54:15,430 - INFO - BEGIN (implicit)
2025-06-29 19:54:15,431 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:54:15,431 - INFO - [cached since 467.5s ago] {'id_1': '6'}
2025-06-29 19:54:27,064 - INFO - 用户 13 断开连接
2025-06-29 19:54:28,094 - INFO - BEGIN (implicit)
2025-06-29 19:54:28,095 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:54:28,095 - INFO - [cached since 6587s ago] {'id_1': 7}
2025-06-29 19:54:28,098 - INFO - ROLLBACK
2025-06-29 19:54:28,141 - INFO - 用户 13 连接到目标 7
2025-06-29 19:54:32,782 - INFO - 用户 7 断开连接
2025-06-29 19:54:32,785 - INFO - ROLLBACK
2025-06-29 19:54:34,767 - INFO - BEGIN (implicit)
2025-06-29 19:54:34,768 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:54:34,768 - INFO - [cached since 6594s ago] {'id_1': 6}
2025-06-29 19:54:34,792 - INFO - ROLLBACK
2025-06-29 19:54:34,860 - INFO - 用户 7 连接到目标 6
2025-06-29 19:54:45,109 - INFO - 收到消息 from 13 to 7: {'id': 1751198085109, 'text': 'sdfsdf', 'time': '2025-06-29T11:54:45.109Z', 'from': 13, 'to': 7, 'fromUsername': '张翠山', 'fromPhoto': '/avatar/ph_13676542345_9aca.png'}
2025-06-29 19:54:45,110 - INFO - 目标用户 7 离线，消息将存储为离线消息
2025-06-29 19:54:45,115 - INFO - BEGIN (implicit)
2025-06-29 19:54:45,117 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:54:45,117 - INFO - [cached since 497.2s ago] {'id_1': '7'}
2025-06-29 19:54:52,376 - INFO - BEGIN (implicit)
2025-06-29 19:54:52,377 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:54:52,378 - INFO - [cached since 6612s ago] {'id_1': 13}
2025-06-29 19:54:52,383 - INFO - ROLLBACK
2025-06-29 19:54:52,396 - INFO - 用户 7 断开连接
2025-06-29 19:54:52,408 - INFO - 用户 7 连接到目标 13
2025-06-29 19:54:55,444 - INFO - 用户 7 断开连接
2025-06-29 19:54:55,448 - INFO - 用户 7 连接到目标 13
2025-06-29 19:54:58,456 - INFO - 用户 7 断开连接
2025-06-29 19:54:58,460 - INFO - 用户 7 连接到目标 13
2025-06-29 19:55:01,475 - INFO - 用户 7 断开连接
2025-06-29 19:55:01,481 - INFO - 用户 7 连接到目标 13
2025-06-29 19:55:04,498 - INFO - 用户 7 断开连接
2025-06-29 19:55:04,505 - INFO - 用户 7 连接到目标 13
2025-06-29 19:55:07,519 - INFO - 用户 7 断开连接
2025-06-29 19:55:07,524 - INFO - 用户 7 连接到目标 13
2025-06-29 19:55:10,533 - INFO - 用户 7 断开连接
2025-06-29 19:55:10,538 - INFO - 用户 7 连接到目标 13
2025-06-29 19:55:13,336 - INFO - 收到消息 from 7 to 13: {'id': 1751198113335, 'text': '撒旦飞洒', 'time': '2025-06-29T11:55:13.335Z', 'from': 7, 'to': 13, 'fromUsername': '赵敏', 'fromPhoto': '/avatar/ph_12345678921_f039.png'}
2025-06-29 19:55:13,337 - INFO - 加密消息： {'encrypt_data': 'P6HB0Dew7b+wdFB4r6mExXxt3qyGC77c7q8p1RIkauuA4MSuow1Z4cpshWIFPGL0oXtxHxprOJ+ONnwm3oc7joPdpJE+b5Lu17V9jnW43Jtm+Me7VlFupGNyWi97F8mAli4G8hsJdJ8PcJ46eVKUo8Vd0CGmq/TwB/4w5g8IAwBDjDFDc3su0JMsCPXJJvm9PtrOqSuSvEcMQqrPvywdunDpOyPtNjQLnt5FcSfVcpQzOYUbWvwsv/0QN+h46vXqAhrvlUIkDt/YPbxdyM0uv6jStVR+Ctagoz+VhBEpIUVQKfxe6lcdOUSVEPlBx0rc', 'publick_key': '49203079-f305-44fa-8abe-d8691ed4dc94'}
2025-06-29 19:55:13,344 - INFO - BEGIN (implicit)
2025-06-29 19:55:13,347 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:55:13,347 - INFO - [cached since 525.5s ago] {'id_1': '13'}
2025-06-29 19:55:13,555 - INFO - 用户 7 断开连接
2025-06-29 19:55:13,557 - INFO - ROLLBACK
2025-06-29 19:55:13,569 - INFO - 用户 7 连接到目标 13
2025-06-29 19:55:16,568 - INFO - 用户 7 断开连接
2025-06-29 19:55:16,572 - INFO - 用户 7 连接到目标 13
2025-06-29 19:55:20,323 - INFO - 用户 7 断开连接
2025-06-29 19:55:20,329 - INFO - 用户 7 连接到目标 13
2025-06-29 19:55:24,324 - INFO - 用户 7 断开连接
2025-06-29 19:55:24,327 - INFO - 用户 7 连接到目标 13
2025-06-29 19:55:28,329 - INFO - 用户 7 断开连接
2025-06-29 19:55:28,333 - INFO - 用户 7 连接到目标 13
2025-06-29 19:55:32,322 - INFO - 用户 7 断开连接
2025-06-29 19:55:32,325 - INFO - 用户 7 连接到目标 13
2025-06-29 19:55:36,328 - INFO - 用户 7 断开连接
2025-06-29 19:55:36,331 - INFO - 用户 7 连接到目标 13
2025-06-29 19:55:40,328 - INFO - 用户 7 断开连接
2025-06-29 19:55:40,332 - INFO - 用户 7 连接到目标 13
2025-06-29 19:55:44,320 - INFO - 用户 7 断开连接
2025-06-29 19:55:44,323 - INFO - 用户 7 连接到目标 13
2025-06-29 19:55:48,328 - INFO - 用户 7 断开连接
2025-06-29 19:55:48,332 - INFO - 用户 7 连接到目标 13
2025-06-29 19:55:49,927 - INFO - 用户 13 断开连接
2025-06-29 19:55:49,932 - INFO - ROLLBACK
2025-06-29 19:55:50,699 - INFO - BEGIN (implicit)
2025-06-29 19:55:50,700 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:55:50,700 - INFO - [cached since 6670s ago] {'id_1': 7}
2025-06-29 19:55:50,703 - INFO - ROLLBACK
2025-06-29 19:55:50,742 - INFO - 用户 13 连接到目标 7
2025-06-29 19:55:52,319 - INFO - 用户 7 断开连接
2025-06-29 19:55:52,323 - INFO - 用户 7 连接到目标 13
2025-06-29 19:55:56,322 - INFO - 用户 7 断开连接
2025-06-29 19:55:56,333 - INFO - 用户 7 连接到目标 13
2025-06-29 19:56:00,321 - INFO - 用户 7 断开连接
2025-06-29 19:56:00,327 - INFO - 用户 7 连接到目标 13
2025-06-29 19:56:04,333 - INFO - 用户 7 断开连接
2025-06-29 19:56:04,342 - INFO - 用户 7 连接到目标 13
2025-06-29 19:56:07,308 - INFO - 收到消息 from 13 to 7: {'id': 1751198167306, 'text': '13 发出', 'time': '2025-06-29T11:56:07.306Z', 'from': 13, 'to': 7, 'fromUsername': '张翠山', 'fromPhoto': '/avatar/ph_13676542345_9aca.png'}
2025-06-29 19:56:07,309 - INFO - 加密消息： {'encrypt_data': '2d5EIK5JDEBPv1F0XqYWdEXwOkZujaFA7V6fB9lkB0+KmgRsnrCufZ0vPJi7wchPVhIr9TY4l9lf/LAOjUgHTisLr30S/Bao9Tl1pGKr8wrgEq1uBro0kDqSHh1rZkRy0qevoo23xX96NKEUYdP/3SDPtiI7bKhfIxIZtf4IJdpBxeRkKjsQSIvgS9wYQtF/u1Y6PVzRm0adJJMrGe5Cs7RUVRSKZ52yUBE8qcUWmT4J0kUWQW2YqQ9RV2JoC/CRZ2X1g0n/+mIGhZga62dkWTg/hWCV/4JyoTd7XR99Rh5PlUD+RJMPYev8st8PXgZ8', 'publick_key': '2dbb1ea5-5668-412f-99eb-5d5a066ce601'}
2025-06-29 19:56:07,315 - INFO - BEGIN (implicit)
2025-06-29 19:56:07,317 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:56:07,317 - INFO - [cached since 579.4s ago] {'id_1': '7'}
2025-06-29 19:56:08,327 - INFO - 用户 7 断开连接
2025-06-29 19:56:08,331 - INFO - 用户 7 连接到目标 13
2025-06-29 19:56:12,329 - INFO - 用户 7 断开连接
2025-06-29 19:56:12,332 - INFO - 用户 7 连接到目标 13
2025-06-29 19:56:16,325 - INFO - 用户 7 断开连接
2025-06-29 19:56:16,328 - INFO - 用户 7 连接到目标 13
2025-06-29 19:56:20,326 - INFO - 用户 7 断开连接
2025-06-29 19:56:20,331 - INFO - 用户 7 连接到目标 13
2025-06-29 19:56:24,326 - INFO - 用户 7 断开连接
2025-06-29 19:56:24,330 - INFO - 用户 7 连接到目标 13
2025-06-29 19:56:28,320 - INFO - 用户 7 断开连接
2025-06-29 19:56:28,326 - INFO - 用户 7 连接到目标 13
2025-06-29 19:56:31,334 - INFO - 用户 7 断开连接
2025-06-29 19:56:31,341 - INFO - 用户 7 连接到目标 13
2025-06-29 19:56:35,329 - INFO - 用户 7 断开连接
2025-06-29 19:56:35,342 - INFO - 用户 7 连接到目标 13
2025-06-29 19:56:39,319 - INFO - 用户 7 断开连接
2025-06-29 19:56:39,323 - INFO - 用户 7 连接到目标 13
2025-06-29 19:56:43,325 - INFO - 用户 7 断开连接
2025-06-29 19:56:43,328 - INFO - 用户 7 连接到目标 13
2025-06-29 19:56:47,329 - INFO - 用户 7 断开连接
2025-06-29 19:56:47,335 - INFO - 用户 7 连接到目标 13
2025-06-29 19:56:51,324 - INFO - 用户 7 断开连接
2025-06-29 19:56:51,329 - INFO - 用户 7 连接到目标 13
2025-06-29 19:56:55,329 - INFO - 用户 7 断开连接
2025-06-29 19:56:55,333 - INFO - 用户 7 连接到目标 13
2025-06-29 19:56:59,325 - INFO - 用户 7 断开连接
2025-06-29 19:56:59,327 - INFO - 用户 7 连接到目标 13
2025-06-29 19:57:03,327 - INFO - 用户 7 断开连接
2025-06-29 19:57:03,330 - INFO - 用户 7 连接到目标 13
2025-06-29 19:57:07,326 - INFO - 用户 7 断开连接
2025-06-29 19:57:07,329 - INFO - 用户 7 连接到目标 13
2025-06-29 19:57:11,316 - INFO - 用户 7 断开连接
2025-06-29 19:57:11,321 - INFO - 用户 7 连接到目标 13
2025-06-29 19:57:15,320 - INFO - 用户 7 断开连接
2025-06-29 19:57:15,323 - INFO - 用户 7 连接到目标 13
2025-06-29 19:57:19,321 - INFO - 用户 7 断开连接
2025-06-29 19:57:19,325 - INFO - 用户 7 连接到目标 13
2025-06-29 19:57:23,318 - INFO - 用户 7 断开连接
2025-06-29 19:57:23,321 - INFO - 用户 7 连接到目标 13
2025-06-29 19:57:27,329 - INFO - 用户 7 断开连接
2025-06-29 19:57:27,334 - INFO - 用户 7 连接到目标 13
2025-06-29 19:57:31,329 - INFO - 用户 7 断开连接
2025-06-29 19:57:31,333 - INFO - 用户 7 连接到目标 13
2025-06-29 19:57:35,334 - INFO - 用户 7 断开连接
2025-06-29 19:57:35,340 - INFO - 用户 7 连接到目标 13
2025-06-29 19:57:39,320 - INFO - 用户 7 断开连接
2025-06-29 19:57:39,325 - INFO - 用户 7 连接到目标 13
2025-06-29 19:57:43,319 - INFO - 用户 7 断开连接
2025-06-29 19:57:43,322 - INFO - 用户 7 连接到目标 13
2025-06-29 19:57:47,324 - INFO - 用户 7 断开连接
2025-06-29 19:57:47,330 - INFO - 用户 7 连接到目标 13
2025-06-29 19:57:51,329 - INFO - 用户 7 断开连接
2025-06-29 19:57:51,333 - INFO - 用户 7 连接到目标 13
2025-06-29 19:57:55,327 - INFO - 用户 7 断开连接
2025-06-29 19:57:55,334 - INFO - 用户 7 连接到目标 13
2025-06-29 19:57:59,327 - INFO - 用户 7 断开连接
2025-06-29 19:57:59,334 - INFO - 用户 7 连接到目标 13
2025-06-29 19:58:03,334 - INFO - 用户 7 断开连接
2025-06-29 19:58:03,338 - INFO - 用户 7 连接到目标 13
2025-06-29 19:58:07,320 - INFO - 用户 7 断开连接
2025-06-29 19:58:07,332 - INFO - 用户 7 连接到目标 13
2025-06-29 19:58:11,327 - INFO - 用户 7 断开连接
2025-06-29 19:58:11,337 - INFO - 用户 7 连接到目标 13
2025-06-29 19:58:15,316 - INFO - 用户 7 断开连接
2025-06-29 19:58:15,320 - INFO - 用户 7 连接到目标 13
2025-06-29 19:58:19,318 - INFO - 用户 7 断开连接
2025-06-29 19:58:19,330 - INFO - 用户 7 连接到目标 13
2025-06-29 19:58:23,322 - INFO - 用户 7 断开连接
2025-06-29 19:58:23,328 - INFO - 用户 7 连接到目标 13
2025-06-29 19:58:27,319 - INFO - 用户 7 断开连接
2025-06-29 19:58:27,322 - INFO - 用户 7 连接到目标 13
2025-06-29 19:58:31,334 - INFO - 用户 7 断开连接
2025-06-29 19:58:31,340 - INFO - 用户 7 连接到目标 13
2025-06-29 19:58:35,323 - INFO - 用户 7 断开连接
2025-06-29 19:58:35,328 - INFO - 用户 7 连接到目标 13
2025-06-29 19:58:39,332 - INFO - 用户 7 断开连接
2025-06-29 19:58:39,339 - INFO - 用户 7 连接到目标 13
2025-06-29 19:58:43,320 - INFO - 用户 7 断开连接
2025-06-29 19:58:43,326 - INFO - 用户 7 连接到目标 13
2025-06-29 19:58:47,333 - INFO - 用户 7 断开连接
2025-06-29 19:58:47,340 - INFO - 用户 7 连接到目标 13
2025-06-29 19:58:51,324 - INFO - 用户 7 断开连接
2025-06-29 19:58:51,330 - INFO - 用户 7 连接到目标 13
2025-06-29 19:58:55,320 - INFO - 用户 7 断开连接
2025-06-29 19:58:55,323 - INFO - 用户 7 连接到目标 13
2025-06-29 19:58:59,325 - INFO - 用户 7 断开连接
2025-06-29 19:58:59,333 - INFO - 用户 7 连接到目标 13
2025-06-29 19:59:03,326 - INFO - 用户 7 断开连接
2025-06-29 19:59:03,331 - INFO - 用户 7 连接到目标 13
2025-06-29 19:59:07,335 - INFO - 用户 7 断开连接
2025-06-29 19:59:07,341 - INFO - 用户 7 连接到目标 13
2025-06-29 19:59:11,326 - INFO - 用户 7 断开连接
2025-06-29 19:59:11,335 - INFO - 用户 7 连接到目标 13
2025-06-29 19:59:14,338 - INFO - 用户 7 断开连接
2025-06-29 19:59:14,341 - INFO - 用户 7 连接到目标 13
2025-06-29 19:59:15,230 - INFO - BEGIN (implicit)
2025-06-29 19:59:15,231 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:59:15,231 - INFO - [cached since 6874s ago] {'id_1': 6}
2025-06-29 19:59:15,233 - INFO - ROLLBACK
2025-06-29 19:59:15,241 - INFO - 用户 7 断开连接
2025-06-29 19:59:15,256 - INFO - 用户 7 连接到目标 6
2025-06-29 19:59:17,349 - INFO - 用户 7 断开连接
2025-06-29 19:59:17,360 - INFO - 用户 7 连接到目标 6
2025-06-29 19:59:18,254 - INFO - 用户 7 断开连接
2025-06-29 19:59:18,257 - INFO - 用户 7 连接到目标 6
2025-06-29 19:59:20,736 - INFO - 用户 7 断开连接
2025-06-29 19:59:20,739 - INFO - 用户 7 连接到目标 6
2025-06-29 19:59:21,263 - INFO - 用户 7 断开连接
2025-06-29 19:59:21,267 - INFO - 用户 7 连接到目标 6
2025-06-29 19:59:23,721 - INFO - 用户 7 断开连接
2025-06-29 19:59:23,738 - INFO - 用户 7 连接到目标 6
2025-06-29 19:59:24,267 - INFO - 用户 7 断开连接
2025-06-29 19:59:24,274 - INFO - 用户 7 连接到目标 6
2025-06-29 19:59:26,742 - INFO - 用户 7 断开连接
2025-06-29 19:59:26,758 - INFO - 用户 7 连接到目标 6
2025-06-29 19:59:27,292 - INFO - 用户 7 断开连接
2025-06-29 19:59:27,300 - INFO - 用户 7 连接到目标 6
2025-06-29 19:59:29,129 - INFO - 用户 7 断开连接
2025-06-29 19:59:30,984 - INFO - BEGIN (implicit)
2025-06-29 19:59:30,984 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 19:59:30,985 - INFO - [cached since 6890s ago] {'id_1': 6}
2025-06-29 19:59:30,991 - INFO - ROLLBACK
2025-06-29 19:59:31,042 - INFO - 用户 7 连接到目标 6
2025-06-29 20:00:06,386 - INFO - BEGIN (implicit)
2025-06-29 20:00:06,387 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:00:06,387 - INFO - [cached since 6926s ago] {'id_1': 13}
2025-06-29 20:00:06,389 - INFO - ROLLBACK
2025-06-29 20:00:06,397 - INFO - 用户 7 断开连接
2025-06-29 20:00:06,406 - INFO - 用户 7 连接到目标 13
2025-06-29 20:00:09,416 - INFO - 用户 7 断开连接
2025-06-29 20:00:09,419 - INFO - 用户 7 连接到目标 13
2025-06-29 20:00:12,424 - INFO - 用户 7 断开连接
2025-06-29 20:00:12,429 - INFO - 用户 7 连接到目标 13
2025-06-29 20:00:15,448 - INFO - 用户 7 断开连接
2025-06-29 20:00:15,452 - INFO - 用户 7 连接到目标 13
2025-06-29 20:00:18,466 - INFO - 用户 7 断开连接
2025-06-29 20:00:18,471 - INFO - 用户 7 连接到目标 13
2025-06-29 20:00:21,488 - INFO - 用户 7 断开连接
2025-06-29 20:00:21,496 - INFO - 用户 7 连接到目标 13
2025-06-29 20:00:24,503 - INFO - 用户 7 断开连接
2025-06-29 20:00:24,506 - INFO - 用户 7 连接到目标 13
2025-06-29 20:00:27,524 - INFO - 用户 7 断开连接
2025-06-29 20:00:27,526 - INFO - 用户 7 连接到目标 13
2025-06-29 20:00:30,536 - INFO - 用户 7 断开连接
2025-06-29 20:00:30,539 - INFO - 用户 7 连接到目标 13
2025-06-29 20:00:33,553 - INFO - 用户 7 断开连接
2025-06-29 20:00:33,557 - INFO - 用户 7 连接到目标 13
2025-06-29 20:00:37,330 - INFO - 用户 7 断开连接
2025-06-29 20:00:37,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:00:41,328 - INFO - 用户 7 断开连接
2025-06-29 20:00:41,335 - INFO - 用户 7 连接到目标 13
2025-06-29 20:00:45,320 - INFO - 用户 7 断开连接
2025-06-29 20:00:45,324 - INFO - 用户 7 连接到目标 13
2025-06-29 20:00:49,327 - INFO - 用户 7 断开连接
2025-06-29 20:00:49,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:00:53,330 - INFO - 用户 7 断开连接
2025-06-29 20:00:53,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:00:57,322 - INFO - 用户 7 断开连接
2025-06-29 20:00:57,326 - INFO - 用户 7 连接到目标 13
2025-06-29 20:01:01,329 - INFO - 用户 7 断开连接
2025-06-29 20:01:01,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:01:05,326 - INFO - 用户 7 断开连接
2025-06-29 20:01:05,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:01:09,320 - INFO - 用户 7 断开连接
2025-06-29 20:01:09,323 - INFO - 用户 7 连接到目标 13
2025-06-29 20:01:13,322 - INFO - 用户 7 断开连接
2025-06-29 20:01:13,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:01:17,331 - INFO - 用户 7 断开连接
2025-06-29 20:01:17,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:01:21,316 - INFO - 用户 7 断开连接
2025-06-29 20:01:21,320 - INFO - 用户 7 连接到目标 13
2025-06-29 20:01:25,331 - INFO - 用户 7 断开连接
2025-06-29 20:01:25,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:01:29,334 - INFO - 用户 7 断开连接
2025-06-29 20:01:29,341 - INFO - 用户 7 连接到目标 13
2025-06-29 20:01:33,320 - INFO - 用户 7 断开连接
2025-06-29 20:01:33,324 - INFO - 用户 7 连接到目标 13
2025-06-29 20:01:37,332 - INFO - 用户 7 断开连接
2025-06-29 20:01:37,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:01:41,328 - INFO - 用户 7 断开连接
2025-06-29 20:01:41,331 - INFO - 用户 7 连接到目标 13
2025-06-29 20:01:45,319 - INFO - 用户 7 断开连接
2025-06-29 20:01:45,327 - INFO - 用户 7 连接到目标 13
2025-06-29 20:01:49,336 - INFO - 用户 7 断开连接
2025-06-29 20:01:49,342 - INFO - 用户 7 连接到目标 13
2025-06-29 20:01:53,319 - INFO - 用户 7 断开连接
2025-06-29 20:01:53,322 - INFO - 用户 7 连接到目标 13
2025-06-29 20:01:57,328 - INFO - 用户 7 断开连接
2025-06-29 20:01:57,331 - INFO - 用户 7 连接到目标 13
2025-06-29 20:02:01,315 - INFO - 用户 7 断开连接
2025-06-29 20:02:01,323 - INFO - 用户 7 连接到目标 13
2025-06-29 20:02:05,329 - INFO - 用户 7 断开连接
2025-06-29 20:02:05,337 - INFO - 用户 7 连接到目标 13
2025-06-29 20:02:09,353 - INFO - 用户 7 断开连接
2025-06-29 20:02:09,361 - INFO - 用户 7 连接到目标 13
2025-06-29 20:02:13,321 - INFO - 用户 7 断开连接
2025-06-29 20:02:13,327 - INFO - 用户 7 连接到目标 13
2025-06-29 20:02:17,334 - INFO - 用户 7 断开连接
2025-06-29 20:02:17,339 - INFO - 用户 7 连接到目标 13
2025-06-29 20:02:21,322 - INFO - 用户 7 断开连接
2025-06-29 20:02:21,326 - INFO - 用户 7 连接到目标 13
2025-06-29 20:02:25,324 - INFO - 用户 7 断开连接
2025-06-29 20:02:25,331 - INFO - 用户 7 连接到目标 13
2025-06-29 20:02:29,327 - INFO - 用户 7 断开连接
2025-06-29 20:02:29,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:02:33,324 - INFO - 用户 7 断开连接
2025-06-29 20:02:33,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:02:37,328 - INFO - 用户 7 断开连接
2025-06-29 20:02:37,335 - INFO - 用户 7 连接到目标 13
2025-06-29 20:02:41,327 - INFO - 用户 7 断开连接
2025-06-29 20:02:41,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:02:45,385 - INFO - 用户 7 断开连接
2025-06-29 20:02:45,394 - INFO - 用户 7 连接到目标 13
2025-06-29 20:02:48,440 - INFO - 用户 7 断开连接
2025-06-29 20:02:48,451 - INFO - 用户 7 连接到目标 13
2025-06-29 20:02:50,303 - INFO - 用户 7 断开连接
2025-06-29 20:02:50,998 - INFO - BEGIN (implicit)
2025-06-29 20:02:50,999 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:02:50,999 - INFO - [cached since 7090s ago] {'id_1': 13}
2025-06-29 20:02:51,002 - INFO - ROLLBACK
2025-06-29 20:02:51,028 - INFO - 用户 7 连接到目标 13
2025-06-29 20:02:53,898 - INFO - BEGIN (implicit)
2025-06-29 20:02:53,899 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:02:53,899 - INFO - [cached since 7093s ago] {'id_1': 6}
2025-06-29 20:02:53,901 - INFO - ROLLBACK
2025-06-29 20:02:53,913 - INFO - 用户 7 断开连接
2025-06-29 20:02:53,919 - INFO - 用户 7 连接到目标 6
2025-06-29 20:02:56,444 - INFO - 用户 7 断开连接
2025-06-29 20:02:56,641 - INFO - BEGIN (implicit)
2025-06-29 20:02:56,644 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:02:56,644 - INFO - [cached since 7096s ago] {'id_1': 6}
2025-06-29 20:02:56,659 - INFO - ROLLBACK
2025-06-29 20:02:56,671 - INFO - 用户 7 连接到目标 6
2025-06-29 20:03:33,229 - INFO - 用户 13 断开连接
2025-06-29 20:03:33,231 - INFO - ROLLBACK
2025-06-29 20:03:33,958 - INFO - BEGIN (implicit)
2025-06-29 20:03:33,959 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:03:33,959 - INFO - [cached since 7133s ago] {'id_1': 7}
2025-06-29 20:03:33,963 - INFO - ROLLBACK
2025-06-29 20:03:34,046 - INFO - 用户 13 连接到目标 7
2025-06-29 20:04:55,363 - INFO - 用户 13 连接到目标 7
2025-06-29 20:06:32,651 - INFO - SELECT DATABASE()
2025-06-29 20:06:32,652 - INFO - [raw sql] {}
2025-06-29 20:06:32,655 - INFO - SELECT @@sql_mode
2025-06-29 20:06:32,655 - INFO - [raw sql] {}
2025-06-29 20:06:32,656 - INFO - SELECT @@lower_case_table_names
2025-06-29 20:06:32,658 - INFO - [raw sql] {}
2025-06-29 20:06:32,662 - INFO - BEGIN (implicit)
2025-06-29 20:06:32,669 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users
2025-06-29 20:06:32,669 - INFO - [generated in 0.00041s] {}
2025-06-29 20:06:32,677 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
 LIMIT %(param_1)s, %(param_2)s
2025-06-29 20:06:32,678 - INFO - [generated in 0.00059s] {'param_1': 0, 'param_2': 10}
2025-06-29 20:06:32,682 - INFO - ROLLBACK
2025-06-29 20:06:34,816 - INFO - BEGIN (implicit)
2025-06-29 20:06:34,818 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:06:34,818 - INFO - [generated in 0.00042s] {'id_1': 6}
2025-06-29 20:06:34,822 - INFO - ROLLBACK
2025-06-29 20:06:34,839 - INFO - 用户 7 连接到目标 6
2025-06-29 20:06:56,812 - INFO - BEGIN (implicit)
2025-06-29 20:06:56,813 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:06:56,813 - INFO - [cached since 22s ago] {'id_1': 13}
2025-06-29 20:06:56,816 - INFO - ROLLBACK
2025-06-29 20:06:56,823 - INFO - 用户 7 断开连接
2025-06-29 20:06:56,830 - INFO - 用户 7 连接到目标 13
2025-06-29 20:07:00,327 - INFO - 用户 7 断开连接
2025-06-29 20:07:00,331 - INFO - 用户 7 连接到目标 13
2025-06-29 20:07:04,328 - INFO - 用户 7 断开连接
2025-06-29 20:07:04,332 - INFO - 用户 7 连接到目标 13
2025-06-29 20:07:08,330 - INFO - 用户 7 断开连接
2025-06-29 20:07:08,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:07:12,330 - INFO - 用户 7 断开连接
2025-06-29 20:07:12,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:07:16,331 - INFO - 用户 7 断开连接
2025-06-29 20:07:16,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:07:20,330 - INFO - 用户 7 断开连接
2025-06-29 20:07:20,335 - INFO - 用户 7 连接到目标 13
2025-06-29 20:07:24,327 - INFO - 用户 7 断开连接
2025-06-29 20:07:24,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:07:27,338 - INFO - 用户 7 断开连接
2025-06-29 20:07:27,342 - INFO - 用户 7 连接到目标 13
2025-06-29 20:07:30,351 - INFO - 用户 7 断开连接
2025-06-29 20:07:30,358 - INFO - 用户 7 连接到目标 13
2025-06-29 20:07:33,366 - INFO - 用户 7 断开连接
2025-06-29 20:07:33,373 - INFO - 用户 7 连接到目标 13
2025-06-29 20:07:36,383 - INFO - 用户 7 断开连接
2025-06-29 20:07:36,386 - INFO - 用户 7 连接到目标 13
2025-06-29 20:07:39,394 - INFO - 用户 7 断开连接
2025-06-29 20:07:39,398 - INFO - 用户 7 连接到目标 13
2025-06-29 20:07:42,415 - INFO - 用户 7 断开连接
2025-06-29 20:07:42,418 - INFO - 用户 7 连接到目标 13
2025-06-29 20:07:45,427 - INFO - 用户 7 断开连接
2025-06-29 20:07:45,437 - INFO - 用户 7 连接到目标 13
2025-06-29 20:07:48,448 - INFO - 用户 7 断开连接
2025-06-29 20:07:48,452 - INFO - 用户 7 连接到目标 13
2025-06-29 20:07:51,464 - INFO - 用户 7 断开连接
2025-06-29 20:07:51,467 - INFO - 用户 7 连接到目标 13
2025-06-29 20:07:54,483 - INFO - 用户 7 断开连接
2025-06-29 20:07:54,487 - INFO - 用户 7 连接到目标 13
2025-06-29 20:07:57,503 - INFO - 用户 7 断开连接
2025-06-29 20:07:57,506 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:00,523 - INFO - 用户 7 断开连接
2025-06-29 20:08:00,526 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:03,544 - INFO - 用户 7 断开连接
2025-06-29 20:08:03,547 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:06,565 - INFO - 用户 7 断开连接
2025-06-29 20:08:06,568 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:09,581 - INFO - 用户 7 断开连接
2025-06-29 20:08:09,584 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:12,595 - INFO - 用户 7 断开连接
2025-06-29 20:08:12,598 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:15,618 - INFO - 用户 7 断开连接
2025-06-29 20:08:15,623 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:18,639 - INFO - 用户 7 断开连接
2025-06-29 20:08:18,643 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:21,655 - INFO - 用户 7 断开连接
2025-06-29 20:08:21,658 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:24,674 - INFO - 用户 7 断开连接
2025-06-29 20:08:24,678 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:27,687 - INFO - 用户 7 断开连接
2025-06-29 20:08:27,690 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:30,706 - INFO - 用户 7 断开连接
2025-06-29 20:08:30,708 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:33,717 - INFO - 用户 7 断开连接
2025-06-29 20:08:33,720 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:36,736 - INFO - 用户 7 断开连接
2025-06-29 20:08:36,739 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:39,758 - INFO - 用户 7 断开连接
2025-06-29 20:08:39,761 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:42,783 - INFO - 用户 7 断开连接
2025-06-29 20:08:42,787 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:45,803 - INFO - 用户 7 断开连接
2025-06-29 20:08:45,805 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:48,824 - INFO - 用户 7 断开连接
2025-06-29 20:08:48,827 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:51,838 - INFO - 用户 7 断开连接
2025-06-29 20:08:51,841 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:54,855 - INFO - 用户 7 断开连接
2025-06-29 20:08:54,857 - INFO - 用户 7 连接到目标 13
2025-06-29 20:08:57,872 - INFO - 用户 7 断开连接
2025-06-29 20:08:57,876 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:00,880 - INFO - 用户 7 断开连接
2025-06-29 20:09:00,882 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:03,894 - INFO - 用户 7 断开连接
2025-06-29 20:09:03,898 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:06,914 - INFO - 用户 7 断开连接
2025-06-29 20:09:06,917 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:09,936 - INFO - 用户 7 断开连接
2025-06-29 20:09:09,939 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:12,956 - INFO - 用户 7 断开连接
2025-06-29 20:09:12,958 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:15,970 - INFO - 用户 7 断开连接
2025-06-29 20:09:15,973 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:18,989 - INFO - 用户 7 断开连接
2025-06-29 20:09:18,993 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:22,012 - INFO - 用户 7 断开连接
2025-06-29 20:09:22,016 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:25,019 - INFO - 用户 7 断开连接
2025-06-29 20:09:25,021 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:28,038 - INFO - 用户 7 断开连接
2025-06-29 20:09:28,045 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:31,063 - INFO - 用户 7 断开连接
2025-06-29 20:09:31,067 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:34,087 - INFO - 用户 7 断开连接
2025-06-29 20:09:34,091 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:37,096 - INFO - 用户 7 断开连接
2025-06-29 20:09:37,098 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:40,112 - INFO - 用户 7 断开连接
2025-06-29 20:09:40,115 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:43,129 - INFO - 用户 7 断开连接
2025-06-29 20:09:43,132 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:46,151 - INFO - 用户 7 断开连接
2025-06-29 20:09:46,155 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:49,161 - INFO - 用户 7 断开连接
2025-06-29 20:09:49,163 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:52,177 - INFO - 用户 7 断开连接
2025-06-29 20:09:52,186 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:55,194 - INFO - 用户 7 断开连接
2025-06-29 20:09:55,199 - INFO - 用户 7 连接到目标 13
2025-06-29 20:09:58,213 - INFO - 用户 7 断开连接
2025-06-29 20:09:58,217 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:01,237 - INFO - 用户 7 断开连接
2025-06-29 20:10:01,240 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:04,248 - INFO - 用户 7 断开连接
2025-06-29 20:10:04,251 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:07,272 - INFO - 用户 7 断开连接
2025-06-29 20:10:07,276 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:10,290 - INFO - 用户 7 断开连接
2025-06-29 20:10:10,293 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:13,308 - INFO - 用户 7 断开连接
2025-06-29 20:10:13,312 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:16,329 - INFO - 用户 7 断开连接
2025-06-29 20:10:16,332 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:19,348 - INFO - 用户 7 断开连接
2025-06-29 20:10:19,351 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:22,371 - INFO - 用户 7 断开连接
2025-06-29 20:10:22,375 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:25,390 - INFO - 用户 7 断开连接
2025-06-29 20:10:25,394 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:28,414 - INFO - 用户 7 断开连接
2025-06-29 20:10:28,418 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:31,431 - INFO - 用户 7 断开连接
2025-06-29 20:10:31,433 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:34,448 - INFO - 用户 7 断开连接
2025-06-29 20:10:34,451 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:37,469 - INFO - 用户 7 断开连接
2025-06-29 20:10:37,473 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:40,488 - INFO - 用户 7 断开连接
2025-06-29 20:10:40,492 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:43,510 - INFO - 用户 7 断开连接
2025-06-29 20:10:43,515 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:46,521 - INFO - 用户 7 断开连接
2025-06-29 20:10:46,523 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:49,533 - INFO - 用户 7 断开连接
2025-06-29 20:10:49,539 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:52,550 - INFO - 用户 7 断开连接
2025-06-29 20:10:52,554 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:55,574 - INFO - 用户 7 断开连接
2025-06-29 20:10:55,578 - INFO - 用户 7 连接到目标 13
2025-06-29 20:10:58,580 - INFO - 用户 7 断开连接
2025-06-29 20:10:58,583 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:01,601 - INFO - 用户 7 断开连接
2025-06-29 20:11:01,604 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:04,618 - INFO - 用户 7 断开连接
2025-06-29 20:11:04,622 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:07,636 - INFO - 用户 7 断开连接
2025-06-29 20:11:07,639 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:10,652 - INFO - 用户 7 断开连接
2025-06-29 20:11:10,655 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:13,660 - INFO - 用户 7 断开连接
2025-06-29 20:11:13,665 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:16,668 - INFO - 用户 7 断开连接
2025-06-29 20:11:16,670 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:19,688 - INFO - 用户 7 断开连接
2025-06-29 20:11:19,690 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:22,708 - INFO - 用户 7 断开连接
2025-06-29 20:11:22,711 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:25,725 - INFO - 用户 7 断开连接
2025-06-29 20:11:25,729 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:28,734 - INFO - 用户 7 断开连接
2025-06-29 20:11:28,738 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:31,758 - INFO - 用户 7 断开连接
2025-06-29 20:11:31,760 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:34,776 - INFO - 用户 7 断开连接
2025-06-29 20:11:34,778 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:37,799 - INFO - 用户 7 断开连接
2025-06-29 20:11:37,803 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:40,823 - INFO - 用户 7 断开连接
2025-06-29 20:11:40,827 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:43,829 - INFO - 用户 7 断开连接
2025-06-29 20:11:43,833 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:46,839 - INFO - 用户 7 断开连接
2025-06-29 20:11:46,841 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:49,865 - INFO - 用户 7 断开连接
2025-06-29 20:11:49,870 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:52,886 - INFO - 用户 7 断开连接
2025-06-29 20:11:52,893 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:55,908 - INFO - 用户 7 断开连接
2025-06-29 20:11:55,913 - INFO - 用户 7 连接到目标 13
2025-06-29 20:11:58,928 - INFO - 用户 7 断开连接
2025-06-29 20:11:58,931 - INFO - 用户 7 连接到目标 13
2025-06-29 20:12:01,940 - INFO - 用户 7 断开连接
2025-06-29 20:12:01,944 - INFO - 用户 7 连接到目标 13
2025-06-29 20:12:04,954 - INFO - 用户 7 断开连接
2025-06-29 20:12:04,957 - INFO - 用户 7 连接到目标 13
2025-06-29 20:12:07,969 - INFO - 用户 7 断开连接
2025-06-29 20:12:07,973 - INFO - 用户 7 连接到目标 13
2025-06-29 20:12:10,988 - INFO - 用户 7 断开连接
2025-06-29 20:12:10,990 - INFO - 用户 7 连接到目标 13
2025-06-29 20:12:13,998 - INFO - 用户 7 断开连接
2025-06-29 20:12:14,001 - INFO - 用户 7 连接到目标 13
2025-06-29 20:12:17,014 - INFO - 用户 7 断开连接
2025-06-29 20:12:17,017 - INFO - 用户 7 连接到目标 13
2025-06-29 20:12:20,029 - INFO - 用户 7 断开连接
2025-06-29 20:12:20,033 - INFO - 用户 7 连接到目标 13
2025-06-29 20:12:23,049 - INFO - 用户 7 断开连接
2025-06-29 20:12:23,052 - INFO - 用户 7 连接到目标 13
2025-06-29 20:12:26,071 - INFO - 用户 7 断开连接
2025-06-29 20:12:26,073 - INFO - 用户 7 连接到目标 13
2025-06-29 20:12:29,080 - INFO - 用户 7 断开连接
2025-06-29 20:12:29,087 - INFO - 用户 7 连接到目标 13
2025-06-29 20:12:32,101 - INFO - 用户 7 断开连接
2025-06-29 20:12:32,104 - INFO - 用户 7 连接到目标 13
2025-06-29 20:12:35,320 - INFO - 用户 7 断开连接
2025-06-29 20:12:35,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:12:39,319 - INFO - 用户 7 断开连接
2025-06-29 20:12:39,325 - INFO - 用户 7 连接到目标 13
2025-06-29 20:12:43,328 - INFO - 用户 7 断开连接
2025-06-29 20:12:43,335 - INFO - 用户 7 连接到目标 13
2025-06-29 20:12:47,329 - INFO - 用户 7 断开连接
2025-06-29 20:12:47,335 - INFO - 用户 7 连接到目标 13
2025-06-29 20:12:51,323 - INFO - 用户 7 断开连接
2025-06-29 20:12:51,328 - INFO - 用户 7 连接到目标 13
2025-06-29 20:12:55,332 - INFO - 用户 7 断开连接
2025-06-29 20:12:55,339 - INFO - 用户 7 连接到目标 13
2025-06-29 20:12:59,319 - INFO - 用户 7 断开连接
2025-06-29 20:12:59,328 - INFO - 用户 7 连接到目标 13
2025-06-29 20:13:03,318 - INFO - 用户 7 断开连接
2025-06-29 20:13:03,325 - INFO - 用户 7 连接到目标 13
2025-06-29 20:13:07,327 - INFO - 用户 7 断开连接
2025-06-29 20:13:07,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:13:11,320 - INFO - 用户 7 断开连接
2025-06-29 20:13:11,326 - INFO - 用户 7 连接到目标 13
2025-06-29 20:13:15,334 - INFO - 用户 7 断开连接
2025-06-29 20:13:15,339 - INFO - 用户 7 连接到目标 13
2025-06-29 20:13:19,323 - INFO - 用户 7 断开连接
2025-06-29 20:13:19,335 - INFO - 用户 7 连接到目标 13
2025-06-29 20:13:23,320 - INFO - 用户 7 断开连接
2025-06-29 20:13:23,328 - INFO - 用户 7 连接到目标 13
2025-06-29 20:13:27,334 - INFO - 用户 7 断开连接
2025-06-29 20:13:27,341 - INFO - 用户 7 连接到目标 13
2025-06-29 20:13:31,330 - INFO - 用户 7 断开连接
2025-06-29 20:13:31,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:13:35,331 - INFO - 用户 7 断开连接
2025-06-29 20:13:35,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:13:39,328 - INFO - 用户 7 断开连接
2025-06-29 20:13:39,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:13:43,320 - INFO - 用户 7 断开连接
2025-06-29 20:13:43,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:13:47,318 - INFO - 用户 7 断开连接
2025-06-29 20:13:47,325 - INFO - 用户 7 连接到目标 13
2025-06-29 20:13:51,325 - INFO - 用户 7 断开连接
2025-06-29 20:13:51,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:13:55,331 - INFO - 用户 7 断开连接
2025-06-29 20:13:55,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:13:59,325 - INFO - 用户 7 断开连接
2025-06-29 20:13:59,331 - INFO - 用户 7 连接到目标 13
2025-06-29 20:14:03,330 - INFO - 用户 7 断开连接
2025-06-29 20:14:03,337 - INFO - 用户 7 连接到目标 13
2025-06-29 20:14:07,319 - INFO - 用户 7 断开连接
2025-06-29 20:14:07,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:14:11,333 - INFO - 用户 7 断开连接
2025-06-29 20:14:11,340 - INFO - 用户 7 连接到目标 13
2025-06-29 20:14:15,321 - INFO - 用户 7 断开连接
2025-06-29 20:14:15,327 - INFO - 用户 7 连接到目标 13
2025-06-29 20:14:19,325 - INFO - 用户 7 断开连接
2025-06-29 20:14:19,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:14:23,334 - INFO - 用户 7 断开连接
2025-06-29 20:14:23,340 - INFO - 用户 7 连接到目标 13
2025-06-29 20:14:27,328 - INFO - 用户 7 断开连接
2025-06-29 20:14:27,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:14:31,326 - INFO - 用户 7 断开连接
2025-06-29 20:14:31,332 - INFO - 用户 7 连接到目标 13
2025-06-29 20:14:35,332 - INFO - 用户 7 断开连接
2025-06-29 20:14:35,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:14:39,332 - INFO - 用户 7 断开连接
2025-06-29 20:14:39,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:14:43,332 - INFO - 用户 7 断开连接
2025-06-29 20:14:43,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:14:47,329 - INFO - 用户 7 断开连接
2025-06-29 20:14:47,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:14:51,323 - INFO - 用户 7 断开连接
2025-06-29 20:14:51,328 - INFO - 用户 7 连接到目标 13
2025-06-29 20:14:55,332 - INFO - 用户 7 断开连接
2025-06-29 20:14:55,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:14:59,320 - INFO - 用户 7 断开连接
2025-06-29 20:14:59,326 - INFO - 用户 7 连接到目标 13
2025-06-29 20:15:03,332 - INFO - 用户 7 断开连接
2025-06-29 20:15:03,337 - INFO - 用户 7 连接到目标 13
2025-06-29 20:15:07,328 - INFO - 用户 7 断开连接
2025-06-29 20:15:07,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:15:11,322 - INFO - 用户 7 断开连接
2025-06-29 20:15:11,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:15:15,323 - INFO - 用户 7 断开连接
2025-06-29 20:15:15,328 - INFO - 用户 7 连接到目标 13
2025-06-29 20:15:19,328 - INFO - 用户 7 断开连接
2025-06-29 20:15:19,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:15:23,330 - INFO - 用户 7 断开连接
2025-06-29 20:15:23,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:15:27,323 - INFO - 用户 7 断开连接
2025-06-29 20:15:27,328 - INFO - 用户 7 连接到目标 13
2025-06-29 20:15:31,328 - INFO - 用户 7 断开连接
2025-06-29 20:15:31,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:15:35,326 - INFO - 用户 7 断开连接
2025-06-29 20:15:35,332 - INFO - 用户 7 连接到目标 13
2025-06-29 20:15:39,325 - INFO - 用户 7 断开连接
2025-06-29 20:15:39,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:15:43,325 - INFO - 用户 7 断开连接
2025-06-29 20:15:43,331 - INFO - 用户 7 连接到目标 13
2025-06-29 20:15:47,330 - INFO - 用户 7 断开连接
2025-06-29 20:15:47,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:15:51,327 - INFO - 用户 7 断开连接
2025-06-29 20:15:51,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:15:55,321 - INFO - 用户 7 断开连接
2025-06-29 20:15:55,325 - INFO - 用户 7 连接到目标 13
2025-06-29 20:15:59,324 - INFO - 用户 7 断开连接
2025-06-29 20:15:59,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:16:03,324 - INFO - 用户 7 断开连接
2025-06-29 20:16:03,331 - INFO - 用户 7 连接到目标 13
2025-06-29 20:16:07,332 - INFO - 用户 7 断开连接
2025-06-29 20:16:07,337 - INFO - 用户 7 连接到目标 13
2025-06-29 20:16:11,329 - INFO - 用户 7 断开连接
2025-06-29 20:16:11,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:16:15,321 - INFO - 用户 7 断开连接
2025-06-29 20:16:15,326 - INFO - 用户 7 连接到目标 13
2025-06-29 20:16:19,329 - INFO - 用户 7 断开连接
2025-06-29 20:16:19,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:16:23,332 - INFO - 用户 7 断开连接
2025-06-29 20:16:23,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:16:27,332 - INFO - 用户 7 断开连接
2025-06-29 20:16:27,339 - INFO - 用户 7 连接到目标 13
2025-06-29 20:16:31,320 - INFO - 用户 7 断开连接
2025-06-29 20:16:31,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:16:35,323 - INFO - 用户 7 断开连接
2025-06-29 20:16:35,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:16:39,333 - INFO - 用户 7 断开连接
2025-06-29 20:16:39,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:16:43,331 - INFO - 用户 7 断开连接
2025-06-29 20:16:43,337 - INFO - 用户 7 连接到目标 13
2025-06-29 20:16:47,331 - INFO - 用户 7 断开连接
2025-06-29 20:16:47,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:16:51,330 - INFO - 用户 7 断开连接
2025-06-29 20:16:51,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:16:55,324 - INFO - 用户 7 断开连接
2025-06-29 20:16:55,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:16:59,327 - INFO - 用户 7 断开连接
2025-06-29 20:16:59,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:17:03,324 - INFO - 用户 7 断开连接
2025-06-29 20:17:03,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:17:07,323 - INFO - 用户 7 断开连接
2025-06-29 20:17:07,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:17:11,327 - INFO - 用户 7 断开连接
2025-06-29 20:17:11,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:17:15,323 - INFO - 用户 7 断开连接
2025-06-29 20:17:15,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:17:19,320 - INFO - 用户 7 断开连接
2025-06-29 20:17:19,326 - INFO - 用户 7 连接到目标 13
2025-06-29 20:17:23,327 - INFO - 用户 7 断开连接
2025-06-29 20:17:23,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:17:27,327 - INFO - 用户 7 断开连接
2025-06-29 20:17:27,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:17:31,331 - INFO - 用户 7 断开连接
2025-06-29 20:17:31,337 - INFO - 用户 7 连接到目标 13
2025-06-29 20:17:35,330 - INFO - 用户 7 断开连接
2025-06-29 20:17:35,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:17:39,319 - INFO - 用户 7 断开连接
2025-06-29 20:17:39,324 - INFO - 用户 7 连接到目标 13
2025-06-29 20:17:43,328 - INFO - 用户 7 断开连接
2025-06-29 20:17:43,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:17:47,322 - INFO - 用户 7 断开连接
2025-06-29 20:17:47,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:17:51,330 - INFO - 用户 7 断开连接
2025-06-29 20:17:51,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:17:55,328 - INFO - 用户 7 断开连接
2025-06-29 20:17:55,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:17:59,325 - INFO - 用户 7 断开连接
2025-06-29 20:17:59,331 - INFO - 用户 7 连接到目标 13
2025-06-29 20:18:03,326 - INFO - 用户 7 断开连接
2025-06-29 20:18:03,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:18:07,322 - INFO - 用户 7 断开连接
2025-06-29 20:18:07,327 - INFO - 用户 7 连接到目标 13
2025-06-29 20:18:11,332 - INFO - 用户 7 断开连接
2025-06-29 20:18:11,337 - INFO - 用户 7 连接到目标 13
2025-06-29 20:18:15,333 - INFO - 用户 7 断开连接
2025-06-29 20:18:15,340 - INFO - 用户 7 连接到目标 13
2025-06-29 20:18:19,332 - INFO - 用户 7 断开连接
2025-06-29 20:18:19,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:18:23,333 - INFO - 用户 7 断开连接
2025-06-29 20:18:23,339 - INFO - 用户 7 连接到目标 13
2025-06-29 20:18:27,329 - INFO - 用户 7 断开连接
2025-06-29 20:18:27,335 - INFO - 用户 7 连接到目标 13
2025-06-29 20:18:31,329 - INFO - 用户 7 断开连接
2025-06-29 20:18:31,335 - INFO - 用户 7 连接到目标 13
2025-06-29 20:18:35,329 - INFO - 用户 7 断开连接
2025-06-29 20:18:35,337 - INFO - 用户 7 连接到目标 13
2025-06-29 20:18:39,325 - INFO - 用户 7 断开连接
2025-06-29 20:18:39,331 - INFO - 用户 7 连接到目标 13
2025-06-29 20:18:43,320 - INFO - 用户 7 断开连接
2025-06-29 20:18:43,327 - INFO - 用户 7 连接到目标 13
2025-06-29 20:18:47,336 - INFO - 用户 7 断开连接
2025-06-29 20:18:47,342 - INFO - 用户 7 连接到目标 13
2025-06-29 20:18:51,330 - INFO - 用户 7 断开连接
2025-06-29 20:18:51,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:18:55,323 - INFO - 用户 7 断开连接
2025-06-29 20:18:55,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:18:59,326 - INFO - 用户 7 断开连接
2025-06-29 20:18:59,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:19:03,332 - INFO - 用户 7 断开连接
2025-06-29 20:19:03,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:19:07,323 - INFO - 用户 7 断开连接
2025-06-29 20:19:07,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:19:11,335 - INFO - 用户 7 断开连接
2025-06-29 20:19:11,343 - INFO - 用户 7 连接到目标 13
2025-06-29 20:19:15,332 - INFO - 用户 7 断开连接
2025-06-29 20:19:15,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:19:19,326 - INFO - 用户 7 断开连接
2025-06-29 20:19:19,332 - INFO - 用户 7 连接到目标 13
2025-06-29 20:19:23,333 - INFO - 用户 7 断开连接
2025-06-29 20:19:23,341 - INFO - 用户 7 连接到目标 13
2025-06-29 20:19:27,322 - INFO - 用户 7 断开连接
2025-06-29 20:19:27,332 - INFO - 用户 7 连接到目标 13
2025-06-29 20:19:31,324 - INFO - 用户 7 断开连接
2025-06-29 20:19:31,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:19:35,330 - INFO - 用户 7 断开连接
2025-06-29 20:19:35,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:19:39,333 - INFO - 用户 7 断开连接
2025-06-29 20:19:39,341 - INFO - 用户 7 连接到目标 13
2025-06-29 20:19:43,321 - INFO - 用户 7 断开连接
2025-06-29 20:19:43,326 - INFO - 用户 7 连接到目标 13
2025-06-29 20:19:47,323 - INFO - 用户 7 断开连接
2025-06-29 20:19:47,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:19:51,334 - INFO - 用户 7 断开连接
2025-06-29 20:19:51,341 - INFO - 用户 7 连接到目标 13
2025-06-29 20:19:55,326 - INFO - 用户 7 断开连接
2025-06-29 20:19:55,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:19:59,335 - INFO - 用户 7 断开连接
2025-06-29 20:19:59,342 - INFO - 用户 7 连接到目标 13
2025-06-29 20:20:03,329 - INFO - 用户 7 断开连接
2025-06-29 20:20:03,335 - INFO - 用户 7 连接到目标 13
2025-06-29 20:20:07,322 - INFO - 用户 7 断开连接
2025-06-29 20:20:07,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:20:11,330 - INFO - 用户 7 断开连接
2025-06-29 20:20:11,335 - INFO - 用户 7 连接到目标 13
2025-06-29 20:20:15,319 - INFO - 用户 7 断开连接
2025-06-29 20:20:15,325 - INFO - 用户 7 连接到目标 13
2025-06-29 20:20:19,335 - INFO - 用户 7 断开连接
2025-06-29 20:20:19,341 - INFO - 用户 7 连接到目标 13
2025-06-29 20:20:23,328 - INFO - 用户 7 断开连接
2025-06-29 20:20:23,335 - INFO - 用户 7 连接到目标 13
2025-06-29 20:20:27,324 - INFO - 用户 7 断开连接
2025-06-29 20:20:27,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:20:31,319 - INFO - 用户 7 断开连接
2025-06-29 20:20:31,325 - INFO - 用户 7 连接到目标 13
2025-06-29 20:20:35,325 - INFO - 用户 7 断开连接
2025-06-29 20:20:35,332 - INFO - 用户 7 连接到目标 13
2025-06-29 20:20:39,326 - INFO - 用户 7 断开连接
2025-06-29 20:20:39,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:20:43,321 - INFO - 用户 7 断开连接
2025-06-29 20:20:43,326 - INFO - 用户 7 连接到目标 13
2025-06-29 20:20:47,331 - INFO - 用户 7 断开连接
2025-06-29 20:20:47,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:20:51,334 - INFO - 用户 7 断开连接
2025-06-29 20:20:51,340 - INFO - 用户 7 连接到目标 13
2025-06-29 20:20:55,327 - INFO - 用户 7 断开连接
2025-06-29 20:20:55,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:20:59,326 - INFO - 用户 7 断开连接
2025-06-29 20:20:59,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:21:03,335 - INFO - 用户 7 断开连接
2025-06-29 20:21:03,341 - INFO - 用户 7 连接到目标 13
2025-06-29 20:21:07,331 - INFO - 用户 7 断开连接
2025-06-29 20:21:07,337 - INFO - 用户 7 连接到目标 13
2025-06-29 20:21:11,323 - INFO - 用户 7 断开连接
2025-06-29 20:21:11,328 - INFO - 用户 7 连接到目标 13
2025-06-29 20:21:15,323 - INFO - 用户 7 断开连接
2025-06-29 20:21:15,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:21:19,329 - INFO - 用户 7 断开连接
2025-06-29 20:21:19,340 - INFO - 用户 7 连接到目标 13
2025-06-29 20:21:23,328 - INFO - 用户 7 断开连接
2025-06-29 20:21:23,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:21:27,332 - INFO - 用户 7 断开连接
2025-06-29 20:21:27,337 - INFO - 用户 7 连接到目标 13
2025-06-29 20:21:31,324 - INFO - 用户 7 断开连接
2025-06-29 20:21:31,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:21:35,316 - INFO - 用户 7 断开连接
2025-06-29 20:21:35,321 - INFO - 用户 7 连接到目标 13
2025-06-29 20:21:39,325 - INFO - 用户 7 断开连接
2025-06-29 20:21:39,331 - INFO - 用户 7 连接到目标 13
2025-06-29 20:21:43,330 - INFO - 用户 7 断开连接
2025-06-29 20:21:43,337 - INFO - 用户 7 连接到目标 13
2025-06-29 20:21:47,333 - INFO - 用户 7 断开连接
2025-06-29 20:21:47,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:21:51,334 - INFO - 用户 7 断开连接
2025-06-29 20:21:51,340 - INFO - 用户 7 连接到目标 13
2025-06-29 20:21:55,331 - INFO - 用户 7 断开连接
2025-06-29 20:21:55,337 - INFO - 用户 7 连接到目标 13
2025-06-29 20:21:59,318 - INFO - 用户 7 断开连接
2025-06-29 20:21:59,327 - INFO - 用户 7 连接到目标 13
2025-06-29 20:22:03,323 - INFO - 用户 7 断开连接
2025-06-29 20:22:03,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:22:07,334 - INFO - 用户 7 断开连接
2025-06-29 20:22:07,340 - INFO - 用户 7 连接到目标 13
2025-06-29 20:22:11,324 - INFO - 用户 7 断开连接
2025-06-29 20:22:11,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:22:15,323 - INFO - 用户 7 断开连接
2025-06-29 20:22:15,328 - INFO - 用户 7 连接到目标 13
2025-06-29 20:22:19,320 - INFO - 用户 7 断开连接
2025-06-29 20:22:19,331 - INFO - 用户 7 连接到目标 13
2025-06-29 20:22:23,331 - INFO - 用户 7 断开连接
2025-06-29 20:22:23,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:22:27,325 - INFO - 用户 7 断开连接
2025-06-29 20:22:27,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:22:31,319 - INFO - 用户 7 断开连接
2025-06-29 20:22:31,326 - INFO - 用户 7 连接到目标 13
2025-06-29 20:22:35,332 - INFO - 用户 7 断开连接
2025-06-29 20:22:35,340 - INFO - 用户 7 连接到目标 13
2025-06-29 20:22:39,325 - INFO - 用户 7 断开连接
2025-06-29 20:22:39,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:22:43,321 - INFO - 用户 7 断开连接
2025-06-29 20:22:43,325 - INFO - 用户 7 连接到目标 13
2025-06-29 20:22:47,319 - INFO - 用户 7 断开连接
2025-06-29 20:22:47,325 - INFO - 用户 7 连接到目标 13
2025-06-29 20:22:51,324 - INFO - 用户 7 断开连接
2025-06-29 20:22:51,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:22:55,328 - INFO - 用户 7 断开连接
2025-06-29 20:22:55,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:22:59,324 - INFO - 用户 7 断开连接
2025-06-29 20:22:59,331 - INFO - 用户 7 连接到目标 13
2025-06-29 20:23:03,329 - INFO - 用户 7 断开连接
2025-06-29 20:23:03,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:23:07,328 - INFO - 用户 7 断开连接
2025-06-29 20:23:07,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:23:11,331 - INFO - 用户 7 断开连接
2025-06-29 20:23:11,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:23:15,319 - INFO - 用户 7 断开连接
2025-06-29 20:23:15,326 - INFO - 用户 7 连接到目标 13
2025-06-29 20:23:19,324 - INFO - 用户 7 断开连接
2025-06-29 20:23:19,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:23:23,319 - INFO - 用户 7 断开连接
2025-06-29 20:23:23,327 - INFO - 用户 7 连接到目标 13
2025-06-29 20:23:27,323 - INFO - 用户 7 断开连接
2025-06-29 20:23:27,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:23:31,332 - INFO - 用户 7 断开连接
2025-06-29 20:23:31,339 - INFO - 用户 7 连接到目标 13
2025-06-29 20:23:35,327 - INFO - 用户 7 断开连接
2025-06-29 20:23:35,332 - INFO - 用户 7 连接到目标 13
2025-06-29 20:23:39,325 - INFO - 用户 7 断开连接
2025-06-29 20:23:39,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:23:43,327 - INFO - 用户 7 断开连接
2025-06-29 20:23:43,335 - INFO - 用户 7 连接到目标 13
2025-06-29 20:23:47,323 - INFO - 用户 7 断开连接
2025-06-29 20:23:47,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:23:51,329 - INFO - 用户 7 断开连接
2025-06-29 20:23:51,340 - INFO - 用户 7 连接到目标 13
2025-06-29 20:23:55,326 - INFO - 用户 7 断开连接
2025-06-29 20:23:55,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:23:59,325 - INFO - 用户 7 断开连接
2025-06-29 20:23:59,331 - INFO - 用户 7 连接到目标 13
2025-06-29 20:24:03,320 - INFO - 用户 7 断开连接
2025-06-29 20:24:03,325 - INFO - 用户 7 连接到目标 13
2025-06-29 20:24:07,324 - INFO - 用户 7 断开连接
2025-06-29 20:24:07,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:24:11,319 - INFO - 用户 7 断开连接
2025-06-29 20:24:11,325 - INFO - 用户 7 连接到目标 13
2025-06-29 20:24:15,329 - INFO - 用户 7 断开连接
2025-06-29 20:24:15,335 - INFO - 用户 7 连接到目标 13
2025-06-29 20:24:19,334 - INFO - 用户 7 断开连接
2025-06-29 20:24:19,341 - INFO - 用户 7 连接到目标 13
2025-06-29 20:24:23,324 - INFO - 用户 7 断开连接
2025-06-29 20:24:23,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:24:27,320 - INFO - 用户 7 断开连接
2025-06-29 20:24:27,323 - INFO - 用户 7 连接到目标 13
2025-06-29 20:24:31,317 - INFO - 用户 7 断开连接
2025-06-29 20:24:31,323 - INFO - 用户 7 连接到目标 13
2025-06-29 20:24:35,329 - INFO - 用户 7 断开连接
2025-06-29 20:24:35,337 - INFO - 用户 7 连接到目标 13
2025-06-29 20:24:39,331 - INFO - 用户 7 断开连接
2025-06-29 20:24:39,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:24:43,316 - INFO - 用户 7 断开连接
2025-06-29 20:24:43,325 - INFO - 用户 7 连接到目标 13
2025-06-29 20:24:47,324 - INFO - 用户 7 断开连接
2025-06-29 20:24:47,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:24:51,322 - INFO - 用户 7 断开连接
2025-06-29 20:24:51,328 - INFO - 用户 7 连接到目标 13
2025-06-29 20:24:55,318 - INFO - 用户 7 断开连接
2025-06-29 20:24:55,324 - INFO - 用户 7 连接到目标 13
2025-06-29 20:24:59,324 - INFO - 用户 7 断开连接
2025-06-29 20:24:59,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:25:03,329 - INFO - 用户 7 断开连接
2025-06-29 20:25:03,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:25:07,331 - INFO - 用户 7 断开连接
2025-06-29 20:25:07,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:25:11,331 - INFO - 用户 7 断开连接
2025-06-29 20:25:11,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:25:15,328 - INFO - 用户 7 断开连接
2025-06-29 20:25:15,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:25:19,318 - INFO - 用户 7 断开连接
2025-06-29 20:25:19,322 - INFO - 用户 7 连接到目标 13
2025-06-29 20:25:22,815 - INFO - 用户 7 断开连接
2025-06-29 20:25:22,852 - INFO - 用户 7 连接到目标 13
2025-06-29 20:25:25,843 - INFO - 用户 7 断开连接
2025-06-29 20:25:25,846 - INFO - 用户 7 连接到目标 13
2025-06-29 20:25:28,871 - INFO - 用户 7 断开连接
2025-06-29 20:25:28,875 - INFO - 用户 7 连接到目标 13
2025-06-29 20:25:31,878 - INFO - 用户 7 断开连接
2025-06-29 20:25:31,893 - INFO - 用户 7 连接到目标 13
2025-06-29 20:25:34,905 - INFO - 用户 7 断开连接
2025-06-29 20:25:34,913 - INFO - 用户 7 连接到目标 13
2025-06-29 20:25:37,921 - INFO - 用户 7 断开连接
2025-06-29 20:25:37,927 - INFO - 用户 7 连接到目标 13
2025-06-29 20:25:40,931 - INFO - 用户 7 断开连接
2025-06-29 20:25:40,936 - INFO - 用户 7 连接到目标 13
2025-06-29 20:25:43,962 - INFO - 用户 7 断开连接
2025-06-29 20:25:43,992 - INFO - 用户 7 连接到目标 13
2025-06-29 20:25:47,316 - INFO - 用户 7 断开连接
2025-06-29 20:25:47,320 - INFO - 用户 7 连接到目标 13
2025-06-29 20:25:51,326 - INFO - 用户 7 断开连接
2025-06-29 20:25:51,328 - INFO - 用户 7 连接到目标 13
2025-06-29 20:25:55,321 - INFO - 用户 7 断开连接
2025-06-29 20:25:55,325 - INFO - 用户 7 连接到目标 13
2025-06-29 20:25:59,073 - INFO - 用户 7 断开连接
2025-06-29 20:25:59,077 - INFO - 用户 7 连接到目标 13
2025-06-29 20:26:02,071 - INFO - 用户 7 断开连接
2025-06-29 20:26:02,074 - INFO - 用户 7 连接到目标 13
2025-06-29 20:26:05,098 - INFO - 用户 7 断开连接
2025-06-29 20:26:05,105 - INFO - 用户 7 连接到目标 13
2025-06-29 20:26:08,117 - INFO - 用户 7 断开连接
2025-06-29 20:26:08,123 - INFO - 用户 7 连接到目标 13
2025-06-29 20:26:11,133 - INFO - 用户 7 断开连接
2025-06-29 20:26:11,144 - INFO - 用户 7 连接到目标 13
2025-06-29 20:26:14,147 - INFO - 用户 7 断开连接
2025-06-29 20:26:14,149 - INFO - 用户 7 连接到目标 13
2025-06-29 20:26:17,477 - INFO - 用户 7 断开连接
2025-06-29 20:26:17,480 - INFO - 用户 7 连接到目标 13
2025-06-29 20:26:20,498 - INFO - 用户 7 断开连接
2025-06-29 20:26:20,505 - INFO - 用户 7 连接到目标 13
2025-06-29 20:26:23,507 - INFO - 用户 7 断开连接
2025-06-29 20:26:23,510 - INFO - 用户 7 连接到目标 13
2025-06-29 20:26:27,326 - INFO - 用户 7 断开连接
2025-06-29 20:26:27,331 - INFO - 用户 7 连接到目标 13
2025-06-29 20:26:31,328 - INFO - 用户 7 断开连接
2025-06-29 20:26:31,344 - INFO - 用户 7 连接到目标 13
2025-06-29 20:26:35,329 - INFO - 用户 7 断开连接
2025-06-29 20:26:35,332 - INFO - 用户 7 连接到目标 13
2025-06-29 20:26:39,317 - INFO - 用户 7 断开连接
2025-06-29 20:26:39,321 - INFO - 用户 7 连接到目标 13
2025-06-29 20:26:43,317 - INFO - 用户 7 断开连接
2025-06-29 20:26:43,321 - INFO - 用户 7 连接到目标 13
2025-06-29 20:26:47,322 - INFO - 用户 7 断开连接
2025-06-29 20:26:47,326 - INFO - 用户 7 连接到目标 13
2025-06-29 20:26:51,324 - INFO - 用户 7 断开连接
2025-06-29 20:26:51,327 - INFO - 用户 7 连接到目标 13
2025-06-29 20:26:54,339 - INFO - 用户 7 断开连接
2025-06-29 20:26:54,343 - INFO - 用户 7 连接到目标 13
2025-06-29 20:26:57,353 - INFO - 用户 7 断开连接
2025-06-29 20:26:57,356 - INFO - 用户 7 连接到目标 13
2025-06-29 20:27:00,375 - INFO - 用户 7 断开连接
2025-06-29 20:27:00,386 - INFO - 用户 7 连接到目标 13
2025-06-29 20:27:03,393 - INFO - 用户 7 断开连接
2025-06-29 20:27:03,399 - INFO - 用户 7 连接到目标 13
2025-06-29 20:27:03,718 - INFO - 收到消息 from 7 to 13: {'id': 1751200023717, 'text': 'hello 123', 'time': '2025-06-29T12:27:03.717Z', 'from': 7, 'to': 13, 'fromUsername': '赵敏', 'fromPhoto': '/avatar/ph_12345678921_f039.png'}
2025-06-29 20:27:03,720 - INFO - 加密消息： {'encrypt_data': 'b83Y+AEc3ZmURxihzmkqMpTGbgY/NtEkCFDwr1gDcu44cQxZ7ECf/JEbSbiGmGwhyD5zm1Zn7rlwVBP/TFmih4R4CCgHTaLFSDbxC/zEIVkPm+OfwvQGJXVIMwkqMsD0iCqRnA6JmtnC76t0xTg44g09+5ilo5c79CphX0Eqhg4uKxc2UsukE5cEsIYOppbMiNVW0Id5QVL8NSimb1LvEIpkDBpEhtzJ2ia/jPOwCtnEcdaK8Xu4VkOTNPgwpzNKKFCX2yPb5QZi5eeWqq6vscBCXvLSc7UApnsSJmdZB3U=', 'publick_key': '56fc780b-84ea-4fde-88d3-031ebbb0514a'}
2025-06-29 20:27:03,730 - INFO - BEGIN (implicit)
2025-06-29 20:27:03,734 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:27:03,735 - INFO - [generated in 0.00078s] {'id_1': '13'}
2025-06-29 20:27:07,325 - INFO - 用户 7 断开连接
2025-06-29 20:27:07,328 - INFO - ROLLBACK
2025-06-29 20:27:07,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:27:11,322 - INFO - 用户 7 断开连接
2025-06-29 20:27:11,326 - INFO - 用户 7 连接到目标 13
2025-06-29 20:27:15,320 - INFO - 用户 7 断开连接
2025-06-29 20:27:15,323 - INFO - 用户 7 连接到目标 13
2025-06-29 20:27:18,332 - INFO - 用户 7 断开连接
2025-06-29 20:27:18,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:27:22,316 - INFO - 用户 7 断开连接
2025-06-29 20:27:22,319 - INFO - 用户 7 连接到目标 13
2025-06-29 20:27:25,336 - INFO - 用户 7 断开连接
2025-06-29 20:27:25,339 - INFO - 用户 7 连接到目标 13
2025-06-29 20:27:29,325 - INFO - 用户 7 断开连接
2025-06-29 20:27:29,332 - INFO - 用户 7 连接到目标 13
2025-06-29 20:27:33,322 - INFO - 用户 7 断开连接
2025-06-29 20:27:33,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:27:37,325 - INFO - 用户 7 断开连接
2025-06-29 20:27:37,328 - INFO - 用户 7 连接到目标 13
2025-06-29 20:27:41,328 - INFO - 用户 7 断开连接
2025-06-29 20:27:41,331 - INFO - 用户 7 连接到目标 13
2025-06-29 20:27:45,326 - INFO - 用户 7 断开连接
2025-06-29 20:27:45,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:27:49,317 - INFO - 用户 7 断开连接
2025-06-29 20:27:49,322 - INFO - 用户 7 连接到目标 13
2025-06-29 20:27:53,330 - INFO - 用户 7 断开连接
2025-06-29 20:27:53,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:27:57,329 - INFO - 用户 7 断开连接
2025-06-29 20:27:57,331 - INFO - 用户 7 连接到目标 13
2025-06-29 20:28:01,331 - INFO - 用户 7 断开连接
2025-06-29 20:28:01,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:28:05,319 - INFO - 用户 7 断开连接
2025-06-29 20:28:05,325 - INFO - 用户 7 连接到目标 13
2025-06-29 20:28:09,326 - INFO - 用户 7 断开连接
2025-06-29 20:28:09,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:28:13,317 - INFO - 用户 7 断开连接
2025-06-29 20:28:13,320 - INFO - 用户 7 连接到目标 13
2025-06-29 20:28:17,327 - INFO - 用户 7 断开连接
2025-06-29 20:28:17,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:28:21,314 - INFO - 用户 7 断开连接
2025-06-29 20:28:21,319 - INFO - 用户 7 连接到目标 13
2025-06-29 20:28:25,314 - INFO - 用户 7 断开连接
2025-06-29 20:28:25,322 - INFO - 用户 7 连接到目标 13
2025-06-29 20:28:29,322 - INFO - 用户 7 断开连接
2025-06-29 20:28:29,325 - INFO - 用户 7 连接到目标 13
2025-06-29 20:28:33,326 - INFO - 用户 7 断开连接
2025-06-29 20:28:33,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:28:37,321 - INFO - 用户 7 断开连接
2025-06-29 20:28:37,323 - INFO - 用户 7 连接到目标 13
2025-06-29 20:28:41,316 - INFO - 用户 7 断开连接
2025-06-29 20:28:41,319 - INFO - 用户 7 连接到目标 13
2025-06-29 20:28:45,329 - INFO - 用户 7 断开连接
2025-06-29 20:28:45,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:28:49,330 - INFO - 用户 7 断开连接
2025-06-29 20:28:49,335 - INFO - 用户 7 连接到目标 13
2025-06-29 20:28:53,326 - INFO - 用户 7 断开连接
2025-06-29 20:28:53,331 - INFO - 用户 7 连接到目标 13
2025-06-29 20:28:57,320 - INFO - 用户 7 断开连接
2025-06-29 20:28:57,323 - INFO - 用户 7 连接到目标 13
2025-06-29 20:29:01,325 - INFO - 用户 7 断开连接
2025-06-29 20:29:01,328 - INFO - 用户 7 连接到目标 13
2025-06-29 20:29:05,321 - INFO - 用户 7 断开连接
2025-06-29 20:29:05,325 - INFO - 用户 7 连接到目标 13
2025-06-29 20:29:09,327 - INFO - 用户 7 断开连接
2025-06-29 20:29:09,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:29:13,327 - INFO - 用户 7 断开连接
2025-06-29 20:29:13,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:29:17,320 - INFO - 用户 7 断开连接
2025-06-29 20:29:17,323 - INFO - 用户 7 连接到目标 13
2025-06-29 20:29:21,320 - INFO - 用户 7 断开连接
2025-06-29 20:29:21,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:29:25,324 - INFO - 用户 7 断开连接
2025-06-29 20:29:25,327 - INFO - 用户 7 连接到目标 13
2025-06-29 20:29:29,328 - INFO - 用户 7 断开连接
2025-06-29 20:29:29,335 - INFO - 用户 7 连接到目标 13
2025-06-29 20:29:33,331 - INFO - 用户 7 断开连接
2025-06-29 20:29:33,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:29:37,318 - INFO - 用户 7 断开连接
2025-06-29 20:29:37,321 - INFO - 用户 7 连接到目标 13
2025-06-29 20:29:41,317 - INFO - 用户 7 断开连接
2025-06-29 20:29:41,321 - INFO - 用户 7 连接到目标 13
2025-06-29 20:29:45,321 - INFO - 用户 7 断开连接
2025-06-29 20:29:45,324 - INFO - 用户 7 连接到目标 13
2025-06-29 20:29:49,329 - INFO - 用户 7 断开连接
2025-06-29 20:29:49,331 - INFO - 用户 7 连接到目标 13
2025-06-29 20:29:53,326 - INFO - 用户 7 断开连接
2025-06-29 20:29:53,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:29:57,326 - INFO - 用户 7 断开连接
2025-06-29 20:29:57,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:30:01,320 - INFO - 用户 7 断开连接
2025-06-29 20:30:01,322 - INFO - 用户 7 连接到目标 13
2025-06-29 20:30:05,323 - INFO - 用户 7 断开连接
2025-06-29 20:30:05,325 - INFO - 用户 7 连接到目标 13
2025-06-29 20:30:09,328 - INFO - 用户 7 断开连接
2025-06-29 20:30:09,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:30:13,317 - INFO - 用户 7 断开连接
2025-06-29 20:30:13,322 - INFO - 用户 7 连接到目标 13
2025-06-29 20:30:16,546 - INFO - 用户 7 断开连接
2025-06-29 20:30:16,579 - INFO - 用户 7 连接到目标 13
2025-06-29 20:30:20,323 - INFO - 用户 7 断开连接
2025-06-29 20:30:20,328 - INFO - 用户 7 连接到目标 13
2025-06-29 20:30:24,332 - INFO - 用户 7 断开连接
2025-06-29 20:30:24,335 - INFO - 用户 7 连接到目标 13
2025-06-29 20:30:28,326 - INFO - 用户 7 断开连接
2025-06-29 20:30:28,332 - INFO - 用户 7 连接到目标 13
2025-06-29 20:30:32,329 - INFO - 用户 7 断开连接
2025-06-29 20:30:32,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:30:36,320 - INFO - 用户 7 断开连接
2025-06-29 20:30:36,324 - INFO - 用户 7 连接到目标 13
2025-06-29 20:30:40,320 - INFO - 用户 7 断开连接
2025-06-29 20:30:40,331 - INFO - 用户 7 连接到目标 13
2025-06-29 20:30:44,325 - INFO - 用户 7 断开连接
2025-06-29 20:30:44,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:30:48,326 - INFO - 用户 7 断开连接
2025-06-29 20:30:48,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:30:52,326 - INFO - 用户 7 断开连接
2025-06-29 20:30:52,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:30:56,332 - INFO - 用户 7 断开连接
2025-06-29 20:30:56,338 - INFO - 用户 7 连接到目标 13
2025-06-29 20:31:00,326 - INFO - 用户 7 断开连接
2025-06-29 20:31:00,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:31:04,330 - INFO - 用户 7 断开连接
2025-06-29 20:31:04,337 - INFO - 用户 7 连接到目标 13
2025-06-29 20:31:08,324 - INFO - 用户 7 断开连接
2025-06-29 20:31:08,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:31:12,333 - INFO - 用户 7 断开连接
2025-06-29 20:31:12,337 - INFO - 用户 7 连接到目标 13
2025-06-29 20:31:16,322 - INFO - 用户 7 断开连接
2025-06-29 20:31:16,334 - INFO - 用户 7 连接到目标 13
2025-06-29 20:31:20,311 - INFO - 用户 7 断开连接
2025-06-29 20:31:20,319 - INFO - 用户 7 连接到目标 13
2025-06-29 20:31:24,318 - INFO - 用户 7 断开连接
2025-06-29 20:31:24,324 - INFO - 用户 7 连接到目标 13
2025-06-29 20:31:28,321 - INFO - 用户 7 断开连接
2025-06-29 20:31:28,325 - INFO - 用户 7 连接到目标 13
2025-06-29 20:31:32,351 - INFO - 用户 7 断开连接
2025-06-29 20:31:32,369 - INFO - 用户 7 连接到目标 13
2025-06-29 20:31:36,341 - INFO - 用户 7 断开连接
2025-06-29 20:31:36,353 - INFO - 用户 7 连接到目标 13
2025-06-29 20:31:40,320 - INFO - 用户 7 断开连接
2025-06-29 20:31:40,322 - INFO - 用户 7 连接到目标 13
2025-06-29 20:31:44,435 - INFO - 用户 7 断开连接
2025-06-29 20:31:44,441 - INFO - 用户 7 连接到目标 13
2025-06-29 20:31:48,333 - INFO - 用户 7 断开连接
2025-06-29 20:31:48,337 - INFO - 用户 7 连接到目标 13
2025-06-29 20:31:52,352 - INFO - 用户 7 断开连接
2025-06-29 20:31:52,359 - INFO - 用户 7 连接到目标 13
2025-06-29 20:31:56,320 - INFO - 用户 7 断开连接
2025-06-29 20:31:56,328 - INFO - 用户 7 连接到目标 13
2025-06-29 20:32:00,326 - INFO - 用户 7 断开连接
2025-06-29 20:32:00,329 - INFO - 用户 7 连接到目标 13
2025-06-29 20:32:04,338 - INFO - 用户 7 断开连接
2025-06-29 20:32:04,349 - INFO - 用户 7 连接到目标 13
2025-06-29 20:32:08,324 - INFO - 用户 7 断开连接
2025-06-29 20:32:08,330 - INFO - 用户 7 连接到目标 13
2025-06-29 20:32:12,314 - INFO - 用户 7 断开连接
2025-06-29 20:32:12,322 - INFO - 用户 7 连接到目标 13
2025-06-29 20:32:16,330 - INFO - 用户 7 断开连接
2025-06-29 20:32:16,336 - INFO - 用户 7 连接到目标 13
2025-06-29 20:32:20,328 - INFO - 用户 7 断开连接
2025-06-29 20:32:20,333 - INFO - 用户 7 连接到目标 13
2025-06-29 20:32:23,285 - INFO - 用户 13 断开连接
2025-06-29 20:32:24,322 - INFO - 用户 7 断开连接
2025-06-29 20:32:24,332 - INFO - 用户 7 连接到目标 13
2025-06-29 20:32:28,334 - INFO - 用户 7 断开连接
2025-06-29 20:32:28,346 - INFO - 用户 7 连接到目标 13
2025-06-29 20:32:32,333 - INFO - 用户 7 断开连接
2025-06-29 20:32:32,340 - INFO - 用户 7 连接到目标 13
2025-06-29 20:32:36,316 - INFO - 用户 7 断开连接
2025-06-29 20:32:36,320 - INFO - 用户 7 连接到目标 13
2025-06-29 20:32:39,344 - INFO - 用户 7 断开连接
2025-06-29 20:32:39,345 - INFO - 用户 7 连接到目标 13
2025-06-29 20:32:42,350 - INFO - 用户 7 断开连接
2025-06-29 20:32:42,352 - INFO - 用户 7 连接到目标 13
2025-06-29 20:32:45,292 - INFO - 用户 7 断开连接
2025-06-29 20:33:17,751 - INFO - BEGIN (implicit)
2025-06-29 20:33:17,752 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:33:17,752 - INFO - [cached since 1603s ago] {'id_1': 13}
2025-06-29 20:33:17,759 - INFO - ROLLBACK
2025-06-29 20:33:17,872 - INFO - 用户 7 连接到目标 13
2025-06-29 20:35:11,406 - INFO - 用户 7 断开连接
2025-06-29 20:35:13,427 - INFO - BEGIN (implicit)
2025-06-29 20:35:13,428 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:35:13,428 - INFO - [cached since 1719s ago] {'id_1': 13}
2025-06-29 20:35:13,434 - INFO - ROLLBACK
2025-06-29 20:35:13,459 - INFO - 用户 7 连接到目标 13
2025-06-29 20:35:49,085 - INFO - 用户 7 断开连接
2025-06-29 20:35:49,521 - INFO - BEGIN (implicit)
2025-06-29 20:35:49,523 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:35:49,524 - INFO - [cached since 1755s ago] {'id_1': 13}
2025-06-29 20:35:49,526 - INFO - ROLLBACK
2025-06-29 20:35:49,537 - INFO - 用户 7 连接到目标 13
2025-06-29 20:38:26,991 - INFO - 用户 7 断开连接
2025-06-29 20:38:28,903 - INFO - BEGIN (implicit)
2025-06-29 20:38:28,906 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:38:28,907 - INFO - [cached since 1914s ago] {'id_1': 13}
2025-06-29 20:38:28,926 - INFO - ROLLBACK
2025-06-29 20:38:28,999 - INFO - 用户 7 连接到目标 13
2025-06-29 20:39:30,782 - INFO - 用户 7 断开连接
2025-06-29 20:39:32,337 - INFO - BEGIN (implicit)
2025-06-29 20:39:32,350 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:39:32,351 - INFO - [cached since 1978s ago] {'id_1': 13}
2025-06-29 20:39:32,355 - INFO - ROLLBACK
2025-06-29 20:39:32,379 - INFO - 用户 7 连接到目标 13
2025-06-29 20:40:17,485 - INFO - BEGIN (implicit)
2025-06-29 20:40:17,487 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:40:17,487 - INFO - [cached since 2023s ago] {'id_1': 7}
2025-06-29 20:40:17,513 - INFO - ROLLBACK
2025-06-29 20:40:17,538 - INFO - 用户 13 连接到目标 7
2025-06-29 20:40:17,569 - ERROR - Exception in callback _ProactorBasePipeTransport._call_connection_lost(None)
handle: <Handle _ProactorBasePipeTransport._call_connection_lost(None)>
Traceback (most recent call last):
  File "D:\conda\lib\asyncio\events.py", line 81, in _run
    self._context.run(self._callback, *self._args)
  File "D:\conda\lib\asyncio\proactor_events.py", line 162, in _call_connection_lost
    self._sock.shutdown(socket.SHUT_RDWR)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 20:40:33,180 - INFO - 收到消息 from 13 to 7: {'id': 1751200833180, 'text': 'send to zhao min', 'time': '2025-06-29T12:40:33.180Z', 'from': 13, 'to': 7, 'fromUsername': '张翠山', 'fromPhoto': '/avatar/ph_13676542345_9aca.png'}
2025-06-29 20:40:33,181 - INFO - 加密消息： {'encrypt_data': '1xCm/5w82lNoKHPxnWPXu6/sHdOhjjX81oa4UajudtQ3NaH73vyp7bt3mfSUVA8+b/xIblCS7LDMETwgUhL/9+Q4fW1UAgCmIGboCvcl+ieihz7UJhxX7g5bRjy16fnX/ls6oz3sSCB+XIOutxq164iuLi58hpYzHb4SE3ydhA6gBYZwRdDS+7eXJgIEM/Zixu8Bku9ljC9AJI8OtBV2mDnYMxZaAu7BFJTFaF5aF/f+FWl3vSa2U4KUHE4dj8hK9fPdvyaJ7oJIBvcd2dF6La5uVMpuJe2ywwiWEpshAPFuhQw5IdTar16E0cK26lOx', 'publick_key': '1fa8ce07-671b-43ac-b0a2-ee76febf3920'}
2025-06-29 20:40:33,187 - INFO - BEGIN (implicit)
2025-06-29 20:40:33,194 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:40:33,194 - INFO - [cached since 809.5s ago] {'id_1': '7'}
2025-06-29 20:41:01,224 - INFO - 收到消息 from 7 to 13: {'id': 1751200861223, 'text': 'send to zhang cui shan', 'time': '2025-06-29T12:41:01.223Z', 'from': 7, 'to': 13, 'fromUsername': '赵敏', 'fromPhoto': '/avatar/ph_12345678921_f039.png'}
2025-06-29 20:41:01,225 - INFO - 加密消息： {'encrypt_data': 'Z084sK3gKQv8ClWEfV1nSm811Z3r+/3zGz7hO80Z0NOuJ/Em0hsmjBpVySeWPhEynd4M0PmefetdtVYboH5wrv5yCuFrLfygQ5TLXXlnA0ozWzZW6/4Pad0QoOYj4TFlpcBp4BiUethHCd1A8SNFZLal5lkV/WV5rtXeo7NOqqBvDP5L0lqbenbXCIzQfsyJ1fEt2MSnYzty8axq/NBkBAbAhWaqQx50ZSu2zZW0L6dgY7P5pPT2ekVw4l5B3LGeGZPl4HGfVX5jbzPDrmBWpHzH8cPdboH+TOFsh+nTii2/TEGY+OXqKNVOJ4DzYVmt', 'publick_key': '059a139f-bbce-4679-9209-842cd10cac27'}
2025-06-29 20:41:01,233 - INFO - BEGIN (implicit)
2025-06-29 20:41:01,236 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:41:01,236 - INFO - [cached since 837.5s ago] {'id_1': '13'}
2025-06-29 20:41:09,124 - INFO - 用户 13 断开连接
2025-06-29 20:41:09,170 - INFO - ROLLBACK
2025-06-29 20:41:10,871 - INFO - BEGIN (implicit)
2025-06-29 20:41:10,872 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:41:10,872 - INFO - [cached since 2076s ago] {'id_1': 7}
2025-06-29 20:41:10,886 - INFO - ROLLBACK
2025-06-29 20:41:10,945 - INFO - 用户 13 连接到目标 7
2025-06-29 20:42:10,888 - INFO - 用户 7 断开连接
2025-06-29 20:42:10,890 - INFO - ROLLBACK
2025-06-29 20:42:11,368 - INFO - BEGIN (implicit)
2025-06-29 20:42:11,368 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:42:11,369 - INFO - [cached since 2137s ago] {'id_1': 13}
2025-06-29 20:42:11,374 - INFO - ROLLBACK
2025-06-29 20:42:11,399 - INFO - 用户 7 连接到目标 13
2025-06-29 20:42:19,411 - INFO - 用户 13 断开连接
2025-06-29 20:42:21,017 - INFO - BEGIN (implicit)
2025-06-29 20:42:21,019 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:42:21,041 - INFO - [cached since 2146s ago] {'id_1': 7}
2025-06-29 20:42:21,050 - INFO - ROLLBACK
2025-06-29 20:42:21,167 - INFO - 用户 13 连接到目标 7
2025-06-29 20:43:17,721 - INFO - 用户 7 断开连接
2025-06-29 20:43:19,494 - INFO - BEGIN (implicit)
2025-06-29 20:43:19,495 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:43:19,495 - INFO - [cached since 2205s ago] {'id_1': 13}
2025-06-29 20:43:19,502 - INFO - ROLLBACK
2025-06-29 20:43:19,520 - INFO - 用户 7 连接到目标 13
2025-06-29 20:44:14,266 - INFO - 用户 7 断开连接
2025-06-29 20:44:15,982 - INFO - BEGIN (implicit)
2025-06-29 20:44:15,984 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:44:15,984 - INFO - [cached since 2261s ago] {'id_1': 13}
2025-06-29 20:44:15,988 - INFO - ROLLBACK
2025-06-29 20:44:16,087 - INFO - 用户 7 连接到目标 13
2025-06-29 20:44:53,364 - INFO - 用户 7 断开连接
2025-06-29 20:44:55,075 - INFO - BEGIN (implicit)
2025-06-29 20:44:55,077 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:44:55,077 - INFO - [cached since 2300s ago] {'id_1': 13}
2025-06-29 20:44:55,083 - INFO - ROLLBACK
2025-06-29 20:44:55,173 - INFO - 用户 7 连接到目标 13
2025-06-29 20:48:13,100 - INFO - 用户 7 断开连接
2025-06-29 20:48:14,626 - INFO - BEGIN (implicit)
2025-06-29 20:48:14,628 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:48:14,629 - INFO - [cached since 2500s ago] {'id_1': 13}
2025-06-29 20:48:14,644 - INFO - ROLLBACK
2025-06-29 20:48:14,682 - INFO - 用户 7 连接到目标 13
2025-06-29 20:51:13,757 - INFO - 收到消息 from 7 to 13: {'id': 1751201473754, 'text': 'erter', 'time': '2025-06-29T12:51:13.754Z', 'from': 7, 'to': 13, 'fromUsername': '赵敏', 'fromPhoto': '/avatar/ph_12345678921_f039.png'}
2025-06-29 20:51:13,759 - INFO - 加密消息： {'encrypt_data': 'EVsiBt4OLPmtNAqSgLgvW+y8yvnVM10tVjK7Pt9kUw2txZ5n0HxEO7czinh5e7sKrs7Ac26uAg5mJzVlQY4zlasFeva1qA//XMb+JYNznQQHftm335ffGK6HNmV/wOTIKE6lis3u/ObfdZaItH3TOwbyENoChaRhuBrmx577viJAubdhJ98Xf9CahYoldobNgR5gVhVs1T3avfVCHRVh8WKCQj4n9xZYSHXDjEG0VOrOzsXThoxsxw/yhwZE1OC7w/n4AfUhPIGF2Sfqvgz4O3WMlizyrU2r+siVG8UahMA=', 'publick_key': 'e102283c-0c60-4551-9a79-3d89405267ab'}
2025-06-29 20:51:13,766 - INFO - BEGIN (implicit)
2025-06-29 20:51:13,766 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:51:13,767 - INFO - [cached since 1450s ago] {'id_1': '13'}
2025-06-29 20:51:20,201 - INFO - 收到消息 from 13 to 7: {'id': 1751201480200, 'text': 'sfs', 'time': '2025-06-29T12:51:20.200Z', 'from': 13, 'to': 7, 'fromUsername': '张翠山', 'fromPhoto': '/avatar/ph_13676542345_9aca.png'}
2025-06-29 20:51:20,212 - INFO - 加密消息： {'encrypt_data': 'CzhJEgzEwg/nG3NVzZTln/fmZb1+Nbqg1a8Qx9qXVoe9wQ5rXQwJrjfd1OAXdOT2PuCdbSnggIjX1HO07oudEu5tLZuXo5PY3FodSNtuxl4JAX8QyUyuFIEQfcBsHCyKPRuzcWisGNNJBchCst2xOWfdshzarByzm7d9l29TYQXpu2CXJhVSp2JzFPfdr8YdtX6U9uE+/dRQuz5c4gp5IchPao4QjUqIKLyUoYKCDDox2YtAvA7u0/uVbWtLGV4YlySGa5A4vxWBgyFefzB33wIORJqA1eQvPDH5bohJAHI=', 'publick_key': 'f40f5e16-ce39-4654-9e86-848b7a9e49b2'}
2025-06-29 20:51:20,218 - INFO - BEGIN (implicit)
2025-06-29 20:51:20,219 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:51:20,219 - INFO - [cached since 1456s ago] {'id_1': '7'}
2025-06-29 20:51:30,451 - INFO - 用户 7 断开连接
2025-06-29 20:51:30,452 - INFO - ROLLBACK
2025-06-29 20:51:32,082 - INFO - BEGIN (implicit)
2025-06-29 20:51:32,083 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:51:32,083 - INFO - [cached since 2697s ago] {'id_1': 13}
2025-06-29 20:51:32,092 - INFO - ROLLBACK
2025-06-29 20:51:32,171 - INFO - 用户 7 连接到目标 13
2025-06-29 20:53:30,960 - INFO - 用户 7 断开连接
2025-06-29 20:53:32,605 - INFO - BEGIN (implicit)
2025-06-29 20:53:32,606 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:53:32,606 - INFO - [cached since 2818s ago] {'id_1': 13}
2025-06-29 20:53:32,610 - INFO - ROLLBACK
2025-06-29 20:53:32,629 - INFO - 用户 7 连接到目标 13
2025-06-29 20:59:06,705 - INFO - 用户 13 断开连接
2025-06-29 20:59:06,707 - INFO - ROLLBACK
2025-06-29 20:59:08,434 - INFO - BEGIN (implicit)
2025-06-29 20:59:08,436 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 20:59:08,438 - INFO - [cached since 3154s ago] {'id_1': 7}
2025-06-29 20:59:08,444 - INFO - ROLLBACK
2025-06-29 20:59:08,522 - INFO - 用户 13 连接到目标 7
2025-06-29 21:01:04,159 - INFO - 用户 7 断开连接
2025-06-29 21:01:06,140 - INFO - BEGIN (implicit)
2025-06-29 21:01:06,141 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:01:06,143 - INFO - [cached since 3271s ago] {'id_1': 13}
2025-06-29 21:01:06,151 - INFO - ROLLBACK
2025-06-29 21:01:06,179 - INFO - 用户 7 连接到目标 13
2025-06-29 21:01:15,806 - INFO - BEGIN (implicit)
2025-06-29 21:01:15,806 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:01:15,807 - INFO - [cached since 3281s ago] {'id_1': 6}
2025-06-29 21:01:15,814 - INFO - ROLLBACK
2025-06-29 21:01:15,830 - INFO - 用户 7 断开连接
2025-06-29 21:01:15,838 - INFO - 用户 7 连接到目标 6
2025-06-29 21:01:18,849 - INFO - 用户 7 断开连接
2025-06-29 21:01:18,852 - INFO - 用户 7 连接到目标 6
2025-06-29 21:01:22,321 - INFO - 用户 7 断开连接
2025-06-29 21:01:22,329 - INFO - 用户 7 连接到目标 6
2025-06-29 21:01:26,317 - INFO - 用户 7 断开连接
2025-06-29 21:01:26,320 - INFO - 用户 7 连接到目标 6
2025-06-29 21:01:30,320 - INFO - 用户 7 断开连接
2025-06-29 21:01:30,325 - INFO - 用户 7 连接到目标 6
2025-06-29 21:01:34,314 - INFO - 用户 7 断开连接
2025-06-29 21:01:34,317 - INFO - 用户 7 连接到目标 6
2025-06-29 21:01:38,327 - INFO - 用户 7 断开连接
2025-06-29 21:01:38,336 - INFO - 用户 7 连接到目标 6
2025-06-29 21:01:42,324 - INFO - 用户 7 断开连接
2025-06-29 21:01:42,326 - INFO - 用户 7 连接到目标 6
2025-06-29 21:01:46,316 - INFO - 用户 7 断开连接
2025-06-29 21:01:46,320 - INFO - 用户 7 连接到目标 6
2025-06-29 21:01:50,312 - INFO - 用户 7 断开连接
2025-06-29 21:01:50,321 - INFO - 用户 7 连接到目标 6
2025-06-29 21:01:54,319 - INFO - 用户 7 断开连接
2025-06-29 21:01:54,322 - INFO - 用户 7 连接到目标 6
2025-06-29 21:01:58,332 - INFO - 用户 7 断开连接
2025-06-29 21:01:58,340 - INFO - 用户 7 连接到目标 6
2025-06-29 21:02:02,333 - INFO - 用户 7 断开连接
2025-06-29 21:02:02,340 - INFO - 用户 7 连接到目标 6
2025-06-29 21:02:06,328 - INFO - 用户 7 断开连接
2025-06-29 21:02:06,330 - INFO - 用户 7 连接到目标 6
2025-06-29 21:02:10,320 - INFO - 用户 7 断开连接
2025-06-29 21:02:10,334 - INFO - 用户 7 连接到目标 6
2025-06-29 21:02:14,320 - INFO - 用户 7 断开连接
2025-06-29 21:02:14,323 - INFO - 用户 7 连接到目标 6
2025-06-29 21:02:18,315 - INFO - 用户 7 断开连接
2025-06-29 21:02:18,318 - INFO - 用户 7 连接到目标 6
2025-06-29 21:02:22,331 - INFO - 用户 7 断开连接
2025-06-29 21:02:22,335 - INFO - 用户 7 连接到目标 6
2025-06-29 21:02:26,319 - INFO - 用户 7 断开连接
2025-06-29 21:02:26,329 - INFO - 用户 7 连接到目标 6
2025-06-29 21:02:30,319 - INFO - 用户 7 断开连接
2025-06-29 21:02:30,324 - INFO - 用户 7 连接到目标 6
2025-06-29 21:02:34,324 - INFO - 用户 7 断开连接
2025-06-29 21:02:34,330 - INFO - 用户 7 连接到目标 6
2025-06-29 21:02:38,326 - INFO - 用户 7 断开连接
2025-06-29 21:02:38,333 - INFO - 用户 7 连接到目标 6
2025-06-29 21:02:42,321 - INFO - 用户 7 断开连接
2025-06-29 21:02:42,329 - INFO - 用户 7 连接到目标 6
2025-06-29 21:02:46,332 - INFO - 用户 7 断开连接
2025-06-29 21:02:46,338 - INFO - 用户 7 连接到目标 6
2025-06-29 21:02:50,333 - INFO - 用户 7 断开连接
2025-06-29 21:02:50,340 - INFO - 用户 7 连接到目标 6
2025-06-29 21:02:54,315 - INFO - 用户 7 断开连接
2025-06-29 21:02:54,316 - INFO - 用户 7 连接到目标 6
2025-06-29 21:02:58,317 - INFO - 用户 7 断开连接
2025-06-29 21:02:58,325 - INFO - 用户 7 连接到目标 6
2025-06-29 21:03:02,334 - INFO - 用户 7 断开连接
2025-06-29 21:03:02,340 - INFO - 用户 7 连接到目标 6
2025-06-29 21:03:06,323 - INFO - 用户 7 断开连接
2025-06-29 21:03:06,329 - INFO - 用户 7 连接到目标 6
2025-06-29 21:03:10,318 - INFO - 用户 7 断开连接
2025-06-29 21:03:10,322 - INFO - 用户 7 连接到目标 6
2025-06-29 21:03:14,316 - INFO - 用户 7 断开连接
2025-06-29 21:03:14,322 - INFO - 用户 7 连接到目标 6
2025-06-29 21:03:18,326 - INFO - 用户 7 断开连接
2025-06-29 21:03:18,329 - INFO - 用户 7 连接到目标 6
2025-06-29 21:03:22,318 - INFO - 用户 7 断开连接
2025-06-29 21:03:22,330 - INFO - 用户 7 连接到目标 6
2025-06-29 21:03:26,313 - INFO - 用户 7 断开连接
2025-06-29 21:03:26,318 - INFO - 用户 7 连接到目标 6
2025-06-29 21:03:30,312 - INFO - 用户 7 断开连接
2025-06-29 21:03:30,318 - INFO - 用户 7 连接到目标 6
2025-06-29 21:03:34,318 - INFO - 用户 7 断开连接
2025-06-29 21:03:34,323 - INFO - 用户 7 连接到目标 6
2025-06-29 21:03:38,316 - INFO - 用户 7 断开连接
2025-06-29 21:03:38,324 - INFO - 用户 7 连接到目标 6
2025-06-29 21:03:42,315 - INFO - 用户 7 断开连接
2025-06-29 21:03:42,320 - INFO - 用户 7 连接到目标 6
2025-06-29 21:03:46,325 - INFO - 用户 7 断开连接
2025-06-29 21:03:46,329 - INFO - 用户 7 连接到目标 6
2025-06-29 21:03:50,330 - INFO - 用户 7 断开连接
2025-06-29 21:03:50,337 - INFO - 用户 7 连接到目标 6
2025-06-29 21:03:54,320 - INFO - 用户 7 断开连接
2025-06-29 21:03:54,324 - INFO - 用户 7 连接到目标 6
2025-06-29 21:03:58,330 - INFO - 用户 7 断开连接
2025-06-29 21:03:58,337 - INFO - 用户 7 连接到目标 6
2025-06-29 21:04:02,391 - INFO - 用户 7 断开连接
2025-06-29 21:04:02,398 - INFO - 用户 7 连接到目标 6
2025-06-29 21:04:06,318 - INFO - 用户 7 断开连接
2025-06-29 21:04:06,320 - INFO - 用户 7 连接到目标 6
2025-06-29 21:04:10,324 - INFO - 用户 7 断开连接
2025-06-29 21:04:10,327 - INFO - 用户 7 连接到目标 6
2025-06-29 21:04:14,329 - INFO - 用户 7 断开连接
2025-06-29 21:04:14,332 - INFO - 用户 7 连接到目标 6
2025-06-29 21:04:18,397 - INFO - 用户 7 断开连接
2025-06-29 21:04:18,405 - INFO - 用户 7 连接到目标 6
2025-06-29 21:04:21,462 - INFO - 用户 7 断开连接
2025-06-29 21:04:21,465 - INFO - 用户 7 连接到目标 6
2025-06-29 21:04:21,933 - INFO - 用户 7 断开连接
2025-06-29 21:04:23,808 - INFO - BEGIN (implicit)
2025-06-29 21:04:23,809 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:04:23,810 - INFO - [cached since 3469s ago] {'id_1': 6}
2025-06-29 21:04:23,816 - INFO - ROLLBACK
2025-06-29 21:04:23,855 - INFO - 用户 7 连接到目标 6
2025-06-29 21:05:23,845 - INFO - 用户 7 断开连接
2025-06-29 21:05:25,850 - INFO - BEGIN (implicit)
2025-06-29 21:05:25,851 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:05:25,851 - INFO - [cached since 3531s ago] {'id_1': 6}
2025-06-29 21:05:25,859 - INFO - ROLLBACK
2025-06-29 21:05:25,897 - INFO - 用户 7 连接到目标 6
2025-06-29 21:05:35,635 - INFO - BEGIN (implicit)
2025-06-29 21:05:35,635 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:05:35,636 - INFO - [cached since 3541s ago] {'id_1': 13}
2025-06-29 21:05:35,638 - INFO - ROLLBACK
2025-06-29 21:05:35,648 - INFO - 用户 7 断开连接
2025-06-29 21:05:35,665 - INFO - 用户 7 连接到目标 13
2025-06-29 21:05:39,313 - INFO - 用户 7 断开连接
2025-06-29 21:05:39,320 - INFO - 用户 7 连接到目标 13
2025-06-29 21:05:43,316 - INFO - 用户 7 断开连接
2025-06-29 21:05:43,319 - INFO - 用户 7 连接到目标 13
2025-06-29 21:05:47,318 - INFO - 用户 7 断开连接
2025-06-29 21:05:47,321 - INFO - 用户 7 连接到目标 13
2025-06-29 21:05:51,316 - INFO - 用户 7 断开连接
2025-06-29 21:05:51,323 - INFO - 用户 7 连接到目标 13
2025-06-29 21:05:55,340 - INFO - 用户 7 断开连接
2025-06-29 21:05:55,346 - INFO - 用户 7 连接到目标 13
2025-06-29 21:05:59,329 - INFO - 用户 7 断开连接
2025-06-29 21:05:59,337 - INFO - 用户 7 连接到目标 13
2025-06-29 21:06:03,320 - INFO - 用户 7 断开连接
2025-06-29 21:06:03,323 - INFO - 用户 7 连接到目标 13
2025-06-29 21:06:07,328 - INFO - 用户 7 断开连接
2025-06-29 21:06:07,331 - INFO - 用户 7 连接到目标 13
2025-06-29 21:06:11,328 - INFO - 用户 7 断开连接
2025-06-29 21:06:11,341 - INFO - 用户 7 连接到目标 13
2025-06-29 21:06:15,316 - INFO - 用户 7 断开连接
2025-06-29 21:06:15,320 - INFO - 用户 7 连接到目标 13
2025-06-29 21:06:19,326 - INFO - 用户 7 断开连接
2025-06-29 21:06:19,329 - INFO - 用户 7 连接到目标 13
2025-06-29 21:06:23,327 - INFO - 用户 7 断开连接
2025-06-29 21:06:23,336 - INFO - 用户 7 连接到目标 13
2025-06-29 21:06:27,314 - INFO - 用户 7 断开连接
2025-06-29 21:06:27,318 - INFO - 用户 7 连接到目标 13
2025-06-29 21:06:31,323 - INFO - 用户 7 断开连接
2025-06-29 21:06:31,329 - INFO - 用户 7 连接到目标 13
2025-06-29 21:06:35,330 - INFO - 用户 7 断开连接
2025-06-29 21:06:35,333 - INFO - 用户 7 连接到目标 13
2025-06-29 21:06:39,319 - INFO - 用户 7 断开连接
2025-06-29 21:06:39,322 - INFO - 用户 7 连接到目标 13
2025-06-29 21:06:43,320 - INFO - 用户 7 断开连接
2025-06-29 21:06:43,323 - INFO - 用户 7 连接到目标 13
2025-06-29 21:06:47,328 - INFO - 用户 7 断开连接
2025-06-29 21:06:47,332 - INFO - 用户 7 连接到目标 13
2025-06-29 21:06:51,329 - INFO - 用户 7 断开连接
2025-06-29 21:06:51,332 - INFO - 用户 7 连接到目标 13
2025-06-29 21:06:55,326 - INFO - 用户 7 断开连接
2025-06-29 21:06:55,332 - INFO - 用户 7 连接到目标 13
2025-06-29 21:06:59,322 - INFO - 用户 7 断开连接
2025-06-29 21:06:59,327 - INFO - 用户 7 连接到目标 13
2025-06-29 21:07:03,312 - INFO - 用户 7 断开连接
2025-06-29 21:07:03,318 - INFO - 用户 7 连接到目标 13
2025-06-29 21:07:07,320 - INFO - 用户 7 断开连接
2025-06-29 21:07:07,325 - INFO - 用户 7 连接到目标 13
2025-06-29 21:07:11,321 - INFO - 用户 7 断开连接
2025-06-29 21:07:11,326 - INFO - 用户 7 连接到目标 13
2025-06-29 21:07:15,316 - INFO - 用户 7 断开连接
2025-06-29 21:07:15,322 - INFO - 用户 7 连接到目标 13
2025-06-29 21:07:19,318 - INFO - 用户 7 断开连接
2025-06-29 21:07:19,330 - INFO - 用户 7 连接到目标 13
2025-06-29 21:07:23,322 - INFO - 用户 7 断开连接
2025-06-29 21:07:23,330 - INFO - 用户 7 连接到目标 13
2025-06-29 21:07:27,329 - INFO - 用户 7 断开连接
2025-06-29 21:07:27,340 - INFO - 用户 7 连接到目标 13
2025-06-29 21:07:30,525 - INFO - 用户 7 断开连接
2025-06-29 21:07:30,570 - INFO - 用户 7 连接到目标 13
2025-06-29 21:07:33,537 - INFO - 用户 7 断开连接
2025-06-29 21:07:33,543 - INFO - 用户 7 连接到目标 13
2025-06-29 21:07:33,548 - INFO - 用户 7 断开连接
2025-06-29 21:07:34,053 - INFO - BEGIN (implicit)
2025-06-29 21:07:34,053 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:07:34,054 - INFO - [cached since 3659s ago] {'id_1': 13}
2025-06-29 21:07:34,065 - INFO - ROLLBACK
2025-06-29 21:07:34,080 - INFO - 用户 7 连接到目标 13
2025-06-29 21:11:47,347 - INFO - 用户 7 断开连接
2025-06-29 21:11:49,219 - INFO - BEGIN (implicit)
2025-06-29 21:11:49,221 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:11:49,222 - INFO - [cached since 3914s ago] {'id_1': 13}
2025-06-29 21:11:49,226 - INFO - ROLLBACK
2025-06-29 21:11:49,249 - INFO - 用户 7 连接到目标 13
2025-06-29 21:14:45,034 - INFO - 用户 7 断开连接
2025-06-29 21:14:47,015 - INFO - BEGIN (implicit)
2025-06-29 21:14:47,016 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:14:47,019 - INFO - [cached since 4092s ago] {'id_1': 13}
2025-06-29 21:14:47,025 - INFO - ROLLBACK
2025-06-29 21:14:47,045 - INFO - 用户 7 连接到目标 13
2025-06-29 21:19:39,763 - INFO - 用户 13 断开连接
2025-06-29 21:19:39,765 - INFO - 用户 7 断开连接
2025-06-29 21:19:40,330 - INFO - Error while receiving.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。
2025-06-29 21:19:40,365 - INFO - Closing down clientserver connection
2025-06-29 21:19:40,365 - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "D:\conda\lib\socket.py", line 669, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\conda\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "D:\conda\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-06-29 21:19:40,385 - INFO - Closing down clientserver connection
2025-06-29 21:19:55,343 - INFO - 用户 7 连接到目标 13
2025-06-29 21:19:55,346 - INFO - 用户 13 连接到目标 7
2025-06-29 21:20:12,617 - INFO - 用户 7 断开连接
2025-06-29 21:20:14,600 - INFO - SELECT DATABASE()
2025-06-29 21:20:14,600 - INFO - [raw sql] {}
2025-06-29 21:20:14,602 - INFO - SELECT @@sql_mode
2025-06-29 21:20:14,602 - INFO - [raw sql] {}
2025-06-29 21:20:14,617 - INFO - SELECT @@lower_case_table_names
2025-06-29 21:20:14,617 - INFO - [raw sql] {}
2025-06-29 21:20:14,647 - INFO - BEGIN (implicit)
2025-06-29 21:20:14,663 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:20:14,663 - INFO - [generated in 0.00048s] {'id_1': 13}
2025-06-29 21:20:14,667 - INFO - ROLLBACK
2025-06-29 21:20:14,690 - INFO - 用户 7 连接到目标 13
2025-06-29 21:20:25,537 - INFO - 用户 7 断开连接
2025-06-29 21:20:26,081 - INFO - BEGIN (implicit)
2025-06-29 21:20:26,082 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:20:26,082 - INFO - [cached since 11.42s ago] {'id_1': 13}
2025-06-29 21:20:26,087 - INFO - ROLLBACK
2025-06-29 21:20:26,101 - INFO - 用户 7 连接到目标 13
2025-06-29 21:22:12,103 - INFO - 用户 7 断开连接
2025-06-29 21:22:14,134 - INFO - BEGIN (implicit)
2025-06-29 21:22:14,134 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:22:14,135 - INFO - [cached since 119.5s ago] {'id_1': 13}
2025-06-29 21:22:14,137 - INFO - ROLLBACK
2025-06-29 21:22:14,160 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:17,373 - INFO - BEGIN (implicit)
2025-06-29 21:23:17,374 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:23:17,375 - INFO - [cached since 182.7s ago] {'id_1': 6}
2025-06-29 21:23:17,378 - INFO - ROLLBACK
2025-06-29 21:23:17,419 - INFO - 用户 7 断开连接
2025-06-29 21:23:17,426 - INFO - 用户 7 连接到目标 6
2025-06-29 21:23:20,416 - INFO - 用户 7 断开连接
2025-06-29 21:23:20,420 - INFO - 用户 7 连接到目标 6
2025-06-29 21:23:20,736 - INFO - BEGIN (implicit)
2025-06-29 21:23:20,736 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:23:20,737 - INFO - [cached since 186.1s ago] {'id_1': 13}
2025-06-29 21:23:20,741 - INFO - ROLLBACK
2025-06-29 21:23:20,751 - INFO - 用户 7 断开连接
2025-06-29 21:23:20,772 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:23,443 - INFO - 用户 7 断开连接
2025-06-29 21:23:23,448 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:23,784 - INFO - 用户 7 断开连接
2025-06-29 21:23:23,793 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:26,460 - INFO - 用户 7 断开连接
2025-06-29 21:23:26,469 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:26,806 - INFO - 用户 7 断开连接
2025-06-29 21:23:26,811 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:29,484 - INFO - 用户 7 断开连接
2025-06-29 21:23:29,489 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:29,813 - INFO - 用户 7 断开连接
2025-06-29 21:23:29,821 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:32,490 - INFO - 用户 7 断开连接
2025-06-29 21:23:32,504 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:32,824 - INFO - 用户 7 断开连接
2025-06-29 21:23:32,839 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:35,515 - INFO - 用户 7 断开连接
2025-06-29 21:23:35,530 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:35,842 - INFO - 用户 7 断开连接
2025-06-29 21:23:35,856 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:38,537 - INFO - 用户 7 断开连接
2025-06-29 21:23:38,549 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:38,864 - INFO - 用户 7 断开连接
2025-06-29 21:23:38,873 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:41,544 - INFO - 用户 7 断开连接
2025-06-29 21:23:41,548 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:41,873 - INFO - 用户 7 断开连接
2025-06-29 21:23:41,880 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:44,559 - INFO - 用户 7 断开连接
2025-06-29 21:23:44,563 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:44,878 - INFO - 用户 7 断开连接
2025-06-29 21:23:44,886 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:47,564 - INFO - 用户 7 断开连接
2025-06-29 21:23:47,572 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:47,892 - INFO - 用户 7 断开连接
2025-06-29 21:23:47,903 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:50,577 - INFO - 用户 7 断开连接
2025-06-29 21:23:50,581 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:50,897 - INFO - 用户 7 断开连接
2025-06-29 21:23:50,909 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:53,594 - INFO - 用户 7 断开连接
2025-06-29 21:23:53,599 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:53,911 - INFO - 用户 7 断开连接
2025-06-29 21:23:53,919 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:56,606 - INFO - 用户 7 断开连接
2025-06-29 21:23:56,610 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:56,932 - INFO - 用户 7 断开连接
2025-06-29 21:23:56,937 - INFO - 用户 7 连接到目标 13
2025-06-29 21:23:59,607 - INFO - 用户 7 断开连接
2025-06-29 21:23:59,637 - INFO - 用户 7 连接到目标 13
2025-06-29 21:24:00,165 - INFO - 用户 7 断开连接
2025-06-29 21:24:00,169 - INFO - 用户 7 连接到目标 13
2025-06-29 21:24:00,475 - INFO - 用户 7 断开连接
2025-06-29 21:24:01,201 - INFO - BEGIN (implicit)
2025-06-29 21:24:01,202 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:24:01,202 - INFO - [cached since 226.5s ago] {'id_1': 13}
2025-06-29 21:24:01,217 - INFO - ROLLBACK
2025-06-29 21:24:01,246 - INFO - 用户 7 连接到目标 13
2025-06-29 21:24:17,665 - INFO - 收到消息 from 7 to 13: {'id': 1751203457664, 'text': '赵敏 发送 123456', 'time': '2025-06-29T13:24:17.664Z', 'from': 7, 'to': 13, 'fromUsername': '赵敏', 'fromPhoto': '/avatar/ph_12345678921_f039.png'}
2025-06-29 21:24:17,666 - INFO - 加密消息： {'encrypt_data': 'Nu7dRHqA+IruY42XH76GEQRQ8uVa2yKtnPdxjYkVu8QSDO+dMm0uJugYwTpS51HbZwqYajM4YOi5lsittApObdX3uhAmSJBGaNjpdiipCBEChqy5PX3SNwy8AOdejhZL/U6UKKUTXFQm1QesgJtxjEWcNuE5C3fLRlYYppIfN24YygI57iFVZaWZN4GiHFZsPdCtAY5fgT2y8jgbNHkeMKK+dYLiPDTwSot2uuIL+Z8lHuc3m/kcO1ZjAVJlO+fjuAFHY16TfR3dEGFP0rQUDfte0O2yE4bUuikvOBnbAJICr2n4SMq2NXCfVXlLOOP3', 'publick_key': 'fec1c50a-1514-45e1-8f36-dc3806111311'}
2025-06-29 21:24:17,673 - INFO - BEGIN (implicit)
2025-06-29 21:24:17,675 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:24:17,677 - INFO - [generated in 0.00142s] {'id_1': '13'}
2025-06-29 21:24:24,315 - INFO - 用户 7 断开连接
2025-06-29 21:24:24,318 - INFO - ROLLBACK
2025-06-29 21:24:24,496 - INFO - BEGIN (implicit)
2025-06-29 21:24:24,496 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:24:24,497 - INFO - [cached since 249.8s ago] {'id_1': 13}
2025-06-29 21:24:24,503 - INFO - ROLLBACK
2025-06-29 21:24:24,521 - INFO - 用户 7 连接到目标 13
2025-06-29 21:24:36,462 - INFO - 用户 13 断开连接
2025-06-29 21:24:37,379 - INFO - BEGIN (implicit)
2025-06-29 21:24:37,379 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:24:37,380 - INFO - [cached since 262.7s ago] {'id_1': 7}
2025-06-29 21:24:37,383 - INFO - ROLLBACK
2025-06-29 21:24:37,404 - INFO - 用户 13 连接到目标 7
2025-06-29 21:25:34,018 - INFO - 用户 7 断开连接
2025-06-29 21:25:35,861 - INFO - BEGIN (implicit)
2025-06-29 21:25:35,862 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:25:35,863 - INFO - [cached since 321.2s ago] {'id_1': 13}
2025-06-29 21:25:35,868 - INFO - ROLLBACK
2025-06-29 21:25:35,898 - INFO - 用户 7 连接到目标 13
2025-06-29 21:26:37,197 - INFO - 用户 7 断开连接
2025-06-29 21:26:47,120 - INFO - 用户 7 连接到目标 13
2025-06-29 21:28:03,131 - INFO - BEGIN (implicit)
2025-06-29 21:28:03,131 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:28:03,131 - INFO - [cached since 468.5s ago] {'id_1': 7}
2025-06-29 21:28:03,138 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:28:03,138 - INFO - [cached since 468.5s ago] {'id_1': 7}
2025-06-29 21:28:03,141 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:28:03,141 - INFO - [cached since 468.5s ago] {'id_1': 7}
2025-06-29 21:28:03,145 - INFO - ROLLBACK
2025-06-29 21:28:15,484 - INFO - BEGIN (implicit)
2025-06-29 21:28:15,486 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:28:15,487 - INFO - [cached since 480.8s ago] {'id_1': 7}
2025-06-29 21:28:15,492 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:28:15,493 - INFO - [cached since 480.8s ago] {'id_1': 6}
2025-06-29 21:28:15,498 - INFO - ROLLBACK
2025-06-29 21:28:22,125 - INFO - 用户 7 断开连接
2025-06-29 21:28:24,102 - INFO - BEGIN (implicit)
2025-06-29 21:28:24,103 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:28:24,103 - INFO - [cached since 489.4s ago] {'id_1': 7}
2025-06-29 21:28:24,107 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:28:24,107 - INFO - [cached since 489.4s ago] {'id_1': 7}
2025-06-29 21:28:24,110 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:28:24,110 - INFO - [cached since 489.4s ago] {'id_1': 7}
2025-06-29 21:28:24,140 - INFO - ROLLBACK
2025-06-29 21:28:57,828 - INFO - BEGIN (implicit)
2025-06-29 21:28:57,829 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:28:57,829 - INFO - [cached since 523.2s ago] {'id_1': 7}
2025-06-29 21:28:57,837 - INFO - ROLLBACK
2025-06-29 21:29:00,280 - INFO - BEGIN (implicit)
2025-06-29 21:29:00,280 - INFO - SELECT users.phone, users.email, users.username, users.sex, users.description, users.photo, users.qrcode, users.password, users.id, users.created_at 
FROM users 
WHERE users.id = %(id_1)s
2025-06-29 21:29:00,280 - INFO - [cached since 525.6s ago] {'id_1': 13}
2025-06-29 21:29:00,282 - INFO - ROLLBACK
2025-06-29 21:29:00,318 - INFO - 用户 7 连接到目标 13
